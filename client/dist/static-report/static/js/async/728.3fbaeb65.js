"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["728"],{4421:function(e,t,l){l.r(t),l.d(t,{default:()=>t$});var r,n=l(4246),i=l(7378),a=l(5043),s=l(1192),o=l(2591),d=l(8802),c=l(2939),u=l(4620),p=l(7961),h=l(9265),v=l(7317),m=l(3095),y=l(4387);y.Z.AUTH_REQUIRED;let f="true"===y.Z.OIDC_SERVER_IS_EMBEDDED;var x=l(9192),g=l(3195),b=l(1566),j=l(839),_=l(3657),S=l(644),w=l(9502),T=l(7596),C=l(1811),P=l(4917),k=l(4720),E=l(4178),I=l(7106),D=l(4313);let O={unknown:{name:"Unknown",color:C.P,progressProps:{variant:void 0},icon:b.M$},none:{name:"None",color:P.E,progressProps:{variant:void 0},icon:j.f6},low:{name:"Low",color:k.c,progressProps:{variant:void 0},icon:_._$},medium:{name:"Medium",color:E.L,progressProps:{variant:"warning"},icon:S.zI},high:{name:"High",color:I.H,progressProps:{variant:"danger"},icon:w.E2},critical:{name:"Critical",color:D.J,progressProps:{variant:"danger"},icon:T.ki}},V=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}},A=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function M(e){return(t,l)=>A(e(t))-A(e(l))}let L=e=>0===e.length?null:e.sort(M(e=>e.type))[0],K=e=>null!=e?e:"unknown";var N=l(1195),R=l(233);l(1839),f?y.V.OIDC_SERVER_EMBEDDED_PATH:y.V.OIDC_SERVER_URL,y.V.OIDC_CLIENT_ID,window.location.origin,window.location.origin,y.V.OIDC_SCOPE,Object.entries({$body_:"body",$headers_:"headers",$path_:"path",$query_:"query"});var Y=l(186);let z=async(e,t)=>{let l="function"==typeof t?await t(e):t;if(l)return"bearer"===e.scheme?"Bearer ".concat(l):"basic"===e.scheme?"Basic ".concat(btoa(l)):l},F=e=>{let{allowReserved:t,explode:l,name:r,style:n,value:i}=e;if(!l){let e=(t?i:i.map(e=>encodeURIComponent(e))).join((e=>{switch(e){case"form":default:return",";case"pipeDelimited":return"|";case"spaceDelimited":return"%20"}})(n));switch(n){case"label":return".".concat(e);case"matrix":return";".concat(r,"=").concat(e);case"simple":return e;default:return"".concat(r,"=").concat(e)}}let a=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(n),s=i.map(e=>"label"===n||"simple"===n?t?e:encodeURIComponent(e):B({allowReserved:t,name:r,value:e})).join(a);return"label"===n||"matrix"===n?a+s:s},B=e=>{let{allowReserved:t,name:l,value:r}=e;if(null==r)return"";if("object"==typeof r)throw Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return"".concat(l,"=").concat(t?r:encodeURIComponent(r))},q=e=>{let{allowReserved:t,explode:l,name:r,style:n,value:i,valueOnly:a}=e;if(i instanceof Date)return a?i.toISOString():"".concat(r,"=").concat(i.toISOString());if("deepObject"!==n&&!l){let e=[];Object.entries(i).forEach(l=>{let[r,n]=l;e=[...e,r,t?n:encodeURIComponent(n)]});let l=e.join(",");switch(n){case"form":return"".concat(r,"=").concat(l);case"label":return".".concat(l);case"matrix":return";".concat(r,"=").concat(l);default:return l}}let s=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(n),o=Object.entries(i).map(e=>{let[l,i]=e;return B({allowReserved:t,name:"deepObject"===n?"".concat(r,"[").concat(l,"]"):l,value:i})}).join(s);return"label"===n||"matrix"===n?s+o:o},U=/\{[^{}]+\}/g,W=function(){let{allowReserved:e,array:t,object:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r=>{let n=[];if(r&&"object"==typeof r)for(let i in r){let a=r[i];if(null!=a)if(Array.isArray(a)){let l=F((0,x._)({allowReserved:e,explode:!0,name:i,style:"form",value:a},t));l&&n.push(l)}else if("object"==typeof a){let t=q((0,x._)({allowReserved:e,explode:!0,name:i,style:"deepObject",value:a},l));t&&n.push(t)}else{let t=B({allowReserved:e,name:i,value:a});t&&n.push(t)}}return n.join("&")}},Z=async e=>{var t,{security:l}=e,r=(0,Y._)(e,["security"]);for(let e of l){let l=await z(e,r.auth);if(!l)continue;let n=null!=(t=e.name)?t:"Authorization";switch(e.in){case"query":r.query||(r.query={}),r.query[n]=l;break;case"cookie":{let e="".concat(n,"=").concat(l);"Cookie"in r.headers&&r.headers.Cookie?r.headers.Cookie="".concat(r.headers.Cookie,"; ").concat(e):r.headers.Cookie=e;break}default:r.headers[n]=l}return}},J=e=>H({path:e.path,query:e.paramsSerializer?void 0:e.query,querySerializer:"function"==typeof e.querySerializer?e.querySerializer:W(e.querySerializer),url:e.url}),H=e=>{let{path:t,query:l,querySerializer:r,url:n}=e,i=n.startsWith("/")?n:"/".concat(n);t&&(i=(e=>{let{path:t,url:l}=e,r=l,n=l.match(U);if(n)for(let e of n){let l=!1,n=e.substring(1,e.length-1),i="simple";n.endsWith("*")&&(l=!0,n=n.substring(0,n.length-1)),n.startsWith(".")?(n=n.substring(1),i="label"):n.startsWith(";")&&(n=n.substring(1),i="matrix");let a=t[n];if(null==a)continue;if(Array.isArray(a)){r=r.replace(e,F({explode:l,name:n,style:i,value:a}));continue}if("object"==typeof a){r=r.replace(e,q({explode:l,name:n,style:i,value:a,valueOnly:!0}));continue}if("matrix"===i){r=r.replace(e,";".concat(B({name:n,value:a})));continue}let s=encodeURIComponent("label"===i?".".concat(a):a);r=r.replace(e,s)}return r})({path:t,url:i}));let a=l?r(l):"";return a.startsWith("?")&&(a=a.substring(1)),a&&(i+="?".concat(a)),i},G=(e,t)=>{let l=(0,x._)({},e,t);return l.headers=Q(e.headers,t.headers),l},$=["common","delete","get","head","patch","post","put"],Q=function(){for(var e,t=arguments.length,l=Array(t),r=0;r<t;r++)l[r]=arguments[r];let n={};for(let t of l)if(t&&"object"==typeof t)for(let[l,r]of Object.entries(t))if($.includes(l)&&"object"==typeof r)n[l]=(0,x._)({},n[l],r);else if(null===r)delete n[l];else if(Array.isArray(r))for(let t of r)n[l]=[...null!=(e=n[l])?e:[],t];else void 0!==r&&(n[l]="object"==typeof r?JSON.stringify(r):r);return n},X=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,x._)({},e)},ee=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=G(X(),t);if(!l.axios||"Axios"in l.axios){let{auth:t}=l,r=(0,Y._)(l,["auth"]);e=R.Z.create(r)}else e=l.axios;let r=()=>(0,x._)({},l),n=async t=>{var r,n,i,a;let s=(0,g._)((0,x._)({},l,t),{axios:null!=(n=null!=(r=t.axios)?r:l.axios)?n:e,headers:Q(l.headers,t.headers)});s.security&&await Z((0,g._)((0,x._)({},s),{security:s.security})),s.requestValidator&&await s.requestValidator(s),s.body&&s.bodySerializer&&(s.body=s.bodySerializer(s.body));let o=J(s);try{let e=s.axios,{auth:t}=s,l=(0,Y._)(s,["auth"]),r=await e((0,g._)((0,x._)({},l),{baseURL:s.baseURL,data:s.body,headers:s.headers,params:s.paramsSerializer?s.query:void 0,url:o})),{data:n}=r;return"json"===s.responseType&&(s.responseValidator&&await s.responseValidator(n),s.responseTransformer&&(n=await s.responseTransformer(n))),(0,g._)((0,x._)({},r),{data:null!=n?n:{}})}catch(e){if(s.throwOnError)throw e;return e.error=null!=(a=null==(i=e.response)?void 0:i.data)?a:{},e}};return{buildUrl:J,delete:e=>n((0,g._)((0,x._)({},e),{method:"DELETE"})),get:e=>n((0,g._)((0,x._)({},e),{method:"GET"})),getConfig:r,head:e=>n((0,g._)((0,x._)({},e),{method:"HEAD"})),instance:e,options:e=>n((0,g._)((0,x._)({},e),{method:"OPTIONS"})),patch:e=>n((0,g._)((0,x._)({},e),{method:"PATCH"})),post:e=>n((0,g._)((0,x._)({},e),{method:"POST"})),put:e=>n((0,g._)((0,x._)({},e),{method:"PUT"})),request:n,setConfig:t=>(l=G(l,t),e.defaults=(0,g._)((0,x._)({},e.defaults,l),{headers:Q(e.defaults.headers,l.headers)}),r())}},et=ee({baseURL:"/",axios:R.Z,throwOnError:!0}),el=ee(X()),er=e=>!!(null==e?void 0:e.write)&&!!(null==e?void 0:e.read),en=(e,t,l)=>{if("undefined"==typeof window)return l;try{let r=window[e].getItem(t);return r?JSON.parse(r):l}catch(e){return console.error(e),l}},ei=e=>{let{isEnabled:t=!0,type:l,key:r,defaultValue:n}=e,[a,s]=i.useState(en(l,r,n)),o="localStorage"===l&&"undefined"!=typeof window&&t,d=i.useCallback(e=>{let t=e instanceof Function?e(en(l,r,n)):e;if("undefined"!=typeof window)try{if(void 0!==t){let e=JSON.stringify(t);window[l].setItem(r,e),"localStorage"===l&&window.dispatchEvent(new StorageEvent("storage",{key:r,newValue:e}))}else window[l].removeItem(r),"localStorage"===l&&window.dispatchEvent(new StorageEvent("storage",{key:r,newValue:null}))}catch(e){console.error(e)}o||s(t)},[l,r,n,o]);return i.useEffect(()=>{if(!o)return;let e=e=>{e.key===r&&s(e.newValue?JSON.parse(e.newValue):n)};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[r,n,o]),[a,d]},ea=e=>ei((0,g._)((0,x._)({},e),{type:"localStorage"}));var es=l(7693),eo=l.n(es),ed=l(8318);let ec=e=>e?eo()(e).format("MMM DD, YYYY"):null,eu=e=>Object.keys(e),ep=e=>"function"==typeof e?e():e;var eh=l(4935);let ev=e=>{let t,{defaultValue:l,persistTo:r,persistenceKeyPrefix:n,isEnabled:a=!0}=e,s=e=>"localStorage"===e.persistTo||"sessionStorage"===e.persistTo,o=e=>n?"".concat(n,":").concat(e):e,[d,c]={state:i.useState(l),urlParams:(e=>{let{isEnabled:t=!0,persistenceKeyPrefix:l,keys:r,defaultValue:n,serialize:a,deserialize:s}=e,o=(0,eh.s0)(),d=e=>l?"".concat(l,":").concat(e):e,c=e=>{let t,{pathname:r,search:n}=document.location;o({pathname:r,search:(e=>{let{existingSearchParams:t=new URLSearchParams,newPrefixedSerializedParams:l}=e,r=Object.fromEntries(t);for(let e of eu(l))void 0===l[e]&&delete l[e],null===l[e]&&(delete l[e],delete r[e]);let n=new URLSearchParams((0,x._)({},r,l));return n.sort(),n.toString()})({existingSearchParams:new URLSearchParams(n),newPrefixedSerializedParams:(t=a(e),l?eu(t).reduce((e,l)=>(e[d(l)]=t[l],e),{}):t)})},{replace:!0})},u=new URLSearchParams((0,eh.TH)().search),p=!0,h=n;if(t){let e=r.reduce((e,t)=>(e[t]=u.get(d(t)),e),{});h=(p=r.every(t=>!e[t]))?n:s(e)}return i.useEffect(()=>{p&&c(n)},[p]),[h,c]})("urlParams"===e.persistTo?e:(0,g._)((0,x._)({},e),{isEnabled:!1,keys:[],serialize:()=>({}),deserialize:()=>l})),localStorage:ea(s(e)?(0,g._)((0,x._)({},e),{key:o(e.key)}):(0,g._)((0,x._)({},e),{isEnabled:!1,key:""})),sessionStorage:(t=s(e)?(0,g._)((0,x._)({},e),{key:o(e.key)}):(0,g._)((0,x._)({},e),{isEnabled:!1,key:""}),ei((0,g._)((0,x._)({},t),{type:"sessionStorage"}))),provider:em(ey(e)?e:{serialize:()=>{},deserialize:()=>l,defaultValue:l,isEnabled:!1,persistTo:"provider"})}[r||"state"];return a?[d,c]:[l,()=>{}]},em=e=>{var t;let{serialize:l,deserialize:r,defaultValue:n}=e;return[null!=(t=r())?t:n,l]},ey=e=>"provider"===e.persistTo,ef=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isActiveItemEnabled:t,persistTo:l,persistenceKeyPrefix:r}=e,[n,i]=ev((0,x._)({isEnabled:!!t,defaultValue:null,persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["activeItem"],serialize:e=>({activeItem:null!==e?String(e):null}),deserialize:e=>{let{activeItem:t}=e;if(null==t)return null;let l=Number(t);return Number.isNaN(l)?t:l}}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"activeItem"}:er(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{activeItemId:n,setActiveItemId:i}},ex=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isExpansionEnabled:t,persistTo:l="state",persistenceKeyPrefix:r}=e,[n,i]=ev((0,x._)({isEnabled:!!t,defaultValue:{},persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["expandedCells"],serialize:e=>e&&0!==eu(e).length?{expandedCells:JSON.stringify(e)}:{expandedCells:null},deserialize:e=>{let{expandedCells:t}=e;try{return JSON.parse(t||"{}")}catch(e){return{}}}}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"expandedCells"}:er(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{expandedCells:n,setExpandedCells:i}},eg=e=>{let t=(0,x._)({},e);for(let e of eu(t)){var l;t[e]&&(null==(l=t[e])?void 0:l.length)!==0||delete t[e]}return{filters:eu(t).length>0?JSON.stringify(t):null}},eb=e=>{try{return JSON.parse(e.filters||"{}")}catch(e){return{}}};var ej=l(272),e_=l(3874),eS=l(9226),ew=l(4296),eT=l(8529),eC=l(4747),eP=l(6770),ek=l(8037),eE=l(2623),eI=l(2364),eD=l(400),eO=l(2499);let eV=e=>{let{content:t,children:l}=e;return t?(0,n.jsx)(eO.u,{content:(0,n.jsx)("div",{children:ep(t)}),children:l}):l};var eA=l(9426),eM=l(2050),eL=l(9589),eK=l(8700),eN=l(9767),eR=l(9765);let eY=e=>{let{id:t,placeholder:l,ariaLabel:r,onSearchChange:i,onClear:a,onKeyHandling:s,onClick:o,options:d,inputValue:c,inputRef:u,isDropdownOpen:p,activeItem:h}=e,v=(()=>{if(0===d.length)return"";if(1===d.length&&c){let e=ep(d[0].name);if(0===e.toLowerCase().indexOf(c.toLowerCase()))return c+e.substring(c.length)}return""})();return(0,n.jsxs)(eA.W,{isPlain:!0,children:[(0,n.jsx)(eM.v,(0,g._)((0,x._)({id:t,value:c,onClick:o,onChange:(e,t)=>i(t),onKeyDown:s,autoComplete:"off",innerRef:u,placeholder:l},h&&{"aria-activedescendant":h.id}),{role:"combobox",isExpanded:p,"aria-label":r,"aria-controls":"select-typeahead-listbox",hint:v,icon:(0,n.jsx)(eN.ZP,{})})),(0,n.jsx)(eL.t,{children:!!c&&(0,n.jsx)(eK.zx,{icon:(0,n.jsx)(eR.ZP,{"aria-hidden":!0}),variant:"plain",onClick:a,"aria-label":"Clear input value"})})]})},ez=e=>{let{id:t="",onChange:l,filterBeforeOnChange:r,options:a=[],placeholderText:s="Search",searchString:o="",searchInputAriaLabel:d="Search input",labelColor:c,selections:p=[],noResultsMessage:h,showChips:v,onSearchChange:m,onCreateNewOption:y,validateNewOption:f,isDisabled:b}=e,j=(0,i.useRef)(null),_=(0,i.useRef)(null),{inputValue:S,isDropdownOpen:w,setIsDropdownOpen:T,optionsNotSelected:C,removeSelectionById:P,handleOnSelect:k,handleOnCreateNewOption:E,handleInputChange:I,handleKeyDown:D,handleClearSearchInput:O,handleClickSearchInput:V,handleClickToggle:A,activeItem:M,focusedItemIndex:L}=(e=>{let{options:t,searchString:l,selections:r,onChange:n,menuRef:a,searchInputRef:s,onCreateNewOption:o,validateNewOption:d,onSearchChange:c,filterBeforeOnChange:u}=e,[p,h]=(0,i.useState)(l),[v,m]=(0,i.useState)(!1),[y,f]=(0,i.useState)(null),[x,g]=(0,i.useState)(null),b=(0,i.useMemo)(()=>t.filter(e=>!r.some(t=>t.id===e.id)),[t,r]),j=e=>{h(e),g(null),f(null),e&&!v&&m(!0),c&&c(e)},_=e=>{n([...u?u(r,e):r,e]),j(""),m(!1)},S=e=>{""!==e&&o&&(!d||d(e))&&_(o(e))};return{setInputValue:h,inputValue:p,isDropdownOpen:v,setIsDropdownOpen:m,optionsNotSelected:b,handleInputChange:j,handleKeyDown:e=>{switch(e.key){case"Enter":y?_(y):S(p);break;case"Tab":case"Escape":e.preventDefault(),m(!1),f(null);break;case"ArrowUp":case"ArrowDown":var l;let r;e.preventDefault(),l=e.key,r=0,v&&("ArrowUp"===l&&(r=null===x||0===x?t.length-1:x-1),"ArrowDown"===l&&(r=null===x||x===b.length-1?0:x+1)),g(r),f(b.filter(e=>{let{optionProps:t}=e;return!(null==t?void 0:t.isDisabled)})[r])}},handleOnSelect:_,handleOnCreateNewOption:S,menuRef:a,searchInputRef:s,removeSelectionById:e=>{n(r.filter(t=>t.id!==e))},handleClearSearchInput:()=>{var e;j(""),null==s||null==(e=s.current)||e.focus()},handleClickSearchInput:()=>{m(!v)},handleClickToggle:()=>{var e;m(!v),null==(e=s.current)||e.focus()},activeItem:y,focusedItemIndex:x}})({options:a,searchString:o,selections:p,onChange:l,filterBeforeOnChange:r,menuRef:j,searchInputRef:_,onCreateNewOption:y,validateNewOption:f,onSearchChange:m}),K=e=>"select-typeahead-".concat(e.replace(" ","-")),N=(0,n.jsx)(eY,{id:t,placeholder:s,ariaLabel:d,onSearchChange:I,onClear:O,onKeyHandling:D,onClick:V,inputValue:S,inputRef:_,options:a,isDropdownOpen:w,activeItem:M});return(0,n.jsxs)(eC.k,{direction:{default:"column"},children:[(0,n.jsx)(eP.B,{children:(0,n.jsx)(ek.P,{isOpen:w&&(C.length>0||!!h||!!y&&S.length>0),selected:p,onOpenChange:T,toggle:e=>(0,n.jsx)(u.O_,{ref:e,variant:"typeahead",onClick:A,isExpanded:w,isDisabled:b,isFullWidth:!0,status:S&&f?f(S)?void 0:"danger":void 0,children:N}),variant:"typeahead",children:(0,n.jsx)(eE.E,{id:"select-create-typeahead-listbox",children:y&&0===C.length?(0,n.jsx)(eI.$,{id:K("new-option"),isFocused:!0,onClick:()=>E(S),children:'Create new option "'.concat(S,'"')}):h&&0===C.length?(0,n.jsx)(eI.$,{isAriaDisabled:!0,children:h}):C.map((e,t)=>(0,n.jsx)(eI.$,(0,g._)((0,x._)({id:K(e.id),isFocused:L===t,ref:null,onClick:()=>k(e)},e.optionProps),{children:ep(e.name)}),e.id))})})},"input"),v&&(0,n.jsx)(eP.B,{children:(0,n.jsx)(eC.k,{spaceItems:{default:"spaceItemsXs"},children:p.map(e=>(0,n.jsx)(eP.B,{children:(0,n.jsx)(eV,{content:e.tooltip,children:(0,n.jsx)(eD._,{color:c,onClose:()=>P(e.id),children:ep(e.labelName||e.name)})})},e.id))})},"chips")]})},eF=e=>{let{category:t,filterValue:l,setFilterValue:r,showToolbarItem:a,isDisabled:s=!1}=e,o=i.useRef(new Map),[d,c]=i.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);i.useEffect(()=>{c(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let u=null==l?void 0:l.map(e=>{var t;let l=o.current.get(e),{chipLabel:r,label:n}=null!=l?l:{};return{key:e,node:null!=(t=null!=r?r:n)?t:e}});return(0,n.jsx)(eT.p,{id:"filter-control-".concat(t.categoryKey),labels:u,deleteLabel:(e,t)=>(e=>{let t="string"==typeof e?e:e.key;if(t){var n;let e=null!=(n=null==l?void 0:l.filter(e=>e!==t))?n:[];r(e.length>0?e:null)}})(t),deleteLabelGroup:()=>r([]),categoryName:t.title,showToolbarItem:a,children:(0,n.jsx)(ez,{isDisabled:s,options:d.map(e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}}),selections:null==l?void 0:l.map(e=>({id:e,name:e})),onChange:e=>{r(e.map(e=>ep(e.name)))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})})};var eB=l(6081),eq=l(9929),eU=l(1244);let eW=e=>eo()(e,"MM/DD/YYYY",!0).isValid(),eZ=e=>eo()(e).format("MM/DD/YYYY"),eJ=e=>eo()(e,"MM/DD/YYYY",!0).toDate(),eH=e=>{var t;return null!=(t=null==e?void 0:e.split("/").map(e=>eo()(e,"YYYY-MM-DD",!0)))?t:[]},eG=e=>{let[t,l]=e;return(null==t?void 0:t.isValid())&&(null==l?void 0:l.isValid())&&(null==t?void 0:t.isSameOrBefore(l))},e$=e=>{var t;let{category:l,filterValue:r,setFilterValue:a,showToolbarItem:s,isDisabled:o=!1}=e,d=null!=r?r:[],c=null!=(t=null==d?void 0:d.filter(e=>eG(eH(e))))?t:[],[u,p]=(0,i.useState)(),[h,v]=(0,i.useState)();return i.useEffect(()=>{if(null==r?void 0:r[0]){let[e,t]=eH(null==r?void 0:r[0]);p(e.toDate()),v(t.toDate())}else p(void 0),v(void 0)},[r]),(0,n.jsx)(eT.p,{labels:c.flatMap(e=>{let[,t]=(e=>{let[t,l]=eH(e);return eG([t,l])?["".concat(t.format("MM/DD"),"-").concat(l.format("MM/DD")),"".concat(t.format("MM/DD/YYYY"),"-").concat(l.format("MM/DD/YYYY"))]:[]})(e),[l,r]=t.split("-");return[{key:"".concat(e,"-from"),node:(0,n.jsx)(eO.u,{content:null!=l?l:e,children:(0,n.jsx)("span",{children:null!=l?l:""})})},{key:"".concat(e,"-to"),node:(0,n.jsx)(eO.u,{content:null!=r?r:e,children:(0,n.jsx)("span",{children:null!=r?r:""})})}]}),deleteLabel:(e,t)=>{a([])},deleteLabelGroup:()=>a([]),categoryName:l.title,showToolbarItem:s,children:(0,n.jsxs)(eB.B,{children:[(0,n.jsx)(eq.M,{value:u?eZ(u):"",dateFormat:eZ,dateParse:eJ,onChange:(e,t)=>{eW(t)&&(p(eJ(t)),v(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:o}),(0,n.jsx)(eq.M,{value:h?eZ(h):"",onChange:(e,t)=>{if(eW(t)){let e=eJ(t);v(e);let l=((e,t)=>{let[l,r]=[eo()(e),eo()(t)];if(eG([l,r]))return"".concat(l.format("YYYY-MM-DD"),"/").concat(r.format("YYYY-MM-DD"))})(u,e);l&&a([l])}},isDisabled:o||!(0,eU.q)(u),dateFormat:eZ,dateParse:eJ,invalidFormatText:"",rangeStart:u,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})]})},l.categoryKey)};var eQ=l(4780);let eX="no-results",e0=e=>{var t,l,r;let{category:a,filterValue:s,setFilterValue:o,showToolbarItem:d,isDisabled:c=!1,isScrollable:p=!1}=e,[h,v]=i.useState(!1),[m,y]=i.useState(""),f=i.useRef(null),b="filter-control-".concat(a.categoryKey),j=e=>"".concat(b,"-").concat(e),_=a.title,S=null==(t=a.selectOptions)?void 0:t.filter(e=>{let{label:t,value:l,groupLabel:r}=e;return[null!=t?t:l,r].filter(Boolean).map(e=>e.toLocaleLowerCase()).some(e=>{var t;return e.includes(null!=(t=null==m?void 0:m.trim().toLowerCase())?t:"")})}),[w,...T]=[...new Set([...null!=(r=null==(l=a.selectOptions)?void 0:l.map(e=>{let{groupLabel:t}=e;return t}).filter(Boolean))?r:[],_])],C=e=>o(null==s?void 0:s.map(e=>{var t;return[e,null==(t=a.selectOptions)?void 0:t.find(t=>{let{value:l}=t;return e===l})]}).filter(e=>{let[,t]=e;return t}).map(e=>{let[t,{groupLabel:l=_}={}]=e;return[t,l]}).filter(t=>{let[,l]=t;return l!==e}).map(e=>{let[t]=e;return t})),P=e=>{let t="string"==typeof e?e:e.key;if(t){var l;let e=null!=(l=null==s?void 0:s.filter(e=>e!==t))?l:[];o(e.length>0?e:null)}},k=e=>null==s?void 0:s.map(t=>a.selectOptions.find(l=>{let{value:r,groupLabel:n=_}=l;return r===t&&n===e})).filter(Boolean).map(e=>{var t,l;let{chipLabel:r,label:n,value:i}=e,a=null!=(l=null!=(t=null!=r?r:n)?t:i)?l:"";return{key:i,node:a}}),E=e=>{e&&e!==eX&&o((null==s?void 0:s.includes(e))?s.filter(t=>t!==e):[...null!=s?s:[],e])},{focusedItemIndex:I,getFocusedItem:D,clearFocusedItemIndex:O,moveFocusedItemIndex:V}=e1({filteredOptions:S}),A=e=>{switch(e.key){case"Enter":var t,l,r;h?(null==(t=D())?void 0:t.value)&&E(null==(r=D())?void 0:r.value):v(!0),null==f||null==(l=f.current)||l.focus();break;case"Tab":case"Escape":v(!1),O();break;case"ArrowUp":case"ArrowDown":e.preventDefault(),h?V(e.key):v(!0)}},M=(e,t)=>{y(t),h||v(!0)},L=e=>e===a.title?e:"".concat(a.title,"/").concat(e);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eT.p,{id:"".concat(b,"-").concat(w),labels:k(w),deleteLabel:(e,t)=>P(t),deleteLabelGroup:()=>C(w),categoryName:{name:w,key:L(w)},showToolbarItem:d,children:(0,n.jsx)(ek.P,{isScrollable:p,"aria-label":a.title,toggle:e=>(0,n.jsx)(u.O_,{ref:e,variant:"typeahead",onClick:()=>{v(!h)},isExpanded:h,isDisabled:c||!a.selectOptions.length,isFullWidth:!0,children:(0,n.jsxs)(eA.W,{isPlain:!0,children:[(0,n.jsx)(eM.v,{value:m,onClick:()=>{v(!h)},onChange:M,onKeyDown:A,id:j("typeahead-select-input"),autoComplete:"off",innerRef:f,placeholder:a.placeholderText,"aria-activedescendant":D()?j("option-".concat(I)):void 0,role:"combobox",isExpanded:h,"aria-controls":j("select-typeahead-listbox")}),(0,n.jsxs)(eL.t,{children:[!!m&&(0,n.jsx)(eK.zx,{variant:"plain",onClick:()=>{var e;y(""),null==f||null==(e=f.current)||e.focus()},"aria-label":"Clear input value",children:(0,n.jsx)(eR.q1,{"aria-hidden":!0})}),(null==s?void 0:s.length)?(0,n.jsx)(eQ.C,{isRead:!0,children:s.length}):null]})]})}),selected:s,onOpenChange:e=>v(e),onSelect:(e,t)=>E(t),isOpen:h,children:(0,n.jsxs)(eE.E,{id:j("select-typeahead-listbox"),children:[S.map((e,t)=>{let{groupLabel:l,label:r,value:a,optionProps:o={}}=e;return(0,i.createElement)(eI.$,(0,g._)((0,x._)({},o,!o.isDisabled&&{hasCheckbox:!0}),{key:a,id:j("option-".concat(t)),value:a,isFocused:I===t,isSelected:null==s?void 0:s.includes(a),children:[!!l&&(0,n.jsx)(eD._,{children:l})," ",null!=r?r:a]}))}),0===S.length&&(0,n.jsx)(eI.$,{isDisabled:!0,hasCheckbox:!1,value:eX,isSelected:!1,children:'No results found for "'.concat(m,'"')},eX)]})})},L(w)),T.map(e=>(0,n.jsx)(eT.p,{id:"".concat(b,"-").concat(e),labels:k(e),deleteLabel:(e,t)=>P(t),deleteLabelGroup:()=>C(e),categoryName:{name:e,key:L(e)},showToolbarItem:!1,children:" "},L(e)))]})},e1=e=>{let{filteredOptions:t}=e,[l,r]=i.useState(0);return{moveFocusedItemIndex:e=>{let n;return r((n=e,t.length?"ArrowUp"===n?l<=0?t.length-1:l-1:"ArrowDown"===n?l>=t.length-1?0:l+1:0:0))},focusedItemIndex:l,getFocusedItem:()=>{var e,r;return!t[l]||(null==(r=t[l])||null==(e=r.optionProps)?void 0:e.isDisabled)?void 0:t[l]},clearFocusedItemIndex:()=>r(0)}};var e2=l(4091),e7=l(7948);let e4=e=>{let{category:t,filterValue:l,setFilterValue:r,showToolbarItem:a,isNumeric:s,isDisabled:o=!1}=e,[d,c]=i.useState((null==l?void 0:l[0])||"");i.useEffect(()=>{c((null==l?void 0:l[0])||"")},[l]);let u=()=>{let e=d.trim();r(e?[e.replace(/\s+/g," ")]:[])},p={name:"".concat(t.categoryKey,"-input"),onChange:(e,t)=>c(t),"aria-label":"".concat(t.title," filter"),value:d,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||u()},isDisabled:o};return(0,n.jsx)(eT.p,{labels:(null==l?void 0:l.map(e=>({key:e,node:e})))||[],deleteLabel:()=>r([]),categoryName:t.title,showToolbarItem:a,children:s?(0,n.jsxs)(eB.B,{children:[(0,n.jsx)(e2.oi,(0,x._)({type:"number",id:"search-input"},p)),(0,n.jsx)(eK.zx,{icon:(0,n.jsx)(eN.ZP,{}),variant:eK.Wu.control,id:"search-button","aria-label":"search button for search input",onClick:u,isDisabled:o})]}):(0,n.jsx)(e7.M,(0,x._)({inputProps:{id:"search-input"}},p))})};var e9=l(5508);let e3=e=>{let{category:t,filterValue:l,setFilterValue:r,showToolbarItem:a,isDisabled:s=!1,isScrollable:o=!1}=e,[d,c]=i.useState(!1),p=e=>t.selectOptions.find(t=>{let{value:l}=t;return l===e}),h=null==l?void 0:l.map(e=>{var t;let l=p(e);if(!l)return null;let{chipLabel:r,label:n}=l;return{key:e,node:null!=(t=null!=r?r:n)?t:e}}).reduce((e,t)=>(t&&e.push(t),e),[]);return(0,n.jsx)(eT.p,{id:"filter-control-".concat(t.categoryKey),labels:h,deleteLabel:(e,t)=>(e=>{let t=null==l?void 0:l.filter(t=>t!==e);r((null==t?void 0:t.length)?t:null)})(t),categoryName:t.title,showToolbarItem:a,children:(0,n.jsx)(ek.P,{className:(0,e9.i)(o&&"isScrollable"),"aria-label":t.title,toggle:e=>{let r="Any";if(l&&l.length>0){var i;let e=l[0];r=(null==(i=p(e))?void 0:i.label)||e}return(0,n.jsx)(u.O_,{"aria-label":"Select",id:"select-filter-value-select",isFullWidth:!0,ref:e,onClick:()=>{c(!d)},isExpanded:d,isDisabled:s||0===t.selectOptions.length,children:r})},onOpenChange:e=>c(e),selected:l,onSelect:(e,t)=>{r(p(t)?[t]:null),c(!1),c(!1)},isOpen:d,shouldFocusToggleOnSelect:!0,children:(0,n.jsx)(eE.E,{children:t.selectOptions.map(e=>{let{label:t,value:r,optionProps:n}=e,a=null==l?void 0:l.includes(r);return(0,i.createElement)(eI.$,(0,g._)((0,x._)({},n),{key:r,value:r,isSelected:a}),null!=t?t:r)})})})})},e5=e=>{var{category:t}=e,l=(0,Y._)(e,["category"]);return t.type===e6.select?(0,n.jsx)(e3,(0,x._)({isScrollable:!0,category:t},l)):t.type===e6.search||t.type===e6.numsearch?(0,n.jsx)(e4,(0,x._)({category:t,isNumeric:t.type===e6.numsearch},l)):t.type===e6.multiselect?(0,n.jsx)(e0,(0,x._)({isScrollable:!0,category:t},l)):t.type===e6.dateRange?(0,n.jsx)(e$,(0,x._)({category:t},l)):t.type===e6.autocompleteLabel?(0,n.jsx)(eF,(0,x._)({category:t},l)):null};var e6=((r={}).select="select",r.multiselect="multiselect",r.search="search",r.numsearch="numsearch",r.dateRange="dateRange",r.autocompleteLabel="autocompleteLabel",r);let e8=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"OR";return e&&e.logicOperator||t},te=e=>{let{filterCategories:t,filterValues:l,setFilterValues:r,pagination:a,showFiltersSideBySide:s=!1,isDisabled:o=!1}=e,[d,v]=i.useState(!1),[m,y]=i.useState(t[0].categoryKey),f=e=>{y(e.categoryKey),v(!1)},b=t.find(e=>e.categoryKey===m),j=t.reduce((e,t)=>(t.filterGroup&&!e.includes(t.filterGroup)&&e.push(t.filterGroup),e),[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e_.R,{variant:"filter-group",toggleIcon:(0,n.jsx)(ew.ZP,{}),breakpoint:"2xl",gap:s?{default:"gapMd"}:void 0,children:[!s&&(0,n.jsx)(eS.E,{children:(0,n.jsx)(c.L,{toggle:e=>(0,n.jsxs)(u.O_,{id:"filtered-by",ref:e,onClick:()=>v(!d),isDisabled:o,children:[(0,n.jsx)(ew.ZP,{})," ",null==b?void 0:b.title]}),isOpen:d,children:j.length?j.map(e=>(0,n.jsx)(ej.p,{label:e,children:(0,n.jsx)(p.s,{children:t.filter(t=>t.filterGroup===e).map(e=>(0,n.jsx)(h.h,{id:"filter-category-".concat(e.categoryKey),onClick:()=>f(e),children:e.title},e.categoryKey))})},e)):t.map(e=>(0,n.jsx)(h.h,{id:"filter-category-".concat(e.categoryKey),onClick:()=>f(e),children:e.title},e.categoryKey))})}),t.map(e=>(0,n.jsx)(e5,{category:e,filterValue:l[e.categoryKey],setFilterValue:t=>r((0,g._)((0,x._)({},l),{[e.categoryKey]:t})),showToolbarItem:s||(null==b?void 0:b.categoryKey)===e.categoryKey,isDisabled:o},e.categoryKey))]}),a?(0,n.jsx)(eS.E,{variant:"pagination",children:a}):null]})},tt=e=>{let{feature:t,persistTo:l}=e;return{persistTo:l&&"string"!=typeof l?l[t]:l}};var tl=l(2997);let tr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,l=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return new Promise((r,n)=>{setTimeout(()=>{l?r(e):n(Error("Error"))},t)})},tn={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},ti={vulnerabilityStatus:{affected:(0,x._)({},tn),fixed:(0,x._)({},tn),not_affected:(0,x._)({},tn),known_not_affected:(0,x._)({},tn)}};var ta=l(715),ts=l(982),to=l(99),td=l(9629),tc=l(8383),tu=l(1757),tp=l(1527),th=l(1211),tv=l(5882),tm=l(4835),ty=l(4350),tf=l(1165),tx=l(5733),tg=l(1423),tb=l(3797),tj=l(9905),t_=l(7447),tS=l(8513);let tw=e=>{let{value:t}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(t).map(e=>{let[t,l]=e;return(0,n.jsx)(eD._,{isCompact:!0,children:"".concat(t,"=").concat(l)},"".concat(t,"=").concat(l))})})};var tT=l(4766);let tC=e=>{let{value:t,score:l,showScore:r,showLabel:i}=e,a=O[t],s=a.name,o=a.icon;return(0,n.jsxs)(eC.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(eP.B,{children:i?(0,n.jsx)(tT.J,{children:(0,n.jsx)(o,{color:a.color.value})}):(0,n.jsx)(eO.u,{content:s,children:(0,n.jsx)(tT.J,{children:(0,n.jsx)(o,{color:a.color.value})})})}),i&&(0,n.jsx)(eP.B,{children:s}),r&&null!==l&&(0,n.jsxs)(eP.B,{children:["(",Math.round(10*l)/10,")"]})]})};var tP=l(7230);let tk=e=>{let{paginationProps:t,isTop:l,isCompact:r=!1,idPrefix:i=""}=e;return(0,n.jsx)(tP.t,(0,g._)((0,x._)({id:"".concat(i?"".concat(i,"-"):"","pagination-").concat(l?"top":"bottom"),variant:l?tP.a.top:tP.a.bottom,isCompact:r},t),{widgetId:"pagination-id"}))};var tE=l(8305),tI=l(3754),tD=l(707),tO=l(6668),tV=l(2160);let tA=()=>(0,n.jsx)(tD.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:tV.ZP,variant:tD.IQ.sm,children:(0,n.jsx)(tO.B,{children:"There was an error retrieving data. Check your connection and try again."})});var tM=l(2119);let tL=e=>{let{title:t,description:l}=e;return(0,n.jsx)(tD.ub,{titleText:t,headingLevel:"h4",icon:tM.ZP,variant:tD.IQ.sm,children:l&&(0,n.jsx)(tO.B,{children:l})})},tK=()=>(0,n.jsx)(tL,{title:"No data available",description:"No data available to be shown here."}),tN=e=>{let{numRenderedColumns:t,isLoading:l=!1,isError:r=!1,isNoData:i=!1,errorEmptyState:a=null,noDataEmptyState:s=null,children:o}=e;return(0,n.jsx)(n.Fragment,{children:l?(0,n.jsx)(tg.p,{"aria-label":"Table loading",children:(0,n.jsx)(tf.Tr,{children:(0,n.jsx)(tb.Td,{colSpan:t,children:(0,n.jsx)(tE.b,{children:(0,n.jsx)(tI.$,{size:"xl"})})})})}):r?(0,n.jsx)(tg.p,{"aria-label":"Table error",children:(0,n.jsx)(tf.Tr,{children:(0,n.jsx)(tb.Td,{colSpan:t,children:(0,n.jsx)(tE.b,{children:a||(0,n.jsx)(tA,{})})})})}):i?(0,n.jsx)(tg.p,{"aria-label":"Table empty",children:(0,n.jsx)(tf.Tr,{children:(0,n.jsx)(tb.Td,{colSpan:t,children:(0,n.jsx)(tE.b,{children:s||(0,n.jsx)(tK,{})})})})}):o})},tR=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:l,children:r}=e;return(0,n.jsxs)(n.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,n.jsx)(tx.Th,{screenReaderText:"before-data-".concat(t)},t)),r,Array(l).fill(null).map((e,t)=>(0,n.jsx)(tx.Th,{screenReaderText:"after-data-".concat(t)},t))]})},tY=e=>{let{isExpansionEnabled:t=!1,expandableVariant:l,getSelectCheckboxTdProps:r,propHelpers:{getSingleExpandButtonTdProps:i},item:a,rowIndex:s,children:o}=e;return(0,n.jsxs)(n.Fragment,{children:[t&&"single"===l?(0,n.jsx)(tb.Td,(0,x._)({},i({item:a,rowIndex:s}))):null,r?(0,n.jsx)(tb.Td,(0,x._)({},r({item:a,rowIndex:s}))):null,o]})},tz=e=>{let{children:t}=e,[l,r]=i.useState(!1);return(0,n.jsx)(n.Fragment,{children:t(l,r)})},tF=e=>{let{vulnerability:t}=e;return(0,n.jsxs)("p",{children:[t.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})},tB=e=>{var t;let{vulnerabilities:l,isFetching:r,fetchError:a}=e,d=(t=e=>"".concat(e.vulnerability.identifier,"-").concat(e.status),(0,i.useMemo)(()=>l&&0!==l.length?l.map(e=>(0,g._)((0,x._)({},e),{_ui_unique_id:t(e)})):[],[l,t])),c=(e=>{let t=(e=>{let t=(e=>{var t,l;let{isFilterEnabled:r,persistTo:n="state",persistenceKeyPrefix:a}=e,[s,o]=(0,i.useState)(!0),d={};s&&(d=r&&null!=(t=null==e?void 0:e.initialFilterValues)?t:{}),(0,i.useEffect)(()=>{s&&o(!1)},[s]);let[c,u]=ev((0,x._)({isEnabled:!!r,persistenceKeyPrefix:a},"urlParams"===n?{persistTo:n,keys:["filters"],defaultValue:d,serialize:eg,deserialize:eb}:"localStorage"===n||"sessionStorage"===n?{persistTo:n,key:"filters",defaultValue:d}:er(n)?{persistTo:"provider",serialize:n.write,deserialize:()=>n.read(),defaultValue:r&&null!=(l=null==e?void 0:e.initialFilterValues)?l:{}}:{persistTo:"state",defaultValue:d}));return{filterValues:c,setFilterValues:u}})((0,x._)({},e,tt({feature:"filter",persistTo:e.persistTo}))),l=(e=>{let{isSortEnabled:t,persistTo:l="state",persistenceKeyPrefix:r}=e,n=t&&e.sortableColumns||[],i=t&&e.initialSort||null,a=n[0]?{columnKey:n[0],direction:"asc"}:null,[s,o]=ev((0,x._)({isEnabled:!!t,defaultValue:null!=i?i:a,persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["sortColumn","sortDirection"],serialize:e=>({sortColumn:(null==e?void 0:e.columnKey)||null,sortDirection:(null==e?void 0:e.direction)||null}),deserialize:e=>e.sortColumn&&e.sortDirection?{columnKey:e.sortColumn,direction:e.sortDirection}:null}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"sort"}:er(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{activeSort:s,setActiveSort:o}})((0,x._)({},e,tt({feature:"sort",persistTo:e.persistTo}))),r=(e=>{let{isPaginationEnabled:t,persistTo:l="state",persistenceKeyPrefix:r}=e,n=t&&e.initialItemsPerPage||10,i={pageNumber:1,itemsPerPage:n},[a,s]=ev((0,x._)({isEnabled:!!t,defaultValue:i,persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["pageNumber","itemsPerPage"],serialize:e=>{let{pageNumber:t,itemsPerPage:l}=e||{};return{pageNumber:t?String(t):void 0,itemsPerPage:l?String(l):void 0}},deserialize:e=>{let{pageNumber:t,itemsPerPage:l}=e||{};return t&&l?{pageNumber:Number.parseInt(t,10),itemsPerPage:Number.parseInt(l,10)}:i}}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"pagination"}:er(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"})),{pageNumber:o,itemsPerPage:d}=a||i;return{pageNumber:o,setPageNumber:e=>s({pageNumber:e>=1?e:1,itemsPerPage:(null==a?void 0:a.itemsPerPage)||n}),itemsPerPage:d,setItemsPerPage:e=>s({pageNumber:(null==a?void 0:a.pageNumber)||1,itemsPerPage:e})}})((0,x._)({},e,tt({persistTo:e.persistTo,feature:"pagination"}))),n=ex((0,x._)({},e,tt({persistTo:e.persistTo,feature:"expansion"}))),a=ef((0,x._)({},e,tt({persistTo:e.persistTo,feature:"activeItem"}))),{columnNames:s,tableName:o,initialColumns:d}=e,c=(e=>{let{initialColumns:t,supportedColumns:l,columnsKey:r}=e,n=Object.entries(l).map(e=>{var l,r,n;let[i,a]=e;return{id:i,label:a,isVisible:null==(n=null==t||null==(l=t[i])?void 0:l.isVisible)||n,isIdentity:null==t||null==(r=t[i])?void 0:r.isIdentity}}),[a,s]=ea({key:r,defaultValue:n});return(0,i.useEffect)(()=>{let e=a.filter(e=>{let{id:t}=e;return n.find(e=>t===e.id)});e.length!==n.length&&s(n.map(t=>{var l,r;return(0,g._)((0,x._)({},t),{isVisible:null!=(r=null==(l=e.find(e=>{let{id:l}=e;return l===t.id}))?void 0:l.isVisible)?r:t.isVisible})}))},[n,a,s]),{columns:a,setColumns:s,defaultColumns:n}})({columnsKey:o,initialColumns:d,supportedColumns:s});return(0,g._)((0,x._)({},e),{filterState:t,sortState:l,paginationState:r,expansionState:n,activeItemState:a,columnState:c})})(e),l=(e=>{let{items:t,isPaginationEnabled:l=!0}=e,{filteredItems:r}=(0,i.useMemo)(()=>(e=>{let{items:t,filterCategories:l=[],filterState:{filterValues:r}}=e;return{filteredItems:t.filter(e=>Object.entries(r).every(t=>{var r;let[n,i]=t;if(!i||0===i.length)return!0;let a=l.find(e=>e.categoryKey===n),s=null!=(r=null==a?void 0:a.matcher)?r:(e,t)=>{var l,r,i=e,s=null!=(r=null==a||null==(l=a.getItemValue)?void 0:l.call(a,t))?r:t[n];if(!s)return!1;let o=String(s).toLowerCase(),d=String(i).toLowerCase();return -1!==o.indexOf(d)};return i["AND"===e8(a)?"every":"some"](t=>s(t,e))}))}})({items:t,filterCategories:e.filterCategories,filterState:e.filterState}),[t,e.filterCategories,e.filterState]),{sortedItems:n}=(0,i.useMemo)(()=>(e=>{let{items:t,getSortValues:l,sortState:{activeSort:r}}=e;if(!l||!r)return{sortedItems:t};return{sortedItems:[...t].sort((e,t)=>{let n=((e,t,l)=>{let r,n;return"number"==typeof e&&"number"==typeof t?e-t:(r=String(null!=e?e:""),n=String(null!=t?t:""),r.localeCompare(n,null!=l?l:"en",{numeric:!0}))})(l(e)[r.columnKey],l(t)[r.columnKey],"en");return"asc"===r.direction?n:-n})}})({items:r,getSortValues:e.getSortValues,sortState:e.sortState}),[r,e.getSortValues,e.sortState]),{currentPageItems:a}=(0,i.useMemo)(()=>(e=>{let{items:t,paginationState:{pageNumber:l,itemsPerPage:r}}=e,n=(l-1)*r;return{currentPageItems:t.slice(n,n+r)}})({items:n,paginationState:e.paginationState}),[n,e.paginationState]);return{filteredItems:r,totalItemCount:r.length,currentPageItems:l?a:n}})((0,x._)({},e,t)),{columnState:r}=t;return(e=>{let{forceNumRenderedColumns:t,columnNames:l,idProperty:r,dataNameProperty:n,tableName:a,hasActionsColumn:s=!1,variant:o,isFilterEnabled:d,isSortEnabled:c,isSelectionEnabled:u,isExpansionEnabled:p,isActiveItemEnabled:h,columnState:{columns:v}}=e,m=eu(l),y=0,f=0;u&&y++,p&&"single"===e.expandableVariant&&y++,s&&f++;let b=t||m.length+y+f,{filterPropsForToolbar:j,propsForFilterToolbar:_}=(e=>{let{filterState:{filterValues:t,setFilterValues:l},filterCategories:r=[]}=e;return{filterPropsForToolbar:{collapseListedFiltersBreakpoint:"xl",clearAllFilters:()=>l({}),clearFiltersButtonText:"Clear all filters"},propsForFilterToolbar:{filterCategories:r,filterValues:t,setFilterValues:l}}})(e),{getSortThProps:S}=(e=>{let{sortState:{activeSort:t,setActiveSort:l},sortableColumns:r=[],columnKeys:n}=e;return{getSortThProps:e=>{let{columnKey:i}=e;return r.includes(i)?{sort:{columnIndex:n.indexOf(i),sortBy:{index:t?n.indexOf(t.columnKey):void 0,direction:null==t?void 0:t.direction},onSort:(e,t,r)=>{l({columnKey:n[t],direction:r})}}}:{}}}})((0,g._)((0,x._)({},e),{columnKeys:m})),{paginationProps:w,paginationToolbarItemProps:T}=(e=>{let{totalItemCount:t,paginationState:{itemsPerPage:l,pageNumber:r,setPageNumber:n,setItemsPerPage:a}}=e;return(e=>{let{isPaginationEnabled:t,paginationState:{itemsPerPage:l,pageNumber:r,setPageNumber:n},totalItemCount:a,isLoading:s=!1}=e,o=Math.max(Math.ceil(a/l),1);i.useEffect(()=>{t&&r>o&&!s&&n(o)})})(e),{paginationProps:{itemCount:t,perPage:l,page:r,onSetPage:(e,t)=>n(t),onPerPageSelect:(e,t)=>{n(1),a(t)}},paginationToolbarItemProps:{variant:"pagination",align:{default:"alignEnd"}}}})(e),{expansionDerivedState:C,getSingleExpandButtonTdProps:P,getCompoundExpandTdProps:k,getExpandedContentTdProps:E}=(e=>{let{columnNames:t,idProperty:l,columnKeys:r,numRenderedColumns:n,expansionState:{expandedCells:i}}=e,a=(e=>{let{idProperty:t,expansionState:{expandedCells:l,setExpandedCells:r}}=e;return{isCellExpanded:(e,r)=>r?l[String(e[t])]===r:!!l[String(e[t])],setCellExpanded:e=>{let{item:n,isExpanding:i=!0,columnKey:a}=e,s=(0,x._)({},l);i?s[String(n[t])]=a||!0:delete s[String(n[t])],r(s)}}})(e),{isCellExpanded:s,setCellExpanded:o}=a;return{expansionDerivedState:a,getSingleExpandButtonTdProps:e=>{let{item:t,rowIndex:r}=e;return{expand:{rowIndex:r,isExpanded:s(t),onToggle:()=>o({item:t,isExpanding:!s(t)}),expandId:"expandable-row-".concat(t[l])}}},getCompoundExpandTdProps:e=>{let{columnKey:t,item:n,rowIndex:i}=e;return{compoundExpand:{isExpanded:s(n,t),onToggle:()=>o({item:n,isExpanding:!s(n,t),columnKey:t}),expandId:"compound-expand-".concat(n[l],"-").concat(t),rowIndex:i,columnIndex:r.indexOf(t)}}},getExpandedContentTdProps:e=>{let{item:r}=e,a=i[String(r[l])];return{dataLabel:"string"==typeof a?t[a]:void 0,noPadding:!0,colSpan:n,width:100}}}})((0,g._)((0,x._)({},e),{columnKeys:m,numRenderedColumns:b})),{activeItemDerivedState:I,getActiveItemTrProps:D}=(e=>{let t=(e=>{let{currentPageItems:t,idProperty:l,activeItemState:{activeItemId:r,setActiveItemId:n}}=e;return{activeItem:t.find(e=>e[l]===r)||null,setActiveItem:e=>{var t;n(null!=(t=null==e?void 0:e[l])?t:null)},clearActiveItem:()=>n(null),isActiveItem:e=>e[l]===r}})(e),{isActiveItem:l,setActiveItem:r,clearActiveItem:n}=t;return(e=>{let{isLoading:t,activeItemState:{activeItemId:l},activeItemDerivedState:{activeItem:r,clearActiveItem:n}}=e;i.useEffect(()=>{t||!l||r||n()},[t,l,r])})((0,g._)((0,x._)({},e),{activeItemDerivedState:t})),{activeItemDerivedState:t,getActiveItemTrProps:e=>{let{item:t}=e;return{isSelectable:!0,isClickable:!0,isRowSelected:t&&l(t),onRowClick:()=>{l(t)?n():r(t)}}}}})(e),O=(0,x._)({className:"compact"===o?tl.Z.pt_0:""},d&&j),V={variant:o,isExpandable:p&&!!e.expandableVariant};return(0,g._)((0,x._)({},e),{numColumnsBeforeData:y,numColumnsAfterData:f,numRenderedColumns:b,expansionDerivedState:C,activeItemDerivedState:I,propHelpers:{toolbarProps:O,tableProps:V,getThProps:e=>{let{columnKey:t}=e;return(0,g._)((0,x._)({},c&&S({columnKey:t})),{children:l[t]})},getTrProps:e=>{let{item:t,onRowClick:l}=e,i=D({item:t});return(0,g._)((0,x._)({id:"".concat(a,"-row-item-").concat(t[r]),"data-item-id":t[r],"data-item-name":n&&t[n]},h&&i),{onRowClick:e=>((e,t)=>{let l=e=>{var t;return!!["input","button","a"].includes(e.tagName.toLowerCase())||!!e.parentElement&&(null==(t=e.parentElement)?void 0:t.tagName.toLowerCase())!=="tr"&&l(e.parentElement)};(null==e?void 0:e.target)instanceof Element&&!l(e.target)&&t(e)})(e,()=>{var t;null==(t=i.onRowClick)||t.call(i,e),null==l||l(e)})})},getTdProps:t=>{let{columnKey:r}=t;return(0,x._)({dataLabel:l[r]},p&&"compound"===e.expandableVariant&&t.isCompoundExpandToggle&&k({columnKey:r,item:t.item,rowIndex:t.rowIndex}))},filterToolbarProps:_,filterPanelProps:_,paginationProps:w,paginationToolbarItemProps:T,toolbarBulkExpanderProps:{},getSingleExpandButtonTdProps:P,getExpandedContentTdProps:E,getColumnVisibility:e=>{var t,l;return null==(l=null==(t=v.find(t=>t.id===e))?void 0:t.isVisible)||l}}})})((0,g._)((0,x._)({},e,t,l,r),{idProperty:e.idProperty}))})({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:d,isLoading:r,columnNames:{vulnerabilityId:"Vulnerability ID",description:"Description",status:"Status",severity:"Severity",affectedPackages:"Affected packages",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["vulnerabilityId","severity","affectedPackages","published","updated"],getSortValues:e=>{var t,l,r,n;return{vulnerabilityId:e.vulnerability.identifier,severity:null!=(n=null==(t=e.opinionatedAvisory.score)?void 0:t.value)?n:0,affectedPackages:e.purls.size,published:(null==(l=e.vulnerability)?void 0:l.published)?eo()(e.vulnerability.published).valueOf():0,updated:(null==(r=e.vulnerability)?void 0:r.modified)?eo()(e.vulnerability.modified).valueOf():0}},isFilterEnabled:!0,filterCategories:[{categoryKey:"vulnerabilityId",title:"Vulnerability id",type:e6.search,placeholderText:"Search by Vulnerability id",getItemValue:e=>e.vulnerability.identifier},{categoryKey:"severity",title:"Severity",type:e6.multiselect,placeholderText:"Severity",selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],matcher:(e,t)=>e===t.opinionatedAvisory.extendedSeverity},{categoryKey:"status",title:"Status",type:e6.multiselect,placeholderText:"Status",selectOptions:[{value:"affected",label:"Affected"},{value:"under_investigation",label:"Under investigation"}],matcher:(e,t)=>e===t.status}],isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:p,propHelpers:{toolbarProps:h,paginationToolbarItemProps:v,paginationProps:m,tableProps:y,filterToolbarProps:f,getThProps:b,getTrProps:j,getTdProps:_,getExpandedContentTdProps:S},expansionDerivedState:{isCellExpanded:w}}=c;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ta.o,(0,g._)((0,x._)({},h),{children:(0,n.jsxs)(ts.c,{children:[(0,n.jsx)(te,(0,x._)({},f)),(0,n.jsx)(eS.E,(0,g._)((0,x._)({},v),{children:(0,n.jsx)(tk,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:m})}))]})})),(0,n.jsxs)(tm.i,(0,g._)((0,x._)({},y),{"aria-label":"Vulnerability table",children:[(0,n.jsx)(ty.h,{children:(0,n.jsx)(tf.Tr,{children:(0,n.jsxs)(tR,(0,g._)((0,x._)({},c),{children:[(0,n.jsx)(tx.Th,(0,x._)({},b({columnKey:"vulnerabilityId"}))),(0,n.jsx)(tx.Th,(0,x._)({},b({columnKey:"description"}))),(0,n.jsx)(tx.Th,(0,x._)({},b({columnKey:"status"}))),(0,n.jsx)(tx.Th,(0,x._)({},b({columnKey:"severity"}))),(0,n.jsx)(tx.Th,(0,x._)({},b({columnKey:"affectedPackages"}))),(0,n.jsx)(tx.Th,(0,x._)({},b({columnKey:"published"}))),(0,n.jsx)(tx.Th,(0,x._)({},b({columnKey:"updated"})))]}))})}),(0,n.jsx)(tN,{isLoading:r,isError:!!a,isNoData:0===d.length,numRenderedColumns:p,children:null==u?void 0:u.map((e,t)=>{var l,r,i,a,d,u,p;return(0,n.jsxs)(tg.p,{isExpanded:w(e),children:[(0,n.jsx)(tf.Tr,(0,g._)((0,x._)({},j({item:e})),{children:(0,n.jsxs)(tY,(0,g._)((0,x._)({},c),{item:e,rowIndex:t,children:[(0,n.jsx)(tb.Td,(0,g._)((0,x._)({width:15,modifier:"breakWord"},_({columnKey:"vulnerabilityId",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:e.vulnerability.identifier})),(0,n.jsx)(tz,{children:(t,l)=>(0,n.jsx)(tb.Td,(0,g._)((0,x._)({width:35,modifier:"truncate",onFocus:()=>l(!0),onBlur:()=>l(!1),tabIndex:0},_({columnKey:"description"})),{children:(0,n.jsx)(tj.cE,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,n.jsx)(tF,{vulnerability:e.vulnerability})})}))}),(0,n.jsx)(tb.Td,(0,g._)((0,x._)({width:10,modifier:"truncate"},_({columnKey:"status"})),{children:e.status})),(0,n.jsx)(tb.Td,(0,g._)((0,x._)({width:10,modifier:"breakWord"},_({columnKey:"severity"})),{children:(0,n.jsx)(to.J,{triggerAction:"hover","aria-label":"Hoverable popover",headerContent:(0,n.jsx)("div",{children:null==(r=e.opinionatedAvisory.advisory)||null==(l=r.issuer)?void 0:l.name}),bodyContent:(0,n.jsxs)("div",{children:["CVSS v",null==(i=e.opinionatedAvisory.score)?void 0:i.type]}),children:(0,n.jsx)(tC,{value:e.opinionatedAvisory.extendedSeverity,score:null!=(p=null==(a=e.opinionatedAvisory.score)?void 0:a.value)?p:null,showLabel:!0,showScore:!0})})})),(0,n.jsx)(tb.Td,(0,g._)((0,x._)({width:10,modifier:"truncate"},_({columnKey:"affectedPackages",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:e.purls.size})),(0,n.jsx)(tb.Td,(0,g._)((0,x._)({width:10,modifier:"truncate"},_({columnKey:"published"})),{children:ec(null==(d=e.vulnerability)?void 0:d.published)})),(0,n.jsx)(tb.Td,(0,g._)((0,x._)({width:10,modifier:"truncate"},_({columnKey:"updated"})),{children:ec(null==(u=e.vulnerability)?void 0:u.modified)}))]}))})),w(e)?(0,n.jsx)(tf.Tr,{isExpanded:!0,children:(0,n.jsx)(tb.Td,(0,g._)((0,x._)({},S({item:e})),{children:(0,n.jsxs)(t_.G,{children:[w(e,"vulnerabilityId")?(0,n.jsx)("div",{className:tl.Z.mMd,children:(0,n.jsx)(td.r,{hasGutter:!0,minWidths:{md:"350px"},children:Array.from(e.advisories.values()).map(e=>{var t,l;let{advisory:r,scores:i,opinionatedExtendedSeverity:a,opinionatedScore:d}=e;return(0,n.jsx)(tc.L,{children:(0,n.jsxs)(tu.Z,{isCompact:!0,children:[(0,n.jsx)(tp.e,{children:(0,n.jsxs)(s.P,{children:[(0,n.jsx)(o.J,{isFilled:!0,children:null==(t=r.issuer)?void 0:t.name}),(0,n.jsx)(o.J,{children:(0,n.jsx)(tC,{value:a,score:null!=(l=null==d?void 0:d.value)?l:0,showLabel:!0,showScore:!0})})]})}),(0,n.jsx)(tp.e,{style:{padding:"0 0 15px 0"},children:(0,n.jsxs)(tm.i,{variant:"compact",children:[(0,n.jsx)(tS.Y,{children:"Scores"}),(0,n.jsx)(tg.p,{children:i.map((e,t)=>(0,n.jsxs)(tf.Tr,{children:[(0,n.jsx)(tb.Td,{children:(0,n.jsx)(tC,{value:e.severity,score:e.value,showLabel:!0,showScore:!0})}),(0,n.jsxs)(tb.Td,{children:["CVSS v",e.type]})]},"".concat(t,"-").concat(e.type,"-").concat(e.value)))})]})})]})},r.document_id)})})}):null,w(e,"severity")?(0,n.jsx)(th.aV,{isPlain:!0,children:Array.from(e.advisories.values()).map(e=>(0,n.jsx)(tv.H,{children:e.advisory.identifier},"".concat(e.advisory.identifier)))}):null,w(e,"affectedPackages")?(0,n.jsxs)(tm.i,{variant:"compact",children:[(0,n.jsx)(ty.h,{children:(0,n.jsxs)(tf.Tr,{children:[(0,n.jsx)(tx.Th,{children:"Type"}),(0,n.jsx)(tx.Th,{children:"Namespace"}),(0,n.jsx)(tx.Th,{children:"Name"}),(0,n.jsx)(tx.Th,{children:"Version"}),(0,n.jsx)(tx.Th,{children:"Path"}),(0,n.jsx)(tx.Th,{children:"Qualifiers"})]})}),(0,n.jsx)(tg.p,{children:Array.from(e.purls.values()).map(e=>{let t=(e=>{try{var t,l,r,n;let i=ed.PackageURL.fromString(e);return{type:i.type,name:i.name,namespace:null!=(t=i.namespace)?t:void 0,version:null!=(l=i.version)?l:void 0,qualifiers:null!=(r=i.qualifiers)?r:void 0,path:null!=(n=i.subpath)?n:void 0}}catch(e){console.error(e);return}})(e);return t?(0,n.jsxs)(tf.Tr,{children:[(0,n.jsx)(tb.Td,{children:null==t?void 0:t.type}),(0,n.jsx)(tb.Td,{children:null==t?void 0:t.namespace}),(0,n.jsx)(tb.Td,{children:null==t?void 0:t.name}),(0,n.jsx)(tb.Td,{children:null==t?void 0:t.version}),(0,n.jsx)(tb.Td,{children:null==t?void 0:t.path}),(0,n.jsx)(tb.Td,{children:(null==t?void 0:t.qualifiers)&&(0,n.jsx)(tw,{value:null==t?void 0:t.qualifiers})})]},e):(0,n.jsx)(tf.Tr,{children:(0,n.jsx)(tb.Td,{colSpan:6,children:e})},e)})})]}):null]})}))}):null]},e._ui_unique_id)})})]})),(0,n.jsx)(tk,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:m})]})};var tq=l(7727),tU=l(3498),tW=l(7069),tZ=l(8447),tJ=l(7445);let tH=e=>{var t;let{severities:l}=e,r=Object.values(l).reduce((e,t)=>e+t,0);return(0,n.jsxs)(eC.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(eP.B,{"aria-label":"total",style:{minWidth:15,textAlign:tJ.F2},children:r}),(0,n.jsx)(tZ.i,{orientation:{default:"vertical"}}),(0,n.jsx)(eP.B,{children:(0,n.jsx)(eC.k,{children:Object.entries(l).filter(e=>{let[t,l]=e;return l>0}).sort((t=e=>{let[t,l]=e;return t},(e,l)=>V(t(e))-V(t(l)))).reverse().map(e=>{let[t,l]=e;return(0,n.jsx)(eP.B,{spacer:{default:"spacerXs"},children:(0,n.jsxs)(eC.k,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(eP.B,{children:(0,n.jsx)(tC,{value:t,score:null})}),(0,n.jsx)(eP.B,{children:l})]})},t)})})})]})},tG=e=>{let{summary:t}=e;return(0,n.jsxs)(tq.r,{hasGutter:!0,children:[(0,n.jsx)(tU.P,{md:4,children:(0,n.jsxs)(tu.Z,{children:[(0,n.jsx)(tW.l,{children:(0,n.jsx)(tE.b,{children:"Total vulnerabilities"})}),(0,n.jsx)(tp.e,{children:(0,n.jsx)(tE.b,{children:t.vulnerabilityStatus.affected.total})})]})}),(0,n.jsx)(tU.P,{md:4,children:(0,n.jsxs)(tu.Z,{children:[(0,n.jsx)(tW.l,{children:(0,n.jsx)(tE.b,{children:"Affected packages"})}),(0,n.jsx)(tp.e,{children:(0,n.jsx)(tE.b,{children:t.vulnerabilityStatus.affected.total})})]})}),(0,n.jsx)(tU.P,{md:4,children:(0,n.jsxs)(tu.Z,{children:[(0,n.jsx)(tW.l,{children:(0,n.jsx)(tE.b,{children:"Vulnerabilities by severity"})}),(0,n.jsx)(tp.e,{children:(0,n.jsx)(tE.b,{children:(0,n.jsx)(tH,{severities:t.vulnerabilityStatus.affected.severities})})})]})})]})},t$=()=>{let[e,t]=i.useState(!1),l=()=>{t(!e)},{data:{vulnerabilities:r,summary:f},isFetching:b}=(e=>{let{packages:t,isFetching:l,fetchError:r}=(e=>{let t="off"===y.Z.MOCK?{ids:e.reduce((e,t,l)=>(l%100==0?e.push([t]):e[e.length-1].push(t),e),[]),dataResolver:async e=>{var t,l;return(await (null!=(l=(t={client:et,body:{purls:e}}).client)?l:el).post((0,g._)((0,x._)({responseType:"json",url:"/api/v2/vulnerability/analyze"},t),{headers:(0,x._)({"Content-Type":"application/json"},t.headers)}))).data}}:{ids:[e],dataResolver:e=>{var t;return tr(null!=(t=window.__analysisResponse)?t:{})}},l=(0,N.h)({queries:t.ids.map(e=>({queryKey:["vulnerabilities",e],queryFn:()=>t.dataResolver(e),retry:!1}))}),r=l.some(e=>{let{isLoading:t}=e;return t}),n=l.find(e=>{let{error:t}=e;return!!t}),i={};if(!r)for(let e of l.map(e=>{var t;return null!=(t=null==e?void 0:e.data)?t:{}}))for(let[t,l]of Object.entries(e))i[t]=l;return{packages:i,isFetching:r,fetchError:n}})(e);return{data:i.useMemo(()=>{if(l||r||0===Object.keys(t).length)return{summary:(0,x._)({},ti),vulnerabilities:[]};let e=Object.entries(t).flatMap(e=>{let[t,l]=e;return l.details.flatMap(e=>Object.entries(e.status).flatMap(l=>{let[r,n]=l;return n.map(l=>({purl:t,vulnerability:e,status:r,advisory:l,scores:l.scores}))}))}).reduce((e,t)=>{let l,r=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.status===t.status,n=e.find(e=>r(e,t));if(n){var i,a,s,o;let d=e.filter(e=>!r(e,n)),c=L(t.scores),u=K(null==c?void 0:c.severity),p=new Map(n.advisories);p.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedScore:c,opinionatedExtendedSeverity:u});let h=new Set(n.purls);h.add(t.purl);let v=null,m=null;if((null==(i=n.opinionatedAvisory.score)?void 0:i.type)!==(null==c?void 0:c.type)){let e=[{advisory:n.opinionatedAvisory.advisory,score:n.opinionatedAvisory.score},{advisory:t.advisory,score:c}].sort(M(e=>{var t,l;return null!=(l=null==(t=e.score)?void 0:t.type)?l:null}))[0];v=e.advisory,m=e.score}else{let{advisory:e,score:l}=(null!=(s=null==c?void 0:c.value)?s:0)>(null!=(o=null==(a=n.opinionatedAvisory.score)?void 0:a.value)?o:0)?{score:c,advisory:t.advisory}:{score:n.opinionatedAvisory.score,advisory:n.opinionatedAvisory.advisory};v=e,m=l}let y=K(null==m?void 0:m.severity);l=[...d,{vulnerability:n.vulnerability,status:n.status,advisories:p,purls:h,opinionatedAvisory:{advisory:v,score:m,extendedSeverity:y}}]}else{let r=L(t.scores),n=K(null==r?void 0:r.severity),i=new Map;i.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedExtendedSeverity:n,opinionatedScore:r});let a=new Set;a.add(t.purl);let s={vulnerability:t.vulnerability,status:t.status,advisories:i,purls:a,opinionatedAvisory:{advisory:t.advisory,score:r,extendedSeverity:n}};l=[...e.slice(),s]}return l},[]),n=e.reduce((e,t)=>{let l=t.status,r=t.opinionatedAvisory.extendedSeverity,n=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,g._)((0,x._)({},e.vulnerabilityStatus),{[l]:{total:n.total+1,severities:(0,g._)((0,x._)({},n.severities),{[r]:n.severities[r]+1})}})})},(0,x._)({},ti));return{vulnerabilities:e,summary:n}},[t,l,r]),isFetching:l,fetchError:r}})(window.__purls);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.NP,{children:(0,n.jsxs)(s.P,{children:[(0,n.jsx)(o.J,{isFilled:!0,children:(0,n.jsxs)(d.V,{children:[(0,n.jsx)(d.V,{component:"h1",children:"Vulnerabilities"}),(0,n.jsx)(d.V,{component:"p",children:"This is a temporary vulnerability report."})]})}),(0,n.jsx)(o.J,{children:(0,n.jsx)(c.L,{isOpen:e,onSelect:()=>t(!1),onOpenChange:e=>t(e),popperProps:{position:"right"},toggle:t=>(0,n.jsx)(u.O_,{ref:t,onClick:l,isExpanded:e,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,n.jsx)(p.s,{children:(0,n.jsx)(h.h,{children:"Download CSV"},"csv")})})})]})}),(0,n.jsx)(a.NP,{children:(0,n.jsxs)(v.K,{hasGutter:!0,children:[(0,n.jsx)(m.v,{children:(0,n.jsx)(tG,{summary:f,isFetching:b})}),(0,n.jsx)(m.v,{children:(0,n.jsx)(tB,{vulnerabilities:r,isFetching:b})})]})})]})}}}]);