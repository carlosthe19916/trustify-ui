"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["411"],{2048:function(e,t,l){l.r(t),l.d(t,{default:()=>tR});var r,n=l(4246),a=l(7378),i=l(5043),o=l(1192),s=l(2591),d=l(8802),c=l(2939),u=l(4620),p=l(7961),h=l(9265),v=l(4387);v.Z.AUTH_REQUIRED;let m="true"===v.Z.OIDC_SERVER_IS_EMBEDDED,f="off"===v.Z.MOCK;var y=l(9192),g=l(3195),x=l(1566),b=l(839),j=l(3657),_=l(644),S=l(9502),w=l(7596),T=l(1811),C=l(4917),k=l(4720),P=l(4178),E=l(7106),I=l(4313);let D={unknown:{name:"Unknown",color:T.P,progressProps:{variant:void 0},icon:x.M$},none:{name:"None",color:C.E,progressProps:{variant:void 0},icon:b.f6},low:{name:"Low",color:k.c,progressProps:{variant:void 0},icon:j._$},medium:{name:"Medium",color:P.L,progressProps:{variant:"warning"},icon:_.zI},high:{name:"High",color:E.H,progressProps:{variant:"danger"},icon:S.E2},critical:{name:"Critical",color:I.J,progressProps:{variant:"danger"},icon:w.ki}},O={fixed:{name:"Fixed",color:"blue"},not_affected:{name:"Not affected",color:"green"},known_not_affected:{name:"Known not affected",color:"green"},under_investigation:{name:"Under investigation",color:"yellow"},affected:{name:"Affected",color:"red"}},V=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function M(e){return(t,l)=>V(e(t))-V(e(l))}let A=e=>0===e.length?null:e.sort(M(e=>e.type))[0],K=e=>null!=e?e:"unknown";var N=l(233);l(1839),m?v.V.OIDC_SERVER_EMBEDDED_PATH:v.V.OIDC_SERVER_URL,v.V.OIDC_CLIENT_ID,window.location.origin,window.location.origin,v.V.OIDC_SCOPE,Object.entries({$body_:"body",$headers_:"headers",$path_:"path",$query_:"query"});var L=l(186);let R=async(e,t)=>{let l="function"==typeof t?await t(e):t;if(l)return"bearer"===e.scheme?"Bearer ".concat(l):"basic"===e.scheme?"Basic ".concat(btoa(l)):l},Y=e=>{let{allowReserved:t,explode:l,name:r,style:n,value:a}=e;if(!l){let e=(t?a:a.map(e=>encodeURIComponent(e))).join((e=>{switch(e){case"form":default:return",";case"pipeDelimited":return"|";case"spaceDelimited":return"%20"}})(n));switch(n){case"label":return".".concat(e);case"matrix":return";".concat(r,"=").concat(e);case"simple":return e;default:return"".concat(r,"=").concat(e)}}let i=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(n),o=a.map(e=>"label"===n||"simple"===n?t?e:encodeURIComponent(e):z({allowReserved:t,name:r,value:e})).join(i);return"label"===n||"matrix"===n?i+o:o},z=e=>{let{allowReserved:t,name:l,value:r}=e;if(null==r)return"";if("object"==typeof r)throw Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return"".concat(l,"=").concat(t?r:encodeURIComponent(r))},F=e=>{let{allowReserved:t,explode:l,name:r,style:n,value:a,valueOnly:i}=e;if(a instanceof Date)return i?a.toISOString():"".concat(r,"=").concat(a.toISOString());if("deepObject"!==n&&!l){let e=[];Object.entries(a).forEach(l=>{let[r,n]=l;e=[...e,r,t?n:encodeURIComponent(n)]});let l=e.join(",");switch(n){case"form":return"".concat(r,"=").concat(l);case"label":return".".concat(l);case"matrix":return";".concat(r,"=").concat(l);default:return l}}let o=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(n),s=Object.entries(a).map(e=>{let[l,a]=e;return z({allowReserved:t,name:"deepObject"===n?"".concat(r,"[").concat(l,"]"):l,value:a})}).join(o);return"label"===n||"matrix"===n?o+s:s},q=/\{[^{}]+\}/g,B=function(){let{allowReserved:e,array:t,object:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r=>{let n=[];if(r&&"object"==typeof r)for(let a in r){let i=r[a];if(null!=i)if(Array.isArray(i)){let l=Y((0,y._)({allowReserved:e,explode:!0,name:a,style:"form",value:i},t));l&&n.push(l)}else if("object"==typeof i){let t=F((0,y._)({allowReserved:e,explode:!0,name:a,style:"deepObject",value:i},l));t&&n.push(t)}else{let t=z({allowReserved:e,name:a,value:i});t&&n.push(t)}}return n.join("&")}},U=async e=>{var t,{security:l}=e,r=(0,L._)(e,["security"]);for(let e of l){let l=await R(e,r.auth);if(!l)continue;let n=null!=(t=e.name)?t:"Authorization";switch(e.in){case"query":r.query||(r.query={}),r.query[n]=l;break;case"cookie":{let e="".concat(n,"=").concat(l);"Cookie"in r.headers&&r.headers.Cookie?r.headers.Cookie="".concat(r.headers.Cookie,"; ").concat(e):r.headers.Cookie=e;break}default:r.headers[n]=l}return}},W=e=>H({path:e.path,query:e.paramsSerializer?void 0:e.query,querySerializer:"function"==typeof e.querySerializer?e.querySerializer:B(e.querySerializer),url:e.url}),H=e=>{let{path:t,query:l,querySerializer:r,url:n}=e,a=n.startsWith("/")?n:"/".concat(n);t&&(a=(e=>{let{path:t,url:l}=e,r=l,n=l.match(q);if(n)for(let e of n){let l=!1,n=e.substring(1,e.length-1),a="simple";n.endsWith("*")&&(l=!0,n=n.substring(0,n.length-1)),n.startsWith(".")?(n=n.substring(1),a="label"):n.startsWith(";")&&(n=n.substring(1),a="matrix");let i=t[n];if(null==i)continue;if(Array.isArray(i)){r=r.replace(e,Y({explode:l,name:n,style:a,value:i}));continue}if("object"==typeof i){r=r.replace(e,F({explode:l,name:n,style:a,value:i,valueOnly:!0}));continue}if("matrix"===a){r=r.replace(e,";".concat(z({name:n,value:i})));continue}let o=encodeURIComponent("label"===a?".".concat(i):i);r=r.replace(e,o)}return r})({path:t,url:a}));let i=l?r(l):"";return i.startsWith("?")&&(i=i.substring(1)),i&&(a+="?".concat(i)),a},J=(e,t)=>{let l=(0,y._)({},e,t);return l.headers=$(e.headers,t.headers),l},Z=["common","delete","get","head","patch","post","put"],$=function(){for(var e,t=arguments.length,l=Array(t),r=0;r<t;r++)l[r]=arguments[r];let n={};for(let t of l)if(t&&"object"==typeof t)for(let[l,r]of Object.entries(t))if(Z.includes(l)&&"object"==typeof r)n[l]=(0,y._)({},n[l],r);else if(null===r)delete n[l];else if(Array.isArray(r))for(let t of r)n[l]=[...null!=(e=n[l])?e:[],t];else void 0!==r&&(n[l]="object"==typeof r?JSON.stringify(r):r);return n},G=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,y._)({},e)},Q=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=J(G(),t);if(!l.axios||"Axios"in l.axios){let{auth:t}=l,r=(0,L._)(l,["auth"]);e=N.Z.create(r)}else e=l.axios;let r=()=>(0,y._)({},l),n=async t=>{var r,n,a,i;let o=(0,g._)((0,y._)({},l,t),{axios:null!=(n=null!=(r=t.axios)?r:l.axios)?n:e,headers:$(l.headers,t.headers)});o.security&&await U((0,g._)((0,y._)({},o),{security:o.security})),o.requestValidator&&await o.requestValidator(o),o.body&&o.bodySerializer&&(o.body=o.bodySerializer(o.body));let s=W(o);try{let e=o.axios,{auth:t}=o,l=(0,L._)(o,["auth"]),r=await e((0,g._)((0,y._)({},l),{baseURL:o.baseURL,data:o.body,headers:o.headers,params:o.paramsSerializer?o.query:void 0,url:s})),{data:n}=r;return"json"===o.responseType&&(o.responseValidator&&await o.responseValidator(n),o.responseTransformer&&(n=await o.responseTransformer(n))),(0,g._)((0,y._)({},r),{data:null!=n?n:{}})}catch(e){if(o.throwOnError)throw e;return e.error=null!=(i=null==(a=e.response)?void 0:a.data)?i:{},e}};return{buildUrl:W,delete:e=>n((0,g._)((0,y._)({},e),{method:"DELETE"})),get:e=>n((0,g._)((0,y._)({},e),{method:"GET"})),getConfig:r,head:e=>n((0,g._)((0,y._)({},e),{method:"HEAD"})),instance:e,options:e=>n((0,g._)((0,y._)({},e),{method:"OPTIONS"})),patch:e=>n((0,g._)((0,y._)({},e),{method:"PATCH"})),post:e=>n((0,g._)((0,y._)({},e),{method:"POST"})),put:e=>n((0,g._)((0,y._)({},e),{method:"PUT"})),request:n,setConfig:t=>(l=J(l,t),e.defaults=(0,g._)((0,y._)({},e.defaults,l),{headers:$(e.defaults.headers,l.headers)}),r())}},X=Q({baseURL:"/",axios:N.Z,throwOnError:!0}),ee=Q(G()),et=(e,t,l)=>{if("undefined"==typeof window)return l;try{let r=window[e].getItem(t);return r?JSON.parse(r):l}catch(e){return console.error(e),l}},el=e=>{let{isEnabled:t=!0,type:l,key:r,defaultValue:n}=e,[i,o]=a.useState(et(l,r,n)),s="localStorage"===l&&"undefined"!=typeof window&&t,d=a.useCallback(e=>{let t=e instanceof Function?e(et(l,r,n)):e;if("undefined"!=typeof window)try{if(void 0!==t){let e=JSON.stringify(t);window[l].setItem(r,e),"localStorage"===l&&window.dispatchEvent(new StorageEvent("storage",{key:r,newValue:e}))}else window[l].removeItem(r),"localStorage"===l&&window.dispatchEvent(new StorageEvent("storage",{key:r,newValue:null}))}catch(e){console.error(e)}s||o(t)},[l,r,n,s]);return a.useEffect(()=>{if(!s)return;let e=e=>{e.key===r&&o(e.newValue?JSON.parse(e.newValue):n)};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[r,n,s]),[i,d]},er=e=>el((0,g._)((0,y._)({},e),{type:"localStorage"}));var en=l(7693),ea=l.n(en),ei=l(8318);let eo=e=>e?ea()(e).format("MMM DD, YYYY"):null,es=e=>Object.keys(e),ed=e=>"function"==typeof e?e():e;var ec=l(4935);let eu=e=>{let t,{defaultValue:l,persistTo:r,persistenceKeyPrefix:n,isEnabled:i=!0}=e,o=e=>"localStorage"===e.persistTo||"sessionStorage"===e.persistTo,s=e=>n?"".concat(n,":").concat(e):e,[d,c]={state:a.useState(l),urlParams:(e=>{let{isEnabled:t=!0,persistenceKeyPrefix:l,keys:r,defaultValue:n,serialize:i,deserialize:o}=e,s=(0,ec.s0)(),d=e=>l?"".concat(l,":").concat(e):e,c=e=>{var t;let{hash:l,pathname:r,search:n}=e;if(f)return{pathname:r,search:n};let a=l.replace(/^#/,"").split("?");return{pathname:a[0],search:null!=(t=a[1])?t:""}},u=e=>{let t,{search:r,pathname:n}=c({hash:document.location.hash,pathname:document.location.pathname,search:document.location.search});s({pathname:n,search:(e=>{let{existingSearchParams:t=new URLSearchParams,newPrefixedSerializedParams:l}=e,r=Object.fromEntries(t);for(let e of es(l))void 0===l[e]&&delete l[e],null===l[e]&&(delete l[e],delete r[e]);let n=new URLSearchParams((0,y._)({},r,l));return n.sort(),n.toString()})({existingSearchParams:new URLSearchParams(r),newPrefixedSerializedParams:(t=i(e),l?es(t).reduce((e,l)=>(e[d(l)]=t[l],e),{}):t)})},{replace:!0})},p=(0,ec.TH)(),{search:h}=c({hash:p.hash,pathname:p.pathname,search:p.search}),v=new URLSearchParams(h),m=!0,g=n;if(t){let e=r.reduce((e,t)=>(e[t]=v.get(d(t)),e),{});g=(m=r.every(t=>!e[t]))?n:o(e)}return a.useEffect(()=>{m&&u(n)},[m]),[g,u]})("urlParams"===e.persistTo?e:(0,g._)((0,y._)({},e),{isEnabled:!1,keys:[],serialize:()=>({}),deserialize:()=>l})),localStorage:er(o(e)?(0,g._)((0,y._)({},e),{key:s(e.key)}):(0,g._)((0,y._)({},e),{isEnabled:!1,key:""})),sessionStorage:(t=o(e)?(0,g._)((0,y._)({},e),{key:s(e.key)}):(0,g._)((0,y._)({},e),{isEnabled:!1,key:""}),el((0,g._)((0,y._)({},t),{type:"sessionStorage"}))),provider:ep(eh(e)?e:{serialize:()=>{},deserialize:()=>l,defaultValue:l,isEnabled:!1,persistTo:"provider"})}[r||"state"];return i?[d,c]:[l,()=>{}]},ep=e=>{var t;let{serialize:l,deserialize:r,defaultValue:n}=e;return[null!=(t=r())?t:n,l]},eh=e=>"provider"===e.persistTo,ev=e=>!!(null==e?void 0:e.write)&&!!(null==e?void 0:e.read),em=e=>{let t=(0,y._)({},e);for(let e of es(t)){var l;t[e]&&(null==(l=t[e])?void 0:l.length)!==0||delete t[e]}return{filters:es(t).length>0?JSON.stringify(t):null}},ef=e=>{try{return JSON.parse(e.filters||"{}")}catch(e){return{}}};var ey=l(272),eg=l(3874),ex=l(9226),eb=l(4296),ej=l(9826),e_=l(4747),eS=l(6770),ew=l(8037),eT=l(2623),eC=l(2364),ek=l(400),eP=l(2499);let eE=e=>{let{content:t,children:l}=e;return t?(0,n.jsx)(eP.u,{content:(0,n.jsx)("div",{children:ed(t)}),children:l}):l};var eI=l(9426),eD=l(2050),eO=l(9589),eV=l(8700),eM=l(9767),eA=l(9765);let eK=e=>{let{id:t,placeholder:l,ariaLabel:r,onSearchChange:a,onClear:i,onKeyHandling:o,onClick:s,options:d,inputValue:c,inputRef:u,isDropdownOpen:p,activeItem:h}=e,v=(()=>{if(0===d.length)return"";if(1===d.length&&c){let e=ed(d[0].name);if(0===e.toLowerCase().indexOf(c.toLowerCase()))return c+e.substring(c.length)}return""})();return(0,n.jsxs)(eI.W,{isPlain:!0,children:[(0,n.jsx)(eD.v,(0,g._)((0,y._)({id:t,value:c,onClick:s,onChange:(e,t)=>a(t),onKeyDown:o,autoComplete:"off",innerRef:u,placeholder:l},h&&{"aria-activedescendant":h.id}),{role:"combobox",isExpanded:p,"aria-label":r,"aria-controls":"select-typeahead-listbox",hint:v,icon:(0,n.jsx)(eM.ZP,{})})),(0,n.jsx)(eO.t,{children:!!c&&(0,n.jsx)(eV.zx,{icon:(0,n.jsx)(eA.ZP,{"aria-hidden":!0}),variant:"plain",onClick:i,"aria-label":"Clear input value"})})]})},eN=e=>{let{id:t="",onChange:l,filterBeforeOnChange:r,options:i=[],placeholderText:o="Search",searchString:s="",searchInputAriaLabel:d="Search input",labelColor:c,selections:p=[],noResultsMessage:h,showChips:v,onSearchChange:m,onCreateNewOption:f,validateNewOption:x,isDisabled:b}=e,j=(0,a.useRef)(null),_=(0,a.useRef)(null),{inputValue:S,isDropdownOpen:w,setIsDropdownOpen:T,optionsNotSelected:C,removeSelectionById:k,handleOnSelect:P,handleOnCreateNewOption:E,handleInputChange:I,handleKeyDown:D,handleClearSearchInput:O,handleClickSearchInput:V,handleClickToggle:M,activeItem:A,focusedItemIndex:K}=(e=>{let{options:t,searchString:l,selections:r,onChange:n,menuRef:i,searchInputRef:o,onCreateNewOption:s,validateNewOption:d,onSearchChange:c,filterBeforeOnChange:u}=e,[p,h]=(0,a.useState)(l),[v,m]=(0,a.useState)(!1),[f,y]=(0,a.useState)(null),[g,x]=(0,a.useState)(null),b=(0,a.useMemo)(()=>t.filter(e=>!r.some(t=>t.id===e.id)),[t,r]),j=e=>{h(e),x(null),y(null),e&&!v&&m(!0),c&&c(e)},_=e=>{n([...u?u(r,e):r,e]),j(""),m(!1)},S=e=>{""!==e&&s&&(!d||d(e))&&_(s(e))};return{setInputValue:h,inputValue:p,isDropdownOpen:v,setIsDropdownOpen:m,optionsNotSelected:b,handleInputChange:j,handleKeyDown:e=>{switch(e.key){case"Enter":f?_(f):S(p);break;case"Tab":case"Escape":e.preventDefault(),m(!1),y(null);break;case"ArrowUp":case"ArrowDown":var l;let r;e.preventDefault(),l=e.key,r=0,v&&("ArrowUp"===l&&(r=null===g||0===g?t.length-1:g-1),"ArrowDown"===l&&(r=null===g||g===b.length-1?0:g+1)),x(r),y(b.filter(e=>{let{optionProps:t}=e;return!(null==t?void 0:t.isDisabled)})[r])}},handleOnSelect:_,handleOnCreateNewOption:S,menuRef:i,searchInputRef:o,removeSelectionById:e=>{n(r.filter(t=>t.id!==e))},handleClearSearchInput:()=>{var e;j(""),null==o||null==(e=o.current)||e.focus()},handleClickSearchInput:()=>{m(!v)},handleClickToggle:()=>{var e;m(!v),null==(e=o.current)||e.focus()},activeItem:f,focusedItemIndex:g}})({options:i,searchString:s,selections:p,onChange:l,filterBeforeOnChange:r,menuRef:j,searchInputRef:_,onCreateNewOption:f,validateNewOption:x,onSearchChange:m}),N=e=>"select-typeahead-".concat(e.replace(" ","-")),L=(0,n.jsx)(eK,{id:t,placeholder:o,ariaLabel:d,onSearchChange:I,onClear:O,onKeyHandling:D,onClick:V,inputValue:S,inputRef:_,options:i,isDropdownOpen:w,activeItem:A});return(0,n.jsxs)(e_.k,{direction:{default:"column"},children:[(0,n.jsx)(eS.B,{children:(0,n.jsx)(ew.P,{isOpen:w&&(C.length>0||!!h||!!f&&S.length>0),selected:p,onOpenChange:T,toggle:e=>(0,n.jsx)(u.O_,{ref:e,variant:"typeahead",onClick:M,isExpanded:w,isDisabled:b,isFullWidth:!0,status:S&&x?x(S)?void 0:"danger":void 0,children:L}),variant:"typeahead",children:(0,n.jsx)(eT.E,{id:"select-create-typeahead-listbox",children:f&&0===C.length?(0,n.jsx)(eC.$,{id:N("new-option"),isFocused:!0,onClick:()=>E(S),children:'Create new option "'.concat(S,'"')}):h&&0===C.length?(0,n.jsx)(eC.$,{isAriaDisabled:!0,children:h}):C.map((e,t)=>(0,n.jsx)(eC.$,(0,g._)((0,y._)({id:N(e.id),isFocused:K===t,ref:null,onClick:()=>P(e)},e.optionProps),{children:ed(e.name)}),e.id))})})},"input"),v&&(0,n.jsx)(eS.B,{children:(0,n.jsx)(e_.k,{spaceItems:{default:"spaceItemsXs"},children:p.map(e=>(0,n.jsx)(eS.B,{children:(0,n.jsx)(eE,{content:e.tooltip,children:(0,n.jsx)(ek._,{color:c,onClose:()=>k(e.id),children:ed(e.labelName||e.name)})})},e.id))})},"chips")]})},eL=e=>{let{category:t,filterValue:l,setFilterValue:r,showToolbarItem:i,isDisabled:o=!1}=e,s=a.useRef(new Map),[d,c]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);a.useEffect(()=>{c(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let u=null==l?void 0:l.map(e=>{var t;let l=s.current.get(e),{chipLabel:r,label:n}=null!=l?l:{};return{key:e,node:null!=(t=null!=r?r:n)?t:e}});return(0,n.jsx)(ej.p,{id:"filter-control-".concat(t.categoryKey),labels:u,deleteLabel:(e,t)=>(e=>{let t="string"==typeof e?e:e.key;if(t){var n;let e=null!=(n=null==l?void 0:l.filter(e=>e!==t))?n:[];r(e.length>0?e:null)}})(t),deleteLabelGroup:()=>r([]),categoryName:t.title,showToolbarItem:i,children:(0,n.jsx)(eN,{isDisabled:o,options:d.map(e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}}),selections:null==l?void 0:l.map(e=>({id:e,name:e})),onChange:e=>{r(e.map(e=>ed(e.name)))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})})};var eR=l(6081),eY=l(9929),ez=l(1244);let eF=e=>ea()(e,"MM/DD/YYYY",!0).isValid(),eq=e=>ea()(e).format("MM/DD/YYYY"),eB=e=>ea()(e,"MM/DD/YYYY",!0).toDate(),eU=e=>{var t;return null!=(t=null==e?void 0:e.split("/").map(e=>ea()(e,"YYYY-MM-DD",!0)))?t:[]},eW=e=>{let[t,l]=e;return(null==t?void 0:t.isValid())&&(null==l?void 0:l.isValid())&&(null==t?void 0:t.isSameOrBefore(l))},eH=e=>{var t;let{category:l,filterValue:r,setFilterValue:i,showToolbarItem:o,isDisabled:s=!1}=e,d=null!=r?r:[],c=null!=(t=null==d?void 0:d.filter(e=>eW(eU(e))))?t:[],[u,p]=(0,a.useState)(),[h,v]=(0,a.useState)();return a.useEffect(()=>{if(null==r?void 0:r[0]){let[e,t]=eU(null==r?void 0:r[0]);p(e.toDate()),v(t.toDate())}else p(void 0),v(void 0)},[r]),(0,n.jsx)(ej.p,{labels:c.flatMap(e=>{let[,t]=(e=>{let[t,l]=eU(e);return eW([t,l])?["".concat(t.format("MM/DD"),"-").concat(l.format("MM/DD")),"".concat(t.format("MM/DD/YYYY"),"-").concat(l.format("MM/DD/YYYY"))]:[]})(e),[l,r]=t.split("-");return[{key:"".concat(e,"-from"),node:(0,n.jsx)(eP.u,{content:null!=l?l:e,children:(0,n.jsx)("span",{children:null!=l?l:""})})},{key:"".concat(e,"-to"),node:(0,n.jsx)(eP.u,{content:null!=r?r:e,children:(0,n.jsx)("span",{children:null!=r?r:""})})}]}),deleteLabel:(e,t)=>{i([])},deleteLabelGroup:()=>i([]),categoryName:l.title,showToolbarItem:o,children:(0,n.jsxs)(eR.B,{children:[(0,n.jsx)(eY.M,{value:u?eq(u):"",dateFormat:eq,dateParse:eB,onChange:(e,t)=>{eF(t)&&(p(eB(t)),v(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:s}),(0,n.jsx)(eY.M,{value:h?eq(h):"",onChange:(e,t)=>{if(eF(t)){let e=eB(t);v(e);let l=((e,t)=>{let[l,r]=[ea()(e),ea()(t)];if(eW([l,r]))return"".concat(l.format("YYYY-MM-DD"),"/").concat(r.format("YYYY-MM-DD"))})(u,e);l&&i([l])}},isDisabled:s||!(0,ez.q)(u),dateFormat:eq,dateParse:eB,invalidFormatText:"",rangeStart:u,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})]})},l.categoryKey)};var eJ=l(4780);let eZ="no-results",e$=e=>{var t,l,r;let{category:i,filterValue:o,setFilterValue:s,showToolbarItem:d,isDisabled:c=!1,isScrollable:p=!1}=e,[h,v]=a.useState(!1),[m,f]=a.useState(""),x=a.useRef(null),b="filter-control-".concat(i.categoryKey),j=e=>"".concat(b,"-").concat(e),_=i.title,S=null==(t=i.selectOptions)?void 0:t.filter(e=>{let{label:t,value:l,groupLabel:r}=e;return[null!=t?t:l,r].filter(Boolean).map(e=>e.toLocaleLowerCase()).some(e=>{var t;return e.includes(null!=(t=null==m?void 0:m.trim().toLowerCase())?t:"")})}),[w,...T]=[...new Set([...null!=(r=null==(l=i.selectOptions)?void 0:l.map(e=>{let{groupLabel:t}=e;return t}).filter(Boolean))?r:[],_])],C=e=>s(null==o?void 0:o.map(e=>{var t;return[e,null==(t=i.selectOptions)?void 0:t.find(t=>{let{value:l}=t;return e===l})]}).filter(e=>{let[,t]=e;return t}).map(e=>{let[t,{groupLabel:l=_}={}]=e;return[t,l]}).filter(t=>{let[,l]=t;return l!==e}).map(e=>{let[t]=e;return t})),k=e=>{let t="string"==typeof e?e:e.key;if(t){var l;let e=null!=(l=null==o?void 0:o.filter(e=>e!==t))?l:[];s(e.length>0?e:null)}},P=e=>null==o?void 0:o.map(t=>i.selectOptions.find(l=>{let{value:r,groupLabel:n=_}=l;return r===t&&n===e})).filter(Boolean).map(e=>{var t,l;let{chipLabel:r,label:n,value:a}=e,i=null!=(l=null!=(t=null!=r?r:n)?t:a)?l:"";return{key:a,node:i}}),E=e=>{e&&e!==eZ&&s((null==o?void 0:o.includes(e))?o.filter(t=>t!==e):[...null!=o?o:[],e])},{focusedItemIndex:I,getFocusedItem:D,clearFocusedItemIndex:O,moveFocusedItemIndex:V}=eG({filteredOptions:S}),M=e=>{switch(e.key){case"Enter":var t,l,r;h?(null==(t=D())?void 0:t.value)&&E(null==(r=D())?void 0:r.value):v(!0),null==x||null==(l=x.current)||l.focus();break;case"Tab":case"Escape":v(!1),O();break;case"ArrowUp":case"ArrowDown":e.preventDefault(),h?V(e.key):v(!0)}},A=(e,t)=>{f(t),h||v(!0)},K=e=>e===i.title?e:"".concat(i.title,"/").concat(e);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ej.p,{id:"".concat(b,"-").concat(w),labels:P(w),deleteLabel:(e,t)=>k(t),deleteLabelGroup:()=>C(w),categoryName:{name:w,key:K(w)},showToolbarItem:d,children:(0,n.jsx)(ew.P,{isScrollable:p,"aria-label":i.title,toggle:e=>(0,n.jsx)(u.O_,{ref:e,variant:"typeahead",onClick:()=>{v(!h)},isExpanded:h,isDisabled:c||!i.selectOptions.length,isFullWidth:!0,children:(0,n.jsxs)(eI.W,{isPlain:!0,children:[(0,n.jsx)(eD.v,{value:m,onClick:()=>{v(!h)},onChange:A,onKeyDown:M,id:j("typeahead-select-input"),autoComplete:"off",innerRef:x,placeholder:i.placeholderText,"aria-activedescendant":D()?j("option-".concat(I)):void 0,role:"combobox",isExpanded:h,"aria-controls":j("select-typeahead-listbox")}),(0,n.jsxs)(eO.t,{children:[!!m&&(0,n.jsx)(eV.zx,{variant:"plain",onClick:()=>{var e;f(""),null==x||null==(e=x.current)||e.focus()},"aria-label":"Clear input value",children:(0,n.jsx)(eA.q1,{"aria-hidden":!0})}),(null==o?void 0:o.length)?(0,n.jsx)(eJ.C,{isRead:!0,children:o.length}):null]})]})}),selected:o,onOpenChange:e=>v(e),onSelect:(e,t)=>E(t),isOpen:h,children:(0,n.jsxs)(eT.E,{id:j("select-typeahead-listbox"),children:[S.map((e,t)=>{let{groupLabel:l,label:r,value:i,optionProps:s={}}=e;return(0,a.createElement)(eC.$,(0,g._)((0,y._)({},s,!s.isDisabled&&{hasCheckbox:!0}),{key:i,id:j("option-".concat(t)),value:i,isFocused:I===t,isSelected:null==o?void 0:o.includes(i),children:[!!l&&(0,n.jsx)(ek._,{children:l})," ",null!=r?r:i]}))}),0===S.length&&(0,n.jsx)(eC.$,{isDisabled:!0,hasCheckbox:!1,value:eZ,isSelected:!1,children:'No results found for "'.concat(m,'"')},eZ)]})})},K(w)),T.map(e=>(0,n.jsx)(ej.p,{id:"".concat(b,"-").concat(e),labels:P(e),deleteLabel:(e,t)=>k(t),deleteLabelGroup:()=>C(e),categoryName:{name:e,key:K(e)},showToolbarItem:!1,children:" "},K(e)))]})},eG=e=>{let{filteredOptions:t}=e,[l,r]=a.useState(0);return{moveFocusedItemIndex:e=>{let n;return r((n=e,t.length?"ArrowUp"===n?l<=0?t.length-1:l-1:"ArrowDown"===n?l>=t.length-1?0:l+1:0:0))},focusedItemIndex:l,getFocusedItem:()=>{var e,r;return!t[l]||(null==(r=t[l])||null==(e=r.optionProps)?void 0:e.isDisabled)?void 0:t[l]},clearFocusedItemIndex:()=>r(0)}};var eQ=l(4091),eX=l(7948);let e0=e=>{let{category:t,filterValue:l,setFilterValue:r,showToolbarItem:i,isNumeric:o,isDisabled:s=!1}=e,[d,c]=a.useState((null==l?void 0:l[0])||"");a.useEffect(()=>{c((null==l?void 0:l[0])||"")},[l]);let u=()=>{let e=d.trim();r(e?[e.replace(/\s+/g," ")]:[])},p={name:"".concat(t.categoryKey,"-input"),onChange:(e,t)=>c(t),"aria-label":"".concat(t.title," filter"),value:d,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||u()},isDisabled:s};return(0,n.jsx)(ej.p,{labels:(null==l?void 0:l.map(e=>({key:e,node:e})))||[],deleteLabel:()=>r([]),categoryName:t.title,showToolbarItem:i,children:o?(0,n.jsxs)(eR.B,{children:[(0,n.jsx)(eQ.oi,(0,y._)({type:"number",id:"search-input"},p)),(0,n.jsx)(eV.zx,{icon:(0,n.jsx)(eM.ZP,{}),variant:eV.Wu.control,id:"search-button","aria-label":"search button for search input",onClick:u,isDisabled:s})]}):(0,n.jsx)(eX.M,(0,y._)({inputProps:{id:"search-input"}},p))})};var e1=l(5508);let e2=e=>{let{category:t,filterValue:l,setFilterValue:r,showToolbarItem:i,isDisabled:o=!1,isScrollable:s=!1}=e,[d,c]=a.useState(!1),p=e=>t.selectOptions.find(t=>{let{value:l}=t;return l===e}),h=null==l?void 0:l.map(e=>{var t;let l=p(e);if(!l)return null;let{chipLabel:r,label:n}=l;return{key:e,node:null!=(t=null!=r?r:n)?t:e}}).reduce((e,t)=>(t&&e.push(t),e),[]);return(0,n.jsx)(ej.p,{id:"filter-control-".concat(t.categoryKey),labels:h,deleteLabel:(e,t)=>(e=>{let t=null==l?void 0:l.filter(t=>t!==e);r((null==t?void 0:t.length)?t:null)})(t),categoryName:t.title,showToolbarItem:i,children:(0,n.jsx)(ew.P,{className:(0,e1.i)(s&&"isScrollable"),"aria-label":t.title,toggle:e=>{let r="Any";if(l&&l.length>0){var a;let e=l[0];r=(null==(a=p(e))?void 0:a.label)||e}return(0,n.jsx)(u.O_,{"aria-label":"Select",id:"select-filter-value-select",isFullWidth:!0,ref:e,onClick:()=>{c(!d)},isExpanded:d,isDisabled:o||0===t.selectOptions.length,children:r})},onOpenChange:e=>c(e),selected:l,onSelect:(e,t)=>{r(p(t)?[t]:null),c(!1),c(!1)},isOpen:d,shouldFocusToggleOnSelect:!0,children:(0,n.jsx)(eT.E,{children:t.selectOptions.map(e=>{let{label:t,value:r,optionProps:n}=e,i=null==l?void 0:l.includes(r);return(0,a.createElement)(eC.$,(0,g._)((0,y._)({},n),{key:r,value:r,isSelected:i}),null!=t?t:r)})})})})},e9=e=>{var{category:t}=e,l=(0,L._)(e,["category"]);return t.type===e4.select?(0,n.jsx)(e2,(0,y._)({isScrollable:!0,category:t},l)):t.type===e4.search||t.type===e4.numsearch?(0,n.jsx)(e0,(0,y._)({category:t,isNumeric:t.type===e4.numsearch},l)):t.type===e4.multiselect?(0,n.jsx)(e$,(0,y._)({isScrollable:!0,category:t},l)):t.type===e4.dateRange?(0,n.jsx)(eH,(0,y._)({category:t},l)):t.type===e4.autocompleteLabel?(0,n.jsx)(eL,(0,y._)({category:t},l)):null};var e4=((r={}).select="select",r.multiselect="multiselect",r.search="search",r.numsearch="numsearch",r.dateRange="dateRange",r.autocompleteLabel="autocompleteLabel",r);let e7=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"OR";return e&&e.logicOperator||t},e3=e=>{let{filterCategories:t,filterValues:l,setFilterValues:r,pagination:i,showFiltersSideBySide:o=!1,isDisabled:s=!1}=e,[d,v]=a.useState(!1),[m,f]=a.useState(t[0].categoryKey),x=e=>{f(e.categoryKey),v(!1)},b=t.find(e=>e.categoryKey===m),j=t.reduce((e,t)=>(t.filterGroup&&!e.includes(t.filterGroup)&&e.push(t.filterGroup),e),[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eg.R,{variant:"filter-group",toggleIcon:(0,n.jsx)(eb.ZP,{}),breakpoint:"2xl",gap:o?{default:"gapMd"}:void 0,children:[!o&&(0,n.jsx)(ex.E,{children:(0,n.jsx)(c.L,{toggle:e=>(0,n.jsxs)(u.O_,{id:"filtered-by",ref:e,onClick:()=>v(!d),isDisabled:s,children:[(0,n.jsx)(eb.ZP,{})," ",null==b?void 0:b.title]}),isOpen:d,children:j.length?j.map(e=>(0,n.jsx)(ey.p,{label:e,children:(0,n.jsx)(p.s,{children:t.filter(t=>t.filterGroup===e).map(e=>(0,n.jsx)(h.h,{id:"filter-category-".concat(e.categoryKey),onClick:()=>x(e),children:e.title},e.categoryKey))})},e)):t.map(e=>(0,n.jsx)(h.h,{id:"filter-category-".concat(e.categoryKey),onClick:()=>x(e),children:e.title},e.categoryKey))})}),t.map(e=>(0,n.jsx)(e9,{category:e,filterValue:l[e.categoryKey],setFilterValue:t=>r((0,g._)((0,y._)({},l),{[e.categoryKey]:t})),showToolbarItem:o||(null==b?void 0:b.categoryKey)===e.categoryKey,isDisabled:s},e.categoryKey))]}),i?(0,n.jsx)(ex.E,{variant:"pagination",children:i}):null]})},e6=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isActiveItemEnabled:t,persistTo:l,persistenceKeyPrefix:r}=e,[n,a]=eu((0,y._)({isEnabled:!!t,defaultValue:null,persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["activeItem"],serialize:e=>({activeItem:null!==e?String(e):null}),deserialize:e=>{let{activeItem:t}=e;if(null==t)return null;let l=Number(t);return Number.isNaN(l)?t:l}}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"activeItem"}:ev(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{activeItemId:n,setActiveItemId:a}},e8=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isExpansionEnabled:t,persistTo:l="state",persistenceKeyPrefix:r}=e,[n,a]=eu((0,y._)({isEnabled:!!t,defaultValue:{},persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["expandedCells"],serialize:e=>e&&0!==es(e).length?{expandedCells:JSON.stringify(e)}:{expandedCells:null},deserialize:e=>{let{expandedCells:t}=e;try{return JSON.parse(t||"{}")}catch(e){return{}}}}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"expandedCells"}:ev(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{expandedCells:n,setExpandedCells:a}},e5=e=>{let{feature:t,persistTo:l}=e;return{persistTo:l&&"string"!=typeof l?l[t]:l}};var te=l(2997);let tt={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},tl={vulnerabilityStatus:{affected:(0,y._)({},tt),fixed:(0,y._)({},tt),not_affected:(0,y._)({},tt),known_not_affected:(0,y._)({},tt),under_investigation:(0,y._)({},tt)}};var tr=l(1195);let tn=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,l=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return new Promise((r,n)=>{setTimeout(()=>{l?r(e):n(Error("Error"))},t)})};var ta=l(715),ti=l(982),to=l(6985),ts=l(1211),td=l(5882),tc=l(4835),tu=l(4350),tp=l(1165),th=l(5733),tv=l(1423),tm=l(3797),tf=l(9905),ty=l(7447);let tg=e=>{let{value:t}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(t).map(e=>{let[t,l]=e;return(0,n.jsx)(ek._,{isCompact:!0,children:"".concat(t,"=").concat(l)},"".concat(t,"=").concat(l))})})};var tx=l(4766);let tb=e=>{let{value:t,score:l,showScore:r,showLabel:a}=e,i=D[t],o=i.name,s=i.icon;return(0,n.jsxs)(e_.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(eS.B,{children:a?(0,n.jsx)(tx.J,{children:(0,n.jsx)(s,{color:i.color.value})}):(0,n.jsx)(eP.u,{content:o,children:(0,n.jsx)(tx.J,{children:(0,n.jsx)(s,{color:i.color.value})})})}),a&&(0,n.jsx)(eS.B,{children:o}),r&&null!==l&&(0,n.jsxs)(eS.B,{children:["(",Math.round(10*l)/10,")"]})]})};var tj=l(7230);let t_=e=>{let{paginationProps:t,isTop:l,isCompact:r=!1,idPrefix:a=""}=e;return(0,n.jsx)(tj.t,(0,g._)((0,y._)({id:"".concat(a?"".concat(a,"-"):"","pagination-").concat(l?"top":"bottom"),variant:l?tj.a.top:tj.a.bottom,isCompact:r},t),{widgetId:"pagination-id"}))};var tS=l(8305),tw=l(3754),tT=l(707),tC=l(6668),tk=l(2160);let tP=()=>(0,n.jsx)(tT.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:tk.ZP,variant:tT.IQ.sm,children:(0,n.jsx)(tC.B,{children:"There was an error retrieving data. Check your connection and try again."})});var tE=l(2119);let tI=e=>{let{title:t,description:l}=e;return(0,n.jsx)(tT.ub,{titleText:t,headingLevel:"h4",icon:tE.ZP,variant:tT.IQ.sm,children:l&&(0,n.jsx)(tC.B,{children:l})})},tD=()=>(0,n.jsx)(tI,{title:"No data available",description:"No data available to be shown here."}),tO=e=>{let{numRenderedColumns:t,isLoading:l=!1,isError:r=!1,isNoData:a=!1,errorEmptyState:i=null,noDataEmptyState:o=null,children:s}=e;return(0,n.jsx)(n.Fragment,{children:l?(0,n.jsx)(tv.p,{"aria-label":"Table loading",children:(0,n.jsx)(tp.Tr,{children:(0,n.jsx)(tm.Td,{colSpan:t,children:(0,n.jsx)(tS.b,{children:(0,n.jsx)(tw.$,{size:"xl"})})})})}):r?(0,n.jsx)(tv.p,{"aria-label":"Table error",children:(0,n.jsx)(tp.Tr,{children:(0,n.jsx)(tm.Td,{colSpan:t,children:(0,n.jsx)(tS.b,{children:i||(0,n.jsx)(tP,{})})})})}):a?(0,n.jsx)(tv.p,{"aria-label":"Table empty",children:(0,n.jsx)(tp.Tr,{children:(0,n.jsx)(tm.Td,{colSpan:t,children:(0,n.jsx)(tS.b,{children:o||(0,n.jsx)(tD,{})})})})}):s})},tV=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:l,children:r}=e;return(0,n.jsxs)(n.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,n.jsx)(th.Th,{screenReaderText:"before-data-".concat(t)},t)),r,Array(l).fill(null).map((e,t)=>(0,n.jsx)(th.Th,{screenReaderText:"after-data-".concat(t)},t))]})},tM=e=>{let{isExpansionEnabled:t=!1,expandableVariant:l,getSelectCheckboxTdProps:r,propHelpers:{getSingleExpandButtonTdProps:a},item:i,rowIndex:o,children:s}=e;return(0,n.jsxs)(n.Fragment,{children:[t&&"single"===l?(0,n.jsx)(tm.Td,(0,y._)({},a({item:i,rowIndex:o}))):null,r?(0,n.jsx)(tm.Td,(0,y._)({},r({item:i,rowIndex:o}))):null,s]})},tA=e=>{let{children:t}=e,[l,r]=a.useState(!1);return(0,n.jsx)(n.Fragment,{children:t(l,r)})},tK=e=>{let{vulnerability:t}=e;return(0,n.jsxs)("p",{children:[t.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})},tN=e=>{let{value:t}=e,l=O[t];return(0,n.jsx)(ek._,{color:l.color,children:l.name})},tL=e=>{var t;let{vulnerabilities:l,isFetching:r,fetchError:i}=e,o=(t=e=>"".concat(e.vulnerability.identifier,"-").concat(e.status),(0,a.useMemo)(()=>l&&0!==l.length?l.map(e=>(0,g._)((0,y._)({},e),{_ui_unique_id:t(e)})):[],[l,t])),s=(e=>{let t=(e=>{let t=(e=>{var t,l;let{isFilterEnabled:r,persistTo:n="state",persistenceKeyPrefix:i}=e,[o,s]=(0,a.useState)(!0),d={};o&&(d=r&&null!=(t=null==e?void 0:e.initialFilterValues)?t:{}),(0,a.useEffect)(()=>{o&&s(!1)},[o]);let[c,u]=eu((0,y._)({isEnabled:!!r,persistenceKeyPrefix:i},"urlParams"===n?{persistTo:n,keys:["filters"],defaultValue:d,serialize:em,deserialize:ef}:"localStorage"===n||"sessionStorage"===n?{persistTo:n,key:"filters",defaultValue:d}:ev(n)?{persistTo:"provider",serialize:n.write,deserialize:()=>n.read(),defaultValue:r&&null!=(l=null==e?void 0:e.initialFilterValues)?l:{}}:{persistTo:"state",defaultValue:d}));return{filterValues:c,setFilterValues:u}})((0,y._)({},e,e5({feature:"filter",persistTo:e.persistTo}))),l=(e=>{let{isSortEnabled:t,persistTo:l="state",persistenceKeyPrefix:r}=e,n=t&&e.sortableColumns||[],a=t&&e.initialSort||null,i=n[0]?{columnKey:n[0],direction:"asc"}:null,[o,s]=eu((0,y._)({isEnabled:!!t,defaultValue:null!=a?a:i,persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["sortColumn","sortDirection"],serialize:e=>({sortColumn:(null==e?void 0:e.columnKey)||null,sortDirection:(null==e?void 0:e.direction)||null}),deserialize:e=>e.sortColumn&&e.sortDirection?{columnKey:e.sortColumn,direction:e.sortDirection}:null}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"sort"}:ev(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"}));return{activeSort:o,setActiveSort:s}})((0,y._)({},e,e5({feature:"sort",persistTo:e.persistTo}))),r=(e=>{let{isPaginationEnabled:t,persistTo:l="state",persistenceKeyPrefix:r}=e,n=t&&e.initialItemsPerPage||10,a={pageNumber:1,itemsPerPage:n},[i,o]=eu((0,y._)({isEnabled:!!t,defaultValue:a,persistenceKeyPrefix:r},"urlParams"===l?{persistTo:l,keys:["pageNumber","itemsPerPage"],serialize:e=>{let{pageNumber:t,itemsPerPage:l}=e||{};return{pageNumber:t?String(t):void 0,itemsPerPage:l?String(l):void 0}},deserialize:e=>{let{pageNumber:t,itemsPerPage:l}=e||{};return t&&l?{pageNumber:Number.parseInt(t,10),itemsPerPage:Number.parseInt(l,10)}:a}}:"localStorage"===l||"sessionStorage"===l?{persistTo:l,key:"pagination"}:ev(l)?{persistTo:"provider",serialize:l.write,deserialize:()=>l.read()}:{persistTo:"state"})),{pageNumber:s,itemsPerPage:d}=i||a;return{pageNumber:s,setPageNumber:e=>o({pageNumber:e>=1?e:1,itemsPerPage:(null==i?void 0:i.itemsPerPage)||n}),itemsPerPage:d,setItemsPerPage:e=>o({pageNumber:(null==i?void 0:i.pageNumber)||1,itemsPerPage:e})}})((0,y._)({},e,e5({persistTo:e.persistTo,feature:"pagination"}))),n=e8((0,y._)({},e,e5({persistTo:e.persistTo,feature:"expansion"}))),i=e6((0,y._)({},e,e5({persistTo:e.persistTo,feature:"activeItem"}))),{columnNames:o,tableName:s,initialColumns:d}=e,c=(e=>{let{initialColumns:t,supportedColumns:l,columnsKey:r}=e,n=Object.entries(l).map(e=>{var l,r,n;let[a,i]=e;return{id:a,label:i,isVisible:null==(n=null==t||null==(l=t[a])?void 0:l.isVisible)||n,isIdentity:null==t||null==(r=t[a])?void 0:r.isIdentity}}),[i,o]=er({key:r,defaultValue:n});return(0,a.useEffect)(()=>{let e=i.filter(e=>{let{id:t}=e;return n.find(e=>t===e.id)});e.length!==n.length&&o(n.map(t=>{var l,r;return(0,g._)((0,y._)({},t),{isVisible:null!=(r=null==(l=e.find(e=>{let{id:l}=e;return l===t.id}))?void 0:l.isVisible)?r:t.isVisible})}))},[n,i,o]),{columns:i,setColumns:o,defaultColumns:n}})({columnsKey:s,initialColumns:d,supportedColumns:o});return(0,g._)((0,y._)({},e),{filterState:t,sortState:l,paginationState:r,expansionState:n,activeItemState:i,columnState:c})})(e),l=(e=>{let{items:t,isPaginationEnabled:l=!0}=e,{filteredItems:r}=(0,a.useMemo)(()=>(e=>{let{items:t,filterCategories:l=[],filterState:{filterValues:r}}=e;return{filteredItems:t.filter(e=>Object.entries(r).every(t=>{var r;let[n,a]=t;if(!a||0===a.length)return!0;let i=l.find(e=>e.categoryKey===n),o=null!=(r=null==i?void 0:i.matcher)?r:(e,t)=>{var l,r,a=e,o=null!=(r=null==i||null==(l=i.getItemValue)?void 0:l.call(i,t))?r:t[n];if(!o)return!1;let s=String(o).toLowerCase(),d=String(a).toLowerCase();return -1!==s.indexOf(d)};return a["AND"===e7(i)?"every":"some"](t=>o(t,e))}))}})({items:t,filterCategories:e.filterCategories,filterState:e.filterState}),[t,e.filterCategories,e.filterState]),{sortedItems:n}=(0,a.useMemo)(()=>(e=>{let{items:t,getSortValues:l,sortState:{activeSort:r}}=e;if(!l||!r)return{sortedItems:t};return{sortedItems:[...t].sort((e,t)=>{let n=((e,t,l)=>{let r,n;return"number"==typeof e&&"number"==typeof t?e-t:(r=String(null!=e?e:""),n=String(null!=t?t:""),r.localeCompare(n,null!=l?l:"en",{numeric:!0}))})(l(e)[r.columnKey],l(t)[r.columnKey],"en");return"asc"===r.direction?n:-n})}})({items:r,getSortValues:e.getSortValues,sortState:e.sortState}),[r,e.getSortValues,e.sortState]),{currentPageItems:i}=(0,a.useMemo)(()=>(e=>{let{items:t,paginationState:{pageNumber:l,itemsPerPage:r}}=e,n=(l-1)*r;return{currentPageItems:t.slice(n,n+r)}})({items:n,paginationState:e.paginationState}),[n,e.paginationState]);return{filteredItems:r,totalItemCount:r.length,currentPageItems:l?i:n}})((0,y._)({},e,t)),{columnState:r}=t;return(e=>{let{forceNumRenderedColumns:t,columnNames:l,idProperty:r,dataNameProperty:n,tableName:i,hasActionsColumn:o=!1,variant:s,isFilterEnabled:d,isSortEnabled:c,isSelectionEnabled:u,isExpansionEnabled:p,isActiveItemEnabled:h,columnState:{columns:v}}=e,m=es(l),f=0,x=0;u&&f++,p&&"single"===e.expandableVariant&&f++,o&&x++;let b=t||m.length+f+x,{filterPropsForToolbar:j,propsForFilterToolbar:_}=(e=>{let{filterState:{filterValues:t,setFilterValues:l},filterCategories:r=[]}=e;return{filterPropsForToolbar:{collapseListedFiltersBreakpoint:"xl",clearAllFilters:()=>l({}),clearFiltersButtonText:"Clear all filters"},propsForFilterToolbar:{filterCategories:r,filterValues:t,setFilterValues:l}}})(e),{getSortThProps:S}=(e=>{let{sortState:{activeSort:t,setActiveSort:l},sortableColumns:r=[],columnKeys:n}=e;return{getSortThProps:e=>{let{columnKey:a}=e;return r.includes(a)?{sort:{columnIndex:n.indexOf(a),sortBy:{index:t?n.indexOf(t.columnKey):void 0,direction:null==t?void 0:t.direction},onSort:(e,t,r)=>{l({columnKey:n[t],direction:r})}}}:{}}}})((0,g._)((0,y._)({},e),{columnKeys:m})),{paginationProps:w,paginationToolbarItemProps:T}=(e=>{let{totalItemCount:t,paginationState:{itemsPerPage:l,pageNumber:r,setPageNumber:n,setItemsPerPage:i}}=e;return(e=>{let{isPaginationEnabled:t,paginationState:{itemsPerPage:l,pageNumber:r,setPageNumber:n},totalItemCount:i,isLoading:o=!1}=e,s=Math.max(Math.ceil(i/l),1);a.useEffect(()=>{t&&r>s&&!o&&n(s)})})(e),{paginationProps:{itemCount:t,perPage:l,page:r,onSetPage:(e,t)=>n(t),onPerPageSelect:(e,t)=>{n(1),i(t)}},paginationToolbarItemProps:{variant:"pagination",align:{default:"alignEnd"}}}})(e),{expansionDerivedState:C,getSingleExpandButtonTdProps:k,getCompoundExpandTdProps:P,getExpandedContentTdProps:E}=(e=>{let{columnNames:t,idProperty:l,columnKeys:r,numRenderedColumns:n,expansionState:{expandedCells:a}}=e,i=(e=>{let{idProperty:t,expansionState:{expandedCells:l,setExpandedCells:r}}=e;return{isCellExpanded:(e,r)=>r?l[String(e[t])]===r:!!l[String(e[t])],setCellExpanded:e=>{let{item:n,isExpanding:a=!0,columnKey:i}=e,o=(0,y._)({},l);a?o[String(n[t])]=i||!0:delete o[String(n[t])],r(o)}}})(e),{isCellExpanded:o,setCellExpanded:s}=i;return{expansionDerivedState:i,getSingleExpandButtonTdProps:e=>{let{item:t,rowIndex:r}=e;return{expand:{rowIndex:r,isExpanded:o(t),onToggle:()=>s({item:t,isExpanding:!o(t)}),expandId:"expandable-row-".concat(t[l])}}},getCompoundExpandTdProps:e=>{let{columnKey:t,item:n,rowIndex:a}=e;return{compoundExpand:{isExpanded:o(n,t),onToggle:()=>s({item:n,isExpanding:!o(n,t),columnKey:t}),expandId:"compound-expand-".concat(n[l],"-").concat(t),rowIndex:a,columnIndex:r.indexOf(t)}}},getExpandedContentTdProps:e=>{let{item:r}=e,i=a[String(r[l])];return{dataLabel:"string"==typeof i?t[i]:void 0,noPadding:!0,colSpan:n,width:100}}}})((0,g._)((0,y._)({},e),{columnKeys:m,numRenderedColumns:b})),{activeItemDerivedState:I,getActiveItemTrProps:D}=(e=>{let t=(e=>{let{currentPageItems:t,idProperty:l,activeItemState:{activeItemId:r,setActiveItemId:n}}=e;return{activeItem:t.find(e=>e[l]===r)||null,setActiveItem:e=>{var t;n(null!=(t=null==e?void 0:e[l])?t:null)},clearActiveItem:()=>n(null),isActiveItem:e=>e[l]===r}})(e),{isActiveItem:l,setActiveItem:r,clearActiveItem:n}=t;return(e=>{let{isLoading:t,activeItemState:{activeItemId:l},activeItemDerivedState:{activeItem:r,clearActiveItem:n}}=e;a.useEffect(()=>{t||!l||r||n()},[t,l,r])})((0,g._)((0,y._)({},e),{activeItemDerivedState:t})),{activeItemDerivedState:t,getActiveItemTrProps:e=>{let{item:t}=e;return{isSelectable:!0,isClickable:!0,isRowSelected:t&&l(t),onRowClick:()=>{l(t)?n():r(t)}}}}})(e),O=(0,y._)({className:"compact"===s?te.Z.pt_0:""},d&&j),V={variant:s,isExpandable:p&&!!e.expandableVariant};return(0,g._)((0,y._)({},e),{numColumnsBeforeData:f,numColumnsAfterData:x,numRenderedColumns:b,expansionDerivedState:C,activeItemDerivedState:I,propHelpers:{toolbarProps:O,tableProps:V,getThProps:e=>{let{columnKey:t}=e;return(0,g._)((0,y._)({},c&&S({columnKey:t})),{children:l[t]})},getTrProps:e=>{let{item:t,onRowClick:l}=e,a=D({item:t});return(0,g._)((0,y._)({id:"".concat(i,"-row-item-").concat(t[r]),"data-item-id":t[r],"data-item-name":n&&t[n]},h&&a),{onRowClick:e=>((e,t)=>{let l=e=>{var t;return!!["input","button","a"].includes(e.tagName.toLowerCase())||!!e.parentElement&&(null==(t=e.parentElement)?void 0:t.tagName.toLowerCase())!=="tr"&&l(e.parentElement)};(null==e?void 0:e.target)instanceof Element&&!l(e.target)&&t(e)})(e,()=>{var t;null==(t=a.onRowClick)||t.call(a,e),null==l||l(e)})})},getTdProps:t=>{let{columnKey:r}=t;return(0,y._)({dataLabel:l[r]},p&&"compound"===e.expandableVariant&&t.isCompoundExpandToggle&&P({columnKey:r,item:t.item,rowIndex:t.rowIndex}))},filterToolbarProps:_,filterPanelProps:_,paginationProps:w,paginationToolbarItemProps:T,toolbarBulkExpanderProps:{},getSingleExpandButtonTdProps:k,getExpandedContentTdProps:E,getColumnVisibility:e=>{var t,l;return null==(l=null==(t=v.find(t=>t.id===e))?void 0:t.isVisible)||l}}})})((0,g._)((0,y._)({},e,t,l,r),{idProperty:e.idProperty}))})({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:o,isLoading:r,columnNames:{vulnerabilityId:"Vulnerability ID",description:"Description",severity:"Severity",status:"Status",affectedPackages:"Affected packages",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["vulnerabilityId","affectedPackages","published","updated"],getSortValues:e=>{var t,l;return{vulnerabilityId:e.vulnerability.identifier,affectedPackages:e.purls.size,published:(null==(t=e.vulnerability)?void 0:t.published)?ea()(e.vulnerability.published).valueOf():0,updated:(null==(l=e.vulnerability)?void 0:l.modified)?ea()(e.vulnerability.modified).valueOf():0}},isFilterEnabled:!0,filterCategories:[{categoryKey:"vulnerabilityId",title:"Vulnerability ID",type:e4.search,placeholderText:"Search by Vulnerability ID",getItemValue:e=>e.vulnerability.identifier},{categoryKey:"severity",title:"Severity",type:e4.multiselect,placeholderText:"Severity",selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],matcher:(e,t)=>e===t.opinionatedAvisory.extendedSeverity},{categoryKey:"status",title:"Status",type:e4.multiselect,placeholderText:"Status",selectOptions:[{value:"affected",label:"Affected"},{value:"under_investigation",label:"Under investigation"},{value:"known_not_affected",label:"Known not affected"},{value:"not_affected",label:"Not affected"},{value:"fixed",label:"Fixed"}],matcher:(e,t)=>e===t.status}],isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:d,numRenderedColumns:c,propHelpers:{toolbarProps:u,paginationToolbarItemProps:p,paginationProps:h,tableProps:v,filterToolbarProps:m,getThProps:f,getTrProps:x,getTdProps:b,getExpandedContentTdProps:j},expansionDerivedState:{isCellExpanded:_}}=s;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ta.o,(0,g._)((0,y._)({},u),{children:(0,n.jsxs)(ti.c,{children:[(0,n.jsx)(e3,(0,y._)({},m)),(0,n.jsx)(ex.E,(0,g._)((0,y._)({},p),{children:(0,n.jsx)(t_,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})}))]})})),(0,n.jsxs)(tc.i,(0,g._)((0,y._)({},v),{"aria-label":"Vulnerability table",children:[(0,n.jsx)(tu.h,{children:(0,n.jsx)(tp.Tr,{children:(0,n.jsxs)(tV,(0,g._)((0,y._)({},s),{children:[(0,n.jsx)(th.Th,(0,y._)({},f({columnKey:"vulnerabilityId"}))),(0,n.jsx)(th.Th,(0,y._)({},f({columnKey:"description"}))),(0,n.jsx)(th.Th,(0,y._)({},f({columnKey:"severity"}))),(0,n.jsx)(th.Th,(0,y._)({},f({columnKey:"status"}))),(0,n.jsx)(th.Th,(0,y._)({},f({columnKey:"affectedPackages"}))),(0,n.jsx)(th.Th,(0,y._)({},f({columnKey:"published"}))),(0,n.jsx)(th.Th,(0,y._)({},f({columnKey:"updated"})))]}))})}),(0,n.jsx)(tO,{isLoading:r,isError:!!i,isNoData:0===o.length,numRenderedColumns:c,children:null==d?void 0:d.map((e,t)=>{var l,r;return(0,n.jsxs)(tv.p,{isExpanded:_(e),children:[(0,n.jsx)(tp.Tr,(0,g._)((0,y._)({},x({item:e})),{children:(0,n.jsxs)(tM,(0,g._)((0,y._)({},s),{item:e,rowIndex:t,children:[(0,n.jsx)(tm.Td,(0,g._)((0,y._)({width:15,modifier:"breakWord"},b({columnKey:"vulnerabilityId"})),{children:e.vulnerability.identifier})),(0,n.jsx)(tA,{children:(t,l)=>(0,n.jsx)(tm.Td,(0,g._)((0,y._)({width:25,modifier:"truncate",onFocus:()=>l(!0),onBlur:()=>l(!1),tabIndex:0},b({columnKey:"description"})),{children:(0,n.jsx)(tf.cE,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,n.jsx)(tK,{vulnerability:e.vulnerability})})}))}),(0,n.jsx)(tm.Td,(0,g._)((0,y._)({width:20,modifier:"breakWord"},b({columnKey:"severity"})),{children:(0,n.jsx)(to.e,{isVertical:!0,children:Array.from(e.advisories.entries()).map(e=>{var t,l;let[r,a]=e;return(0,n.jsx)(e_.k,{children:(0,n.jsx)(eS.B,{spacer:{default:"spacerNone"},children:(0,n.jsx)(tb,{value:a.opinionatedExtendedSeverity,score:null!=(l=null==(t=a.opinionatedScore)?void 0:t.value)?l:null,showLabel:!0,showScore:!0})})},r)})})})),(0,n.jsx)(tm.Td,(0,g._)((0,y._)({width:10,modifier:"truncate"},b({columnKey:"status"})),{children:(0,n.jsx)(tN,{value:e.status})})),(0,n.jsx)(tm.Td,(0,g._)((0,y._)({width:10,modifier:"truncate"},b({columnKey:"affectedPackages",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:e.purls.size})),(0,n.jsx)(tm.Td,(0,g._)((0,y._)({width:10,modifier:"truncate"},b({columnKey:"published"})),{children:eo(null==(l=e.vulnerability)?void 0:l.published)})),(0,n.jsx)(tm.Td,(0,g._)((0,y._)({width:10,modifier:"truncate"},b({columnKey:"updated"})),{children:eo(null==(r=e.vulnerability)?void 0:r.modified)}))]}))})),_(e)?(0,n.jsx)(tp.Tr,{isExpanded:!0,children:(0,n.jsx)(tm.Td,(0,g._)((0,y._)({},j({item:e})),{children:(0,n.jsxs)(ty.G,{children:[_(e,"severity")?(0,n.jsx)(ts.aV,{isPlain:!0,children:Array.from(e.advisories.values()).map(e=>(0,n.jsx)(td.H,{children:e.advisory.identifier},"".concat(e.advisory.identifier)))}):null,_(e,"affectedPackages")?(0,n.jsxs)(tc.i,{variant:"compact",children:[(0,n.jsx)(tu.h,{children:(0,n.jsxs)(tp.Tr,{children:[(0,n.jsx)(th.Th,{children:"Type"}),(0,n.jsx)(th.Th,{children:"Namespace"}),(0,n.jsx)(th.Th,{children:"Name"}),(0,n.jsx)(th.Th,{children:"Version"}),(0,n.jsx)(th.Th,{children:"Path"}),(0,n.jsx)(th.Th,{children:"Qualifiers"})]})}),(0,n.jsx)(tv.p,{children:Array.from(e.purls.values()).map(e=>{let t=(e=>{try{var t,l,r,n;let a=ei.PackageURL.fromString(e);return{type:a.type,name:a.name,namespace:null!=(t=a.namespace)?t:void 0,version:null!=(l=a.version)?l:void 0,qualifiers:null!=(r=a.qualifiers)?r:void 0,path:null!=(n=a.subpath)?n:void 0}}catch(e){console.error(e);return}})(e);return t?(0,n.jsxs)(tp.Tr,{children:[(0,n.jsx)(tm.Td,{children:null==t?void 0:t.type}),(0,n.jsx)(tm.Td,{children:null==t?void 0:t.namespace}),(0,n.jsx)(tm.Td,{children:null==t?void 0:t.name}),(0,n.jsx)(tm.Td,{children:null==t?void 0:t.version}),(0,n.jsx)(tm.Td,{children:null==t?void 0:t.path}),(0,n.jsx)(tm.Td,{children:(null==t?void 0:t.qualifiers)&&(0,n.jsx)(tg,{value:null==t?void 0:t.qualifiers})})]},e):(0,n.jsx)(tp.Tr,{children:(0,n.jsx)(tm.Td,{colSpan:6,children:e})},e)})})]}):null]})}))}):null]},e._ui_unique_id)})})]})),(0,n.jsx)(t_,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:h})]})},tR=()=>{let[e,t]=a.useState(!1),l=()=>{t(!e)},{data:{vulnerabilities:r},isFetching:v,fetchError:m}=(e=>{let{analysisResponse:t,isFetching:l,fetchError:r}=(e=>{var t;let l=f?{ids:e.reduce((e,t,l)=>(l%100==0?e.push([t]):e[e.length-1].push(t),e),[]),dataResolver:async e=>{var t,l;return(await (null!=(l=(t={client:X,body:{purls:e}}).client)?l:ee).post((0,g._)((0,y._)({responseType:"json",url:"/api/v2/vulnerability/analyze"},t),{headers:(0,y._)({"Content-Type":"application/json"},t.headers)}))).data}}:{ids:[e],dataResolver:e=>{var t;return tn(null!=(t=window.analysis_response)?t:{})}},r=(0,tr.h)({queries:l.ids.map(e=>({queryKey:["vulnerabilities",e],queryFn:()=>l.dataResolver(e),retry:!1}))}),n=r.some(e=>{let{isLoading:t}=e;return t}),a=r.find(e=>{let{error:t}=e;return!!t}),i={};if(!n)for(let e of r.map(e=>{var t;return null!=(t=null==e?void 0:e.data)?t:{}}))for(let[t,l]of Object.entries(e))i[t]=l;return{analysisResponse:i,isFetching:n,fetchError:null!=(t=null==a?void 0:a.error)?t:void 0}})(e);return{data:a.useMemo(()=>{if(l||r||0===Object.keys(t).length)return{summary:(0,y._)({},tl),vulnerabilities:[]};let e=Object.entries(t).flatMap(e=>{let[t,l]=e;return l.details.flatMap(e=>Object.entries(e.status).flatMap(l=>{let[r,n]=l;return n.map(l=>({purl:t,vulnerability:e,status:r,advisory:l,scores:l.scores}))}))}).reduce((e,t)=>{let l,r=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.status===t.status,n=e.find(e=>r(e,t));if(n){var a,i,o,s;let d=e.filter(e=>!r(e,n)),c=A(t.scores),u=K(null==c?void 0:c.severity),p=new Map(n.advisories);p.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedScore:c,opinionatedExtendedSeverity:u});let h=new Set(n.purls);h.add(t.purl);let v=null,m=null;if((null==(a=n.opinionatedAvisory.score)?void 0:a.type)!==(null==c?void 0:c.type)){let e=[{advisory:n.opinionatedAvisory.advisory,score:n.opinionatedAvisory.score},{advisory:t.advisory,score:c}].sort(M(e=>{var t,l;return null!=(l=null==(t=e.score)?void 0:t.type)?l:null}))[0];v=e.advisory,m=e.score}else{let{advisory:e,score:l}=(null!=(o=null==c?void 0:c.value)?o:0)>(null!=(s=null==(i=n.opinionatedAvisory.score)?void 0:i.value)?s:0)?{score:c,advisory:t.advisory}:{score:n.opinionatedAvisory.score,advisory:n.opinionatedAvisory.advisory};v=e,m=l}let f=K(null==m?void 0:m.severity);l=[...d,{vulnerability:n.vulnerability,status:n.status,advisories:p,purls:h,opinionatedAvisory:{advisory:v,score:m,extendedSeverity:f}}]}else{let r=A(t.scores),n=K(null==r?void 0:r.severity),a=new Map;a.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedExtendedSeverity:n,opinionatedScore:r});let i=new Set;i.add(t.purl);let o={vulnerability:t.vulnerability,status:t.status,advisories:a,purls:i,opinionatedAvisory:{advisory:t.advisory,score:r,extendedSeverity:n}};l=[...e.slice(),o]}return l},[]),n=e.reduce((e,t)=>{let l=t.status,r=t.opinionatedAvisory.extendedSeverity,n=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,g._)((0,y._)({},e.vulnerabilityStatus),{[l]:{total:n.total+1,severities:(0,g._)((0,y._)({},n.severities),{[r]:n.severities[r]+1})}})})},(0,y._)({},tl));return{vulnerabilities:e,summary:n}},[t,l,r]),analysisResponse:t,isFetching:l,fetchError:r}})(window.purls);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.NP,{children:(0,n.jsxs)(o.P,{children:[(0,n.jsx)(s.J,{isFilled:!0,children:(0,n.jsxs)(d.V,{children:[(0,n.jsx)(d.V,{component:"h1",children:"Vulnerabilities"}),(0,n.jsx)(d.V,{component:"p",children:"This is a temporary vulnerability report."})]})}),(0,n.jsx)(s.J,{children:(0,n.jsx)(c.L,{isOpen:e,onSelect:()=>t(!1),onOpenChange:e=>t(e),popperProps:{position:"right"},toggle:t=>(0,n.jsx)(u.O_,{ref:t,onClick:l,isExpanded:e,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,n.jsx)(p.s,{children:(0,n.jsx)(h.h,{children:"Download CSV"},"csv")})})})]})}),(0,n.jsx)(i.NP,{children:(0,n.jsx)(tL,{vulnerabilities:r,isFetching:v,fetchError:m})})]})}}}]);