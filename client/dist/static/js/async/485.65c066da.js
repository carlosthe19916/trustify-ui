"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["485"],{68924:function(e,s,a){a.d(s,{M:()=>g});var l=a(59390),r=a(24246),t=a(27378),i=a(87678),n=a(15508),o=a(75481),d=a(5445),c=a(1353),p=a(30528),u=a(19879);let g=e=>{var{children:s,className:a,statusToggleText:g,statusToggleIcon:h,"aria-label":m}=e,f=(0,l.__rest)(e,["children","className","statusToggleText","statusToggleIcon","aria-label"]);let[v,x]=(0,t.useState)(),[y,j]=(0,t.useState)(!0);(0,t.useEffect)(()=>{switch(h){case"danger":x((0,r.jsx)(u.ZP,{}));break;case"success":x((0,r.jsx)(p.ZP,{}));break;case"inProgress":x((0,r.jsx)(c.ZP,{}));break;default:x(h)}},[h]);let b=(0,r.jsxs)("div",{className:i.Z.multipleFileUploadStatusProgress,children:[(0,r.jsx)("div",{className:`${i.Z.multipleFileUploadStatusProgress}-icon`,children:v}),(0,r.jsx)("div",{className:`${i.Z.multipleFileUploadStatusProgress}-text`,children:g})]}),_=()=>{j(!y)};return(0,r.jsx)("div",Object.assign({className:(0,n.i)(i.Z.multipleFileUploadStatus,a)},f,{children:(0,r.jsx)(d.w,{prefix:"pf-expandable-section-",children:e=>(0,r.jsx)(o.L,{contentId:`${e}-content`,toggleId:`${e}-toggle`,toggleContent:b,isExpanded:y,onToggle:_,children:(0,r.jsx)("ul",{className:`${i.Z.multipleFileUploadStatus}-list`,role:"list","aria-label":m,children:s})})})}))};g.displayName="MultipleFileUploadStatus"},23056:function(e,s,a){a.d(s,{B:()=>u});var l=a(59390),r=a(24246),t=a(27378),i=a(87678),n=a(15508),o=a(90241),d=a(78700);let c=(0,a(24329).I)({name:"FileIcon",height:512,width:384,svgPath:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z",yOffset:0,xOffset:0,svgClassName:void 0});var p=a(29765);let u=e=>{var{className:s,file:a,fileIcon:u,onReadStarted:g=()=>{},onReadFinished:h=()=>{},onReadSuccess:m=()=>{},onReadFail:f=()=>{},onClearClick:v=()=>{},customFileHandler:x,fileName:y,fileSize:j,progressValue:b,progressVariant:_,progressAriaLabel:F,progressAriaLabelledBy:P,progressId:N,progressAriaLiveMessage:Z,buttonAriaLabel:w="Remove from list",progressHelperText:T}=e,S=(0,l.__rest)(e,["className","file","fileIcon","onReadStarted","onReadFinished","onReadSuccess","onReadFail","onClearClick","customFileHandler","fileName","fileSize","progressValue","progressVariant","progressAriaLabel","progressAriaLabelledBy","progressId","progressAriaLiveMessage","buttonAriaLabel","progressHelperText"]);let[U,M]=(0,t.useState)(0),[C,I]=(0,t.useState)();(0,t.useEffect)(()=>{if(x)x(a);else g(a),new Promise((e,s)=>{let l=new FileReader;l.onload=()=>e(l.result),l.onerror=()=>s(l.error),l.onprogress=e=>{e.lengthComputable&&M(e.loaded/e.total*100)},l.readAsDataURL(a)}).then(e=>{I("success"),M(100),h(a),m(e,a)}).catch(e=>{h(a),f(e,a),I("danger")})},[]);let L=b||U,A=(0,r.jsxs)("span",{className:i.Z.multipleFileUploadStatusItemProgress,children:[(0,r.jsx)("span",{className:i.Z.multipleFileUploadStatusItemProgressText,children:y||(null==a?void 0:a.name)||""}),(0,r.jsx)("span",{className:i.Z.multipleFileUploadStatusItemProgressSize,children:j||(e=>{let s=["","K","M","G","T"],a=0;for(;e>=1e3;)a+=1,e/=1e3;return a>=s.length?"File size too large":`${Math.round(e)}${s[a]}B`})((null==a?void 0:a.size)||0)})]});return(0,r.jsxs)("li",Object.assign({className:(0,n.i)(i.Z.multipleFileUploadStatusItem,s)},S,{children:[(0,r.jsx)("div",{className:i.Z.multipleFileUploadStatusItemIcon,children:u||(0,r.jsx)(c,{})}),(0,r.jsxs)("div",{className:i.Z.multipleFileUploadStatusItemMain,children:[(0,r.jsxs)("div",{className:"pf-v6-screen-reader","aria-live":"polite",children:[Z&&"function"==typeof Z&&Z(+U.toFixed(2)),Z&&"string"==typeof Z&&Z,!Z&&`Progress value is ${b||Math.floor(U)}%.`]}),(0,r.jsx)(o.E,{title:A,value:L,variant:_||C,"aria-label":F,"aria-labelledby":P,id:N,helperText:T})]}),(0,r.jsx)("div",{className:`${i.Z.multipleFileUploadStatusItem}-close`,children:(0,r.jsx)(d.zx,{variant:"plain","aria-label":w,onClick:v,icon:(0,r.jsx)(p.ZP,{})})})]}))};u.displayName="MultipleFileUploadStatusItem"},90241:function(e,s,a){a.d(s,{E:()=>u,L:()=>r});var l,r,t=a(59390),i=a(24246),n=a(27378),o=a(54685),d=a(15508),c=a(20227),p=a(21938);(l=r||(r={})).sm="sm",l.md="md",l.lg="lg";class u extends n.Component{constructor(){super(...arguments),this.id=this.props.id||(0,p.Ki)()}render(){let e=this.props,{id:s,size:a,className:l,value:n,title:p,label:u,variant:g,measureLocation:h,min:m,max:f,valueText:v,isTitleTruncated:x,tooltipPosition:y,"aria-label":j,"aria-labelledby":b,helperText:_}=e,F=(0,t.__rest)(e,["id","size","className","value","title","label","variant","measureLocation","min","max","valueText","isTitleTruncated","tooltipPosition","aria-label","aria-labelledby","helperText"]),P={"aria-valuemin":m,"aria-valuenow":n,"aria-valuemax":f};(p||b)&&(P["aria-labelledby"]=p?`${this.id}-description`:b),j&&(P["aria-label"]=j),v&&(P["aria-valuetext"]=v),p||b||j||console.warn("One of aria-label or aria-labelledby properties should be passed when using the progress component without a title.");let N=Math.min(100,Math.max(0,Math.floor((n-m)/(f-m)*100)))||0;return(0,i.jsx)("div",Object.assign({},F,{className:(0,d.i)(o.Z.progress,o.Z.modifiers[g],["inside","outside"].includes(h)&&o.Z.modifiers[h],"inside"===h?o.Z.modifiers[r.lg]:o.Z.modifiers[a],!p&&o.Z.modifiers.singleline,l),id:this.id,children:(0,i.jsx)(c.p1,{parentId:this.id,value:N,title:p,label:u,variant:g,measureLocation:h,progressBarAriaProps:P,isTitleTruncated:x,tooltipPosition:y,helperText:_})}))}}u.displayName="Progress",u.defaultProps={className:"",measureLocation:c.nK.top,variant:null,id:"",title:"",min:0,max:100,size:null,label:null,value:0,valueText:null,isTitleTruncated:!1,tooltipPosition:"top","aria-label":null,"aria-labelledby":null}},20227:function(e,s,a){a.d(s,{nK:()=>t,p1:()=>y});var l,r,t,i,n=a(24246),o=a(27378),d=a(54685),c=a(15508),p=a(2499),u=a(30528),g=a(19879),h=a(87721),m=a(59390);let f=e=>{var{progressBarAriaProps:s,className:a="",children:l=null,value:r}=e,t=(0,m.__rest)(e,["progressBarAriaProps","className","children","value"]);return(0,n.jsx)("div",Object.assign({},t,{className:(0,c.i)(d.Z.progressBar,a)},s,{children:(0,n.jsx)("div",{className:(0,c.i)(d.Z.progressIndicator),style:{width:`${r}%`},children:(0,n.jsx)("span",{className:(0,c.i)(d.Z.progressMeasure),children:l})})}))};f.displayName="ProgressBar";let v=e=>{var{children:s}=e,a=(0,m.__rest)(e,["children"]);return(0,n.jsx)("div",Object.assign({className:d.Z.progressHelperText},a,{children:s}))};v.displayName="ProgressHelperText",(l=t||(t={})).outside="outside",l.inside="inside",l.top="top",l.none="none",(r=i||(i={})).danger="danger",r.success="success",r.warning="warning";let x={danger:g.ZP,success:u.ZP,warning:h.ZP},y=({progressBarAriaProps:e,value:s,title:a="",parentId:l,label:r=null,variant:i=null,measureLocation:u=t.top,isTitleTruncated:g=!1,tooltipPosition:h,helperText:m})=>{let y=x.hasOwnProperty(i)&&x[i],[j,b]=(0,o.useState)(""),_=(0,o.useRef)(null),F=e=>{e.target.offsetWidth<e.target.scrollWidth?b(a||e.target.innerHTML):b("")};(0,o.useEffect)(()=>{""!==j&&_.current.focus()},[j]);let P=g&&"string"==typeof a,N=(0,n.jsx)("div",Object.assign({className:(0,c.i)(d.Z.progressDescription,P&&d.Z.modifiers.truncate),id:`${l}-description`,"aria-hidden":P?null:"true",onMouseEnter:P?F:null,onFocus:P?F:null},P&&{tabIndex:0},{ref:_,children:a}));return(0,n.jsxs)(o.Fragment,{children:[a&&(0,n.jsxs)(n.Fragment,{children:[j&&(0,n.jsx)(p.u,{position:h,content:j,isVisible:!0,triggerRef:_}),N]}),(u!==t.none||y)&&(0,n.jsxs)("div",{className:(0,c.i)(d.Z.progressStatus),"aria-hidden":"true",children:[(u===t.top||u===t.outside)&&(0,n.jsx)("span",{className:(0,c.i)(d.Z.progressMeasure),children:r||`${s}%`}),y&&(0,n.jsx)("span",{className:(0,c.i)(d.Z.progressStatusIcon),children:(0,n.jsx)(y,{})})]}),(0,n.jsx)(f,{role:"progressbar",progressBarAriaProps:e,value:s,children:u===t.inside&&`${s}%`}),m&&(0,n.jsx)(v,{children:m})]})};y.displayName="ProgressContainer"},22621:function(e,s,a){a.d(s,{ZP:()=>l});let l=(0,a(24329).I)({name:"FileCodeIcon",height:512,width:384,svgPath:"M384 121.941V128H256V0h6.059c6.365 0 12.47 2.529 16.971 7.029l97.941 97.941A24.005 24.005 0 0 1 384 121.941zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zM123.206 400.505a5.4 5.4 0 0 1-7.633.246l-64.866-60.812a5.4 5.4 0 0 1 0-7.879l64.866-60.812a5.4 5.4 0 0 1 7.633.246l19.579 20.885a5.4 5.4 0 0 1-.372 7.747L101.65 336l40.763 35.874a5.4 5.4 0 0 1 .372 7.747l-19.579 20.884zm51.295 50.479l-27.453-7.97a5.402 5.402 0 0 1-3.681-6.692l61.44-211.626a5.402 5.402 0 0 1 6.692-3.681l27.452 7.97a5.4 5.4 0 0 1 3.68 6.692l-61.44 211.626a5.397 5.397 0 0 1-6.69 3.681zm160.792-111.045l-64.866 60.812a5.4 5.4 0 0 1-7.633-.246l-19.58-20.885a5.4 5.4 0 0 1 .372-7.747L284.35 336l-40.763-35.874a5.4 5.4 0 0 1-.372-7.747l19.58-20.885a5.4 5.4 0 0 1 7.633-.246l64.866 60.812a5.4 5.4 0 0 1-.001 7.879z",yOffset:0,xOffset:0,svgClassName:void 0})},87017:function(e,s,a){a.d(s,{Co:()=>h,Cu:()=>p,Hb:()=>u,y:()=>g});var l=a(79192),r=a(53195),t=a(70233),i=a(74502);a(41947);let n="/api",o="".concat(n,"/v2/advisory"),d="".concat(n,"/v2/sbom"),c=e=>{let s="application/json";return e.name.endsWith(".bz2")&&(s="application/json+bzip2"),s},p=(e,s)=>{let a=e.get(i.TB);return t.Z.post("".concat(o),a,(0,r._)((0,l._)({},s),{headers:{"Content-Type":c(a)}}))},u=(e,s)=>{let a=e.get(i.TB);return t.Z.post("".concat(d),a,(0,r._)((0,l._)({},s),{headers:{"Content-Type":c(a)}}))},g=(e,s)=>{let a=e.get(i.TB);return t.Z.post("/api/v2/ui/extract-sbom-purls",a,(0,r._)((0,l._)({},s),{headers:{"Content-Type":c(a)}}))},h=e=>t.Z.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},46001:function(e,s,a){a.d(s,{B:()=>y});var l=a(24246),r=a(27378),t=a(51851),i=a(21714),n=a(68924),o=a(23056),d=a(91057),c=a(84335),p=a(13754),u=a(79551),g=a(32489),h=a(90519),m=a(81211),f=a(45882),v=a(22621),x=a(416);let y=e=>{let{uploads:s,handleUpload:a,handleRemoveUpload:y,extractSuccessMessage:j,extractErrorMessage:b}=e,[_,F]=r.useState(!1),[P,N]=r.useState("inProgress"),[Z,w]=r.useState([]);!_&&s.size>0&&F(!0),r.useEffect(()=>{let e=Array.from(s.values());e.some(e=>"inProgress"===e.status)?N("inProgress"):e.every(e=>"complete"===e.status)?N("success"):N("danger")},[s]);let T=Array.from(s.values()).filter(e=>e.response).length;return(0,l.jsxs)(t.o,{onFileDrop:(e,s)=>{a(s)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{w(e)},useFsAccessApi:!1},children:[(0,l.jsx)(i.Y,{titleIcon:(0,l.jsx)(x.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),_&&(0,l.jsx)(n.M,{statusToggleText:"".concat(T," of ").concat(s.size," files uploaded"),statusToggleIcon:P,children:Array.from(s.entries()).map((e,s)=>{let[a,r]=e;return(0,l.jsx)(o.B,{customFileHandler:()=>{},fileIcon:(0,l.jsx)(v.ZP,{}),file:a,onClearClick:()=>(e=>{for(let s of e)y(s)})([a]),progressValue:r.progress,progressVariant:r.error?"danger":r.response?"success":void 0,progressHelperText:r.error?(0,l.jsx)(d.p,{isLiveRegion:!0,children:(0,l.jsx)(c.u,{variant:"error",children:b(r.error)})}):100!==r.progress||r.response?r.response?(0,l.jsx)(d.p,{isLiveRegion:!0,children:(0,l.jsx)(c.u,{variant:"default",children:j(r.response)})}):void 0:(0,l.jsx)(d.p,{isLiveRegion:!0,children:(0,l.jsxs)(c.u,{variant:"warning",children:[(0,l.jsx)(p.$,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},"".concat(a.name,"-").concat(s))})}),(0,l.jsxs)(u.u,{isOpen:Z.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>w([]),variant:"small",children:[(0,l.jsx)(g.x,{title:"Unsupported files",titleIconVariant:"warning"}),(0,l.jsx)(h.f,{children:(0,l.jsx)(m.aV,{children:Z.map(e=>(0,l.jsx)(f.H,{children:e.file.name},e.file.name))})})]})]})}},95169:function(e,s,a){a.d(s,{V:()=>p});var l=a(79192),r=a(53195),t=a(27378),i=a(74502),n=a(70233);let o="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,s)=>{switch(s.type){case"queueUpload":return(0,r._)((0,l._)({},e),{uploads:new Map(e.uploads).set(s.payload.file,(0,r._)((0,l._)({},e.uploads.get(s.payload.file)||d()),{status:"queued",cancelFn:s.payload.cancelFn}))});case"updateUploadProgress":return(0,r._)((0,l._)({},e),{uploads:new Map(e.uploads).set(s.payload.file,(0,r._)((0,l._)({},e.uploads.get(s.payload.file)||d()),{progress:s.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,r._)((0,l._)({},e),{uploads:new Map(e.uploads).set(s.payload.file,(0,r._)((0,l._)({},e.uploads.get(s.payload.file)||d()),{status:"complete",response:s.payload.response}))});case"finishUploadWithError":var a;return(0,r._)((0,l._)({},e),{uploads:new Map(e.uploads).set(s.payload.file,(0,r._)((0,l._)({},e.uploads.get(s.payload.file)||d()),{status:"complete",error:s.payload.error,wasCancelled:(null==(a=s.payload.error)?void 0:a.message)===o}))});case"removeUpload":{let a=new Map(e.uploads);return a.delete(s.payload.file),(0,r._)((0,l._)({},e),{uploads:a})}default:throw Error()}},p=e=>{let{parallel:s,uploadFn:a,onSuccess:l,onError:r}=e,[d,p]=t.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let t=[];for(let s=0;s<e.length;s++){let a=e[s],d=new FormData;d.set(i.TB,a);let c=n.Z.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var s;let l=null!=(s=e.total)?s:1;p({type:"updateUploadProgress",payload:{file:a,progress:Math.round(e.loaded/l*100)}})},cancelToken:c.token};p({type:"queueUpload",payload:{file:a,cancelFn:c}});let g={formData:d,config:u,thenFn:e=>{p({type:"finishUploadSuccessfully",payload:{file:a,response:e}}),l&&l(e,a)},catchFn:e=>{p({type:"finishUploadWithError",payload:{file:a,error:e}}),e.message!==o&&r&&r(e,a)}};t.push(g)}if(s)for(let e of t)a(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else t.reduce(async(e,s)=>(await e,a(s.formData,s.config).then(s.thenFn).catch(s.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var s,a;null==(a=d.uploads.get(e))||null==(s=a.cancelFn)||s.cancel(o)},handleRemoveUpload:e=>{p({type:"removeUpload",payload:{file:e}})}}}},99327:function(e,s,a){a.r(s),a.d(s,{default:()=>u});var l=a(24246),r=a(65783),t=a(45043),i=a(97339),n=a(18091),o=a(68802),d=a(46001),c=a(17598),p=a(9839);let u=()=>{let{uploads:e,handleUpload:s,handleRemoveUpload:a}=(0,c.tG)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.NP,{type:"breadcrumb",children:(0,l.jsxs)(i.a,{children:[(0,l.jsx)(n.g,{children:(0,l.jsx)(r.rU,{to:p.nB.advisories,children:"Advisories"})}),(0,l.jsx)(n.g,{isActive:!0,children:"Upload Advisory"})]})}),(0,l.jsx)(t.NP,{children:(0,l.jsxs)(o.V,{children:[(0,l.jsx)(o.V,{component:"h1",children:"Upload Advisory"}),(0,l.jsx)(o.V,{component:"p",children:"Upload a CSAF, CVE, or OSV Advisory."})]})}),(0,l.jsx)(t.NP,{children:(0,l.jsx)(d.B,{uploads:e,handleUpload:s,handleRemoveUpload:a,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var s;return(null==(s=e.response)?void 0:s.data)?e.message:"Error while uploading file"}})})]})}},17598:function(e,s,a){a.d(s,{N7:()=>v,VY:()=>f,gw:()=>x,sj:()=>b,tG:()=>j,y2:()=>y});var l=a(79192),r=a(53195),t=a(70186),i=a(1183),n=a(24038),o=a(68e3),d=a(75503),c=a(50576),p=a(40371),u=a(87017),g=a(49988),h=a(95169);let m="advisories",f=e=>{let{data:s,isLoading:a,error:l,refetch:r}=(0,i.a)({queryKey:[m,"labels",e],queryFn:()=>(0,p.sf)({client:c.L,query:{limit:10,filter_text:e}}),placeholderData:n.Wk});return{labels:(null==s?void 0:s.data)||[],isFetching:a,fetchError:l,refetch:r}},v=function(){var e,s,a;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,g.rm)(n),{q:h}=u,f=(0,t._)(u,["q"]),v=(0,g.Rb)(o),{data:x,isLoading:y,error:j,refetch:b}=(0,i.a)({queryKey:[m,n,v],queryFn:()=>(0,p.A1)({client:c.L,query:(0,r._)((0,l._)({},f),{q:[h,v].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(a=null==x||null==(s=x.data)?void 0:s.total)?a:0,params:n},isFetching:y,fetchError:j||null,refetch:b}},x=e=>{let{data:s,isLoading:a,error:l}=(0,i.a)({queryKey:[m,e],queryFn:()=>(0,p.pB)({client:c.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==s?void 0:s.data,isFetching:a,fetchError:l}},y=(e,s)=>{let a=(0,o.NL)();return(0,d.D)({mutationFn:async e=>(await (0,p.Wr)({client:c.L,path:{key:e}})).data,onSuccess:async(s,l)=>{e(s,l),await a.invalidateQueries({queryKey:[m]})},onError:async e=>{s(e),await a.invalidateQueries({queryKey:[m]})}})},j=()=>{let e=(0,o.NL)();return(0,h.V)({parallel:!0,uploadFn:(e,s)=>(0,u.Cu)(e,s),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},b=(e,s)=>{let a=(0,o.NL)();return(0,d.D)({mutationFn:e=>(0,p.m5)({client:c.L,path:{id:e.id},body:e.labels}),onSuccess:async(s,l)=>{e(),await a.invalidateQueries({queryKey:[m]})},onError:s})}},54685:function(e,s,a){a.d(s,{Z:()=>l});let l={modifiers:{sm:"pf-m-sm",lg:"pf-m-lg",inside:"pf-m-inside",outside:"pf-m-outside",staticWidth:"pf-m-static-width",singleline:"pf-m-singleline",success:"pf-m-success",warning:"pf-m-warning",danger:"pf-m-danger",truncate:"pf-m-truncate"},progress:"pf-v6-c-progress",progressBar:"pf-v6-c-progress__bar",progressDescription:"pf-v6-c-progress__description",progressHelperText:"pf-v6-c-progress__helper-text",progressIndicator:"pf-v6-c-progress__indicator",progressMeasure:"pf-v6-c-progress__measure",progressStatus:"pf-v6-c-progress__status",progressStatusIcon:"pf-v6-c-progress__status-icon"}}}]);