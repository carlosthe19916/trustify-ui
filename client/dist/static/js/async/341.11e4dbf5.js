"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["341"],{67447:function(e,t,i){i.d(t,{G:()=>a});var r=i(59390),l=i(24246),s=i(15508),n=i(39157);let a=e=>{var{children:t=null,hasNoBackground:i}=e,a=(0,r.__rest)(e,["children","hasNoBackground"]);return(0,l.jsx)("div",Object.assign({},a,{className:(0,s.i)(n.Z.tableExpandableRowContent,i&&n.Z.modifiers.noBackground),children:t}))};a.displayName="ExpandableRowContent"},69876:function(e,t,i){i.d(t,{D:()=>s});var r=i(24246),l=i(70400);let s=e=>{let{value:t}=e;return(0,r.jsx)(r.Fragment,{children:Object.entries(t).map(e=>{let[t,i]=e;return(0,r.jsx)(l._,{isCompact:!0,children:"".concat(t,"=").concat(i)},"".concat(t,"=").concat(i))})})}},3586:function(e,t,i){i.d(t,{j:()=>s});var r=i(24246),l=i(27378);let s=e=>{let{children:t}=e,[i,s]=l.useState(!1);return(0,r.jsx)(r.Fragment,{children:t(i,s)})}},24200:function(e,t,i){i.d(t,{G:()=>l});var r=i(24246);let l=e=>{let{vulnerability:t}=e;return(0,r.jsxs)("p",{children:[t.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},43006:function(e,t,i){i.d(t,{S:()=>n});var r=i(24246),l=i(70400),s=i(32947);let n=e=>{let{value:t}=e,i=s.X6[t];return(0,r.jsx)(l._,{color:i.color,children:i.name})}},82413:function(e,t,i){i.d(t,{Ap:()=>h,Ie:()=>v,_g:()=>u});var r=i(79192),l=i(53195),s=i(27378),n=i(7615),a=i(43959);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,d={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:(0,r._)({},d),fixed:(0,r._)({},d),not_affected:(0,r._)({},d),known_not_affected:(0,r._)({},d),under_investigation:(0,r._)({},d)}},c=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let i,s=e.find(e=>o(e,t));if(s)i=[...e.filter(e=>!o(e,s)),(0,l._)((0,r._)({},s),{relatedPackages:[...s.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};i=[...e.slice(),r]}return i},[]),i=t.reduce((e,t)=>{let i=t.vulnerabilityStatus,s=(0,n.g)(t.vulnerability.average_severity),a=e.vulnerabilityStatus[i];return Object.assign(e,{vulnerabilityStatus:(0,l._)((0,r._)({},e.vulnerabilityStatus),{[i]:{total:a.total+1,severities:(0,l._)((0,r._)({},a.severities),{[s]:a.severities[s]+1})}})})},(0,r._)({},u));return{vulnerabilities:t,summary:i}},h=e=>{let{advisories:t,isFetching:i,fetchError:r}=(0,a.KQ)(e);return{data:s.useMemo(()=>c(t||[]),[t]),isFetching:i,fetchError:r}},v=e=>{let{advisories:t,isFetching:i,fetchError:r}=(0,a.uz)(e);return{data:s.useMemo(()=>(null!=t?t:[]).map(e=>c(e||[])),[t]),isFetching:i,fetchError:r}}},10916:function(e,t,i){i.r(t),i.d(t,{default:()=>eT});var r=i(24246),l=i(27378),s=i(14935),n=i(65783),a=i(2926),o=i(45043),d=i(97339),u=i(18091),c=i(68802),h=i(11192),v=i(32591),p=i(32939),y=i(24620),b=i(37961),f=i(69265),m=i(10707),x=i(16668),j=i(59390),g=i(15508),_=i(32954);let S=e=>{var{children:t,className:i}=e,l=(0,j.__rest)(e,["children","className"]);return(0,r.jsx)("div",Object.assign({className:(0,g.i)(_.Z.emptyStateFooter,i)},l,{children:t}))};S.displayName="EmptyStateFooter";let w=e=>{var{children:t,className:i}=e,l=(0,j.__rest)(e,["children","className"]);return(0,r.jsx)("div",Object.assign({className:(0,g.i)(_.Z.emptyStateActions,i)},l,{children:t}))};w.displayName="EmptyStateActions";var T=i(78700),k=i(79551),E=i(32489),O=i(90519),q=i(35072);let C=(0,i(24329).I)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0,svgClassName:void 0});var F=i(42160),P=i(1353),K=i(87017),R=i(74502),L=i(68e3),z=i(95169),A=i(27031),M=i(79192),D=i(53195),N=i(32947),V=i(7615),Q=i(82413),B=i(78176),I=i(27693),U=i.n(I),Z=i(70715),H=i(40982),G=i(89226),J=i(74607),W=i(34747),X=i(46770),$=i(81211),Y=i(45882),ee=i(4835),et=i(14350),ei=i(11165),er=i(89330),el=i(31423),es=i(94154),en=i(9905),ea=i(67447),eo=i(14629),ed=i(69876),eu=i(57524),ec=i(3804),eh=i(31336),ev=i(3586),ep=i(24200),ey=i(49988),eb=i(41135),ef=i(63706),em=i(43006);let ex=e=>{let{vulnerabilities:t,isFetching:i,fetchError:l}=e,s=(0,eb.T)(t,e=>"".concat(e.vulnerability.identifier,"-").concat(e.status)),n=(0,ey.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:s,isLoading:i,columnNames:{vulnerabilityId:"Vulnerability ID",description:"Description",severity:"Severity",status:"Status",affectedPackages:"Affected packages",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["vulnerabilityId","affectedPackages","published","updated"],getSortValues:e=>{var t,i;return{vulnerabilityId:e.vulnerability.identifier,affectedPackages:e.purls.size,published:(null==(t=e.vulnerability)?void 0:t.published)?U()(e.vulnerability.published).valueOf():0,updated:(null==(i=e.vulnerability)?void 0:i.modified)?U()(e.vulnerability.modified).valueOf():0}},isFilterEnabled:!0,filterCategories:[{categoryKey:"vulnerabilityId",title:"Vulnerability ID",type:eo.vA.search,placeholderText:"Search by Vulnerability ID",getItemValue:e=>e.vulnerability.identifier},{categoryKey:"severity",title:"Severity",type:eo.vA.multiselect,placeholderText:"Severity",selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],matcher:(e,t)=>e===t.opinionatedAvisory.extendedSeverity},{categoryKey:"status",title:"Status",type:eo.vA.multiselect,placeholderText:"Status",selectOptions:[{value:"affected",label:"Affected"},{value:"under_investigation",label:"Under investigation"},{value:"known_not_affected",label:"Known not affected"},{value:"not_affected",label:"Not affected"},{value:"fixed",label:"Fixed"}],matcher:(e,t)=>e===t.status}],isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:a,numRenderedColumns:o,propHelpers:{toolbarProps:d,paginationToolbarItemProps:u,paginationProps:c,tableProps:h,filterToolbarProps:v,getThProps:p,getTrProps:y,getTdProps:b,getExpandedContentTdProps:f},expansionDerivedState:{isCellExpanded:m}}=n;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Z.o,(0,D._)((0,M._)({},d),{children:(0,r.jsxs)(H.c,{children:[(0,r.jsx)(eo.Ki,(0,M._)({},v)),(0,r.jsx)(G.E,(0,D._)((0,M._)({},u),{children:(0,r.jsx)(ec.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:c})}))]})})),(0,r.jsxs)(ee.i,(0,D._)((0,M._)({},h),{"aria-label":"Vulnerability table",children:[(0,r.jsx)(et.h,{children:(0,r.jsx)(ei.Tr,{children:(0,r.jsxs)(eh.qK,(0,D._)((0,M._)({},n),{children:[(0,r.jsx)(er.Th,(0,M._)({},p({columnKey:"vulnerabilityId"}))),(0,r.jsx)(er.Th,(0,M._)({},p({columnKey:"description"}))),(0,r.jsx)(er.Th,(0,M._)({},p({columnKey:"severity"}))),(0,r.jsx)(er.Th,(0,M._)({},p({columnKey:"status"}))),(0,r.jsx)(er.Th,(0,M._)({},p({columnKey:"affectedPackages"}))),(0,r.jsx)(er.Th,(0,M._)({},p({columnKey:"published"}))),(0,r.jsx)(er.Th,(0,M._)({},p({columnKey:"updated"})))]}))})}),(0,r.jsx)(eh.hp,{isLoading:i,isError:!!l,isNoData:0===s.length,numRenderedColumns:o,children:null==a?void 0:a.map((e,t)=>{var i,l;return(0,r.jsxs)(el.p,{isExpanded:m(e),children:[(0,r.jsx)(ei.Tr,(0,D._)((0,M._)({},y({item:e})),{children:(0,r.jsxs)(eh.Cx,(0,D._)((0,M._)({},n),{item:e,rowIndex:t,children:[(0,r.jsx)(es.Td,(0,D._)((0,M._)({width:15,modifier:"breakWord"},b({columnKey:"vulnerabilityId"})),{children:e.vulnerability.identifier})),(0,r.jsx)(ev.j,{children:(t,i)=>(0,r.jsx)(es.Td,(0,D._)((0,M._)({width:25,modifier:"truncate",onFocus:()=>i(!0),onBlur:()=>i(!1),tabIndex:0},b({columnKey:"description"})),{children:(0,r.jsx)(en.cE,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,r.jsx)(ep.G,{vulnerability:e.vulnerability})})}))}),(0,r.jsx)(es.Td,(0,D._)((0,M._)({width:20,modifier:"breakWord"},b({columnKey:"severity"})),{children:(0,r.jsx)(J.e,{isVertical:!0,children:Array.from(e.advisories.entries()).map(e=>{var t,i;let[l,s]=e;return(0,r.jsx)(W.k,{children:(0,r.jsx)(X.B,{spacer:{default:"spacerNone"},children:(0,r.jsx)(eu.o,{value:s.opinionatedExtendedSeverity,score:null!=(i=null==(t=s.opinionatedScore)?void 0:t.value)?i:null,showLabel:!0,showScore:!0})})},l)})})})),(0,r.jsx)(es.Td,(0,D._)((0,M._)({width:10,modifier:"truncate"},b({columnKey:"status"})),{children:(0,r.jsx)(em.S,{value:e.status})})),(0,r.jsx)(es.Td,(0,D._)((0,M._)({width:10,modifier:"truncate"},b({columnKey:"affectedPackages",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:e.purls.size})),(0,r.jsx)(es.Td,(0,D._)((0,M._)({width:10,modifier:"truncate"},b({columnKey:"published"})),{children:(0,ef.p6)(null==(i=e.vulnerability)?void 0:i.published)})),(0,r.jsx)(es.Td,(0,D._)((0,M._)({width:10,modifier:"truncate"},b({columnKey:"updated"})),{children:(0,ef.p6)(null==(l=e.vulnerability)?void 0:l.modified)}))]}))})),m(e)?(0,r.jsx)(ei.Tr,{isExpanded:!0,children:(0,r.jsx)(es.Td,(0,D._)((0,M._)({},f({item:e})),{children:(0,r.jsxs)(ea.G,{children:[m(e,"severity")?(0,r.jsx)($.aV,{isPlain:!0,children:Array.from(e.advisories.values()).map(e=>(0,r.jsx)(Y.H,{children:e.advisory.identifier},"".concat(e.advisory.identifier)))}):null,m(e,"affectedPackages")?(0,r.jsxs)(ee.i,{variant:"compact",children:[(0,r.jsx)(et.h,{children:(0,r.jsxs)(ei.Tr,{children:[(0,r.jsx)(er.Th,{children:"Type"}),(0,r.jsx)(er.Th,{children:"Namespace"}),(0,r.jsx)(er.Th,{children:"Name"}),(0,r.jsx)(er.Th,{children:"Version"}),(0,r.jsx)(er.Th,{children:"Path"}),(0,r.jsx)(er.Th,{children:"Qualifiers"})]})}),(0,r.jsx)(el.p,{children:Array.from(e.purls.values()).map(e=>{let t=(0,ef.qX)(e);return t?(0,r.jsxs)(ei.Tr,{children:[(0,r.jsx)(es.Td,{children:null==t?void 0:t.type}),(0,r.jsx)(es.Td,{children:null==t?void 0:t.namespace}),(0,r.jsx)(es.Td,{children:null==t?void 0:t.name}),(0,r.jsx)(es.Td,{children:null==t?void 0:t.version}),(0,r.jsx)(es.Td,{children:null==t?void 0:t.path}),(0,r.jsx)(es.Td,{children:(null==t?void 0:t.qualifiers)&&(0,r.jsx)(ed.D,{value:null==t?void 0:t.qualifiers})})]},e):(0,r.jsx)(ei.Tr,{children:(0,r.jsx)(es.Td,{colSpan:6,children:e})},e)})})]}):null]})}))}):null]},e._ui_unique_id)})})]})),(0,r.jsx)(ec.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:c})]})};var ej=i(51851),eg=i(21714),e_=i(75481),eS=i(416);let ew=e=>{let{uploads:t,handleUpload:i,handleRemoveUpload:s,handleCancelUpload:n}=e,{rejectedFiles:a,setRejectedFiles:o,handleFileDrop:d,handleDropRejected:u,removeFiles:c}=(e=>{let{uploads:t,handleUpload:i,handleRemoveUpload:r}=e,[s,n]=l.useState(!1),[a,o]=l.useState("inProgress"),[d,u]=l.useState([]);return!s&&t.size>0&&n(!0),l.useEffect(()=>{let e=Array.from(t.values());e.some(e=>"inProgress"===e.status)?o("inProgress"):e.every(e=>"complete"===e.status)?o("success"):o("danger")},[t]),{showStatus:s,status:a,rejectedFiles:d,setRejectedFiles:u,handleFileDrop:(e,t)=>{i(t)},handleDropRejected:e=>{u(e)},successFileCount:Array.from(t.values()).filter(e=>e.response).length,removeFiles:e=>{for(let t of e)r(t)}}})({uploads:t,handleUpload:i,handleRemoveUpload:s});return(0,r.jsxs)(ej.o,{onFileDrop:d,dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:u,useFsAccessApi:!1,multiple:!1,disabled:t.size>0},children:[0===t.size?(0,r.jsx)(eg.Y,{titleIcon:(0,r.jsx)(eS.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2",browseButtonText:"Browse Files"}):Array.from(t.entries()).map((e,t)=>{let[i,l]=e;if(l.error){var s,a,o;return l.wasCancelled?(0,r.jsxs)(m.ub,{status:"danger",headingLevel:"h4",titleText:"Upload cancelled",icon:F.ZP,variant:m.IQ.sm,children:[(0,r.jsx)(x.B,{children:"The file could not be analyzed. The operation was cancelled."}),(0,r.jsx)(S,{children:(0,r.jsx)(w,{children:(0,r.jsx)(T.zx,{variant:"primary",onClick:()=>c([i]),children:"Try another file"})})})]},"".concat(i.name,"-").concat(t,"-cancelled")):(console.log(l.error),(0,r.jsxs)(m.ub,{status:"danger",headingLevel:"h4",titleText:"Error ".concat(null!=(o=l.error.status)?o:l.error.code,": Upload failed"),icon:F.ZP,variant:m.IQ.sm,children:[(0,r.jsxs)(x.B,{children:["The file could not be analyzed. The file might be corrupted or an unsupported format.",(null==(s=l.error.response)?void 0:s.data.message)&&(0,r.jsx)(e_.L,{toggleText:"Show details",children:null==(a=l.error.response)?void 0:a.data.message})]}),(0,r.jsx)(S,{children:(0,r.jsx)(w,{children:(0,r.jsx)(T.zx,{variant:"primary",onClick:()=>c([i]),children:"Try another file"})})})]},"".concat(i.name,"-").concat(t,"-error")))}return(0,r.jsxs)(m.ub,{headingLevel:"h4",titleText:"Uploading SBOM ".concat(l.progress,"%"),icon:P.ZP,variant:m.IQ.sm,children:[(0,r.jsx)(x.B,{children:"Securely uploading your SBOM for analysis. The file will not be saved."}),(0,r.jsx)(S,{children:(0,r.jsx)(w,{children:(0,r.jsx)(T.zx,{variant:"link",onClick:()=>n(i),children:"Cancel upload"})})})]},"".concat(i.name,"-").concat(t,"-progress"))}),(0,r.jsxs)(k.u,{isOpen:a.length>0,"aria-label":"rejected files",onClose:()=>o([]),variant:"small",children:[(0,r.jsx)(E.x,{title:"Rejected files",titleIconVariant:"warning"}),(0,r.jsx)(O.f,{children:(0,r.jsx)($.aV,{children:a.map(e=>(0,r.jsx)(Y.H,{children:e.file.name},e.file.name))})})]})]})},eT=()=>{let[e,t]=(0,l.useState)(!1),i=()=>{t(!e)},[j,g]=(0,l.useState)(null),{uploads:_,handleUpload:I,handleCancelUpload:U,handleRemoveUpload:Z}=(e=>{let t=(0,L.NL)();return(0,z.V)({parallel:!0,uploadFn:(e,t)=>(0,K.y)(e,t),onSuccess:async(i,r)=>{e(i.data,r),await t.invalidateQueries({queryKey:["sbom-analysis"]})}})})((e,t)=>{g(e)}),H=l.useCallback(e=>{let{currentLocation:t,nextLocation:i}=e;return null!==j&&t.pathname!==i.pathname},[j]),G=(0,s._Z)(H),{data:{vulnerabilities:J},analysisResponse:W,isFetching:X,fetchError:$}=(e=>{let{analysisResponse:t,isFetching:i,fetchError:r}=(0,B.DK)(e);return{data:l.useMemo(()=>{if(i||r||0===Object.keys(t).length)return{summary:(0,M._)({},Q._g),vulnerabilities:[]};let e=Object.entries(t).flatMap(e=>{let[t,i]=e;return i.details.flatMap(e=>Object.entries(e.status).flatMap(i=>{let[r,l]=i;return l.map(i=>({purl:t,vulnerability:e,status:r,advisory:i,scores:i.scores}))}))}).reduce((e,t)=>{let i,r=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.status===t.status,l=e.find(e=>r(e,t));if(l){var s,n,a,o;let d=e.filter(e=>!r(e,l)),u=(0,N.dn)(t.scores),c=(0,V.g)(null==u?void 0:u.severity),h=new Map(l.advisories);h.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedScore:u,opinionatedExtendedSeverity:c});let v=new Set(l.purls);v.add(t.purl);let p=null,y=null;if((null==(s=l.opinionatedAvisory.score)?void 0:s.type)!==(null==u?void 0:u.type)){let e=[{advisory:l.opinionatedAvisory.advisory,score:l.opinionatedAvisory.score},{advisory:t.advisory,score:u}].sort((0,N.Bn)(e=>{var t,i;return null!=(i=null==(t=e.score)?void 0:t.type)?i:null}))[0];p=e.advisory,y=e.score}else{let{advisory:e,score:i}=(null!=(a=null==u?void 0:u.value)?a:0)>(null!=(o=null==(n=l.opinionatedAvisory.score)?void 0:n.value)?o:0)?{score:u,advisory:t.advisory}:{score:l.opinionatedAvisory.score,advisory:l.opinionatedAvisory.advisory};p=e,y=i}let b=(0,V.g)(null==y?void 0:y.severity);i=[...d,{vulnerability:l.vulnerability,status:l.status,advisories:h,purls:v,opinionatedAvisory:{advisory:p,score:y,extendedSeverity:b}}]}else{let r=(0,N.dn)(t.scores),l=(0,V.g)(null==r?void 0:r.severity),s=new Map;s.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedExtendedSeverity:l,opinionatedScore:r});let n=new Set;n.add(t.purl);let a={vulnerability:t.vulnerability,status:t.status,advisories:s,purls:n,opinionatedAvisory:{advisory:t.advisory,score:r,extendedSeverity:l}};i=[...e.slice(),a]}return i},[]),l=e.reduce((e,t)=>{let i=t.status,r=t.opinionatedAvisory.extendedSeverity,l=e.vulnerabilityStatus[i];return Object.assign(e,{vulnerabilityStatus:(0,D._)((0,M._)({},e.vulnerabilityStatus),{[i]:{total:l.total+1,severities:(0,D._)((0,M._)({},l.severities),{[r]:l.severities[r]+1})}})})},(0,M._)({},Q._g));return{vulnerabilities:e,summary:l}},[t,i,r]),analysisResponse:t,isFetching:i,fetchError:r}})((0,l.useMemo)(()=>{var e;return Object.entries(null!=(e=null==j?void 0:j.packages)?e:{}).flatMap(e=>{let[t,{purls:i}]=e;return i})},[j])),[Y,ee]=l.useState(!1),et=async()=>{ee(!0);let e=new FormData;e.append(R.Dx,new Blob([JSON.stringify(W)],{type:"application/json"})),await (0,K.PP)(e).then(e=>{(0,a.saveAs)(new Blob([e.data]),"report.tar.gz")}),ee(!1)},ei=()=>{for(let e of _.keys())Z(e);g(null)},er=null===j||X||$;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.NP,{type:"breadcrumb",children:(0,r.jsxs)(d.a,{children:[(0,r.jsx)(u.g,{children:(0,r.jsx)(n.rU,{to:A.nB.sboms,children:"SBOMs"})}),er?(0,r.jsx)(u.g,{isActive:!0,children:"Generate vulnerability report"}):(0,r.jsx)(u.g,{isActive:!0,children:"Vulnerability report"})]})}),(0,r.jsx)(o.NP,{children:er?(0,r.jsxs)(c.V,{children:[(0,r.jsx)(c.V,{component:"h1",children:"Generate vulnerability report"}),(0,r.jsx)(c.V,{component:"p",children:"Select an SBOM file to generate a temporary vulnerability report. The file and report will not be saved."})]}):(0,r.jsxs)(h.P,{children:[(0,r.jsx)(v.J,{isFilled:!0,children:(0,r.jsxs)(c.V,{children:[(0,r.jsx)(c.V,{component:"h1",children:"Vulnerability report"}),(0,r.jsx)(c.V,{component:"p",children:"This is a temporary vulnerability report."})]})}),(0,r.jsx)(v.J,{children:(0,r.jsxs)(p.L,{isOpen:e,onSelect:()=>t(!1),onOpenChange:e=>t(e),popperProps:{position:"right"},toggle:t=>(0,r.jsx)(y.O_,{ref:t,onClick:i,isExpanded:e,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:[(0,r.jsx)(b.s,{children:(0,r.jsx)(f.h,{onClick:ei,children:"Scan another"},"scan-another")}),(0,r.jsx)(b.s,{children:(0,r.jsx)(f.h,{onClick:et,isDisabled:Y,children:"Download report"},"download-report")})]})})]})}),(0,r.jsx)(o.NP,{children:null===j?(0,r.jsx)(ew,{uploads:_,handleUpload:I,handleRemoveUpload:Z,handleCancelUpload:U}):X?(0,r.jsxs)(m.ub,{titleText:"Generating SBOM report",headingLevel:"h4",icon:P.ZP,children:[(0,r.jsx)(x.B,{children:"Analyzing your SBOM for security vulnerabilities, license issues and dependency details."}),(0,r.jsx)(S,{children:(0,r.jsx)(w,{children:(0,r.jsx)(T.zx,{variant:"link",onClick:ei,children:"Cancel scan"})})})]}):$?(0,r.jsxs)(m.ub,{status:"danger",headingLevel:"h4",titleText:"Scan failed",icon:F.ZP,variant:m.IQ.sm,children:[(0,r.jsx)(x.B,{children:"The file could not be analyzed. The file might be corrupted or an unsupported format."}),(0,r.jsx)(S,{children:(0,r.jsx)(w,{children:(0,r.jsx)(T.zx,{variant:"primary",onClick:ei,children:"Try another file"})})})]}):(0,r.jsx)(ex,{vulnerabilities:J,isFetching:X,fetchError:$})}),(0,r.jsxs)(k.u,{variant:"small",isOpen:"blocked"===G.state,onClose:()=>"blocked"===G.state&&G.reset(),children:[(0,r.jsx)(E.x,{title:"Leave Vulnerability report?"}),(0,r.jsx)(O.f,{children:"This report is not saved and will be unavailable after leaving this page. To save the report, download it."}),(0,r.jsxs)(q.m,{children:[(0,r.jsx)(T.zx,{variant:"primary",icon:(0,r.jsx)(C,{}),isLoading:Y,isDisabled:Y,onClick:async()=>{await et(),"blocked"===G.state&&G.proceed()},children:"Download and leave"}),(0,r.jsx)(T.zx,{variant:"secondary",isDisabled:Y,onClick:async()=>{"blocked"===G.state&&G.proceed()},children:"Leave without downloading"}),(0,r.jsx)(T.zx,{variant:"link",isDisabled:Y,onClick:()=>{"blocked"===G.state&&G.reset()},children:"Cancel"},"cancel")]})]})]})}},43959:function(e,t,i){i.d(t,{Fz:()=>m,KQ:()=>w,Oh:()=>S,i5:()=>f,km:()=>g,p4:()=>x,qi:()=>k,s5:()=>j,t9:()=>_,uz:()=>T});var r=i(79192),l=i(53195),s=i(70186),n=i(1183),a=i(24038),o=i(68e3),d=i(75503),u=i(16072),c=i(50576),h=i(40371),v=i(95169),p=i(87017),y=i(49988);let b="sboms",f=e=>{let{data:t,isLoading:i,error:r,refetch:l}=(0,n.a)({queryKey:[b,"labels",e],queryFn:()=>(0,h.mh)({client:c.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:i,fetchError:r,refetch:l}},m=function(){var e,t,i;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,y.rm)(a),{q:v}=u,p=(0,s._)(u,["q"]),f=(0,y.Rb)(o),{data:m,isLoading:x,error:j,refetch:g}=(0,n.a)({queryKey:[b,a,f],queryFn:()=>(0,h.Wp)({client:c.L,query:(0,l._)((0,r._)({},p),{q:[v,f].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(i=null==m||null==(t=m.data)?void 0:t.total)?i:0,params:a},isFetching:x,fetchError:j,refetch:g}},x=e=>{let{data:t,isLoading:i,error:r}=(0,n.a)({queryKey:[b,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:c.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:i,fetchError:r}},j=(e,t)=>{let i=(0,o.NL)();return(0,d.D)({mutationFn:async e=>(await (0,h.WX)({client:c.L,path:{id:e}})).data,onSuccess:async(t,r)=>{e(t,r),await i.invalidateQueries({queryKey:[b]})},onError:async e=>{t(e),await i.invalidateQueries({queryKey:[b]})}})},g=()=>{let e=(0,o.NL)();return(0,v.V)({parallel:!0,uploadFn:(e,t)=>(0,p.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[b]})}})},_=(e,t)=>{let i=(0,o.NL)();return(0,d.D)({mutationFn:e=>(0,h.zx)({client:c.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await i.invalidateQueries({queryKey:[b]})},onError:t})},S=function(e){var t,i,l;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:a,isLoading:o,error:d,refetch:u}=(0,n.a)({queryKey:[b,"by-package",e,s],queryFn:()=>(0,h.DU)({client:c.L,query:(0,r._)({purl:e},(0,y.rm)(s))})});return{result:{data:(null==a||null==(t=a.data)?void 0:t.items)||[],total:null!=(l=null==a||null==(i=a.data)?void 0:i.total)?l:0,params:s},isFetching:o,fetchError:d,refetch:u}},w=e=>{let{data:t,isLoading:i,error:r}=(0,n.a)({queryKey:[b,e,"advisory"],queryFn:()=>(0,h.NU)({client:c.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:i,fetchError:r}},T=e=>{let t=(0,u.h)({queries:e.map(e=>({queryKey:[b,e,"advisory"],queryFn:()=>(0,h.NU)({client:c.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},k=e=>{let{data:t,isLoading:i,error:r}=(0,n.a)({queryKey:[b,e,"license-ids"],queryFn:()=>(0,h.J4)({client:c.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:i,fetchError:r}}},78176:function(e,t,i){i.d(t,{fd:()=>h,DK:()=>v,p6:()=>p});var r=i(79192),l=i(1183),s=i(16072),n=i(50576),a=i(40371),o=i(74502),d=i(49988);let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return new Promise((r,l)=>{setTimeout(()=>{i?r(e):l(Error("Error"))},t)})},c="vulnerabilities",h=function(){var e,t,i;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:h,error:v,refetch:p}=(0,l.a)({queryKey:[c,s],queryFn:()=>(0,a.b5)({client:n.L,query:(0,r._)({},(0,d.rm)(s))}),enabled:!o});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(i=null==u||null==(t=u.data)?void 0:t.total)?i:0,params:s},isFetching:h,fetchError:v,refetch:p}},v=e=>{var t;let i=o.e$?{ids:e.reduce((e,t,i)=>(i%100==0?e.push([t]):e[e.length-1].push(t),e),[]),dataResolver:async e=>(await (0,a.BJ)({client:n.L,body:{purls:e}})).data}:{ids:[e],dataResolver:e=>{var t;return u(null!=(t=window[o.Dx])?t:{})}},r=(0,s.h)({queries:i.ids.map(e=>({queryKey:[c,e],queryFn:()=>i.dataResolver(e),retry:!1}))}),l=r.some(e=>{let{isLoading:t}=e;return t}),d=r.find(e=>{let{error:t}=e;return!!t}),h={};if(!l)for(let e of r.map(e=>{var t;return null!=(t=null==e?void 0:e.data)?t:{}}))for(let[t,i]of Object.entries(e))h[t]=i;return{analysisResponse:h,isFetching:l,fetchError:null!=(t=null==d?void 0:d.error)?t:void 0}},p=e=>{let{data:t,isLoading:i,error:r}=(0,l.a)({queryKey:[c,e],queryFn:()=>(0,a.OG)({client:n.L,path:{id:e}})});return{vulnerability:null==t?void 0:t.data,isFetching:i,fetchError:r}}},41135:function(e,t,i){i.d(t,{T:()=>a});var r=i(79192),l=i(53195),s=i(27378),n=i(74502);let a=(e,t)=>(0,s.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,l._)((0,r._)({},e),{[n.nM]:t(e)})):[],[e,t])},16072:function(e,t,i){i.d(t,{h:()=>y});var r=i(27378),l=i(83484),s=i(7246),n=i(82418),a=i(24038);function o(e,t){let i=new Set(t);return e.filter(e=>!i.has(e))}var d=class extends n.l{#e;#t;#i;#r;#l;#s;#n;#a;#o=[];constructor(e,t,i){super(),this.#e=e,this.#r=i,this.#i=[],this.#l=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#l.forEach(e=>{e.subscribe(t=>{this.#d(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#l.forEach(e=>{e.destroy()})}setQueries(e,t){this.#i=e,this.#r=t,l.Vr.batch(()=>{let e=this.#l,t=this.#u(this.#i);this.#o=t,t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let i=t.map(e=>e.observer),r=i.map(e=>e.getCurrentResult()),l=i.some((t,i)=>t!==e[i]);(e.length!==i.length||l)&&(this.#l=i,this.#t=r,this.hasListeners()&&(o(e,i).forEach(e=>{e.destroy()}),o(i,e).forEach(e=>{e.subscribe(t=>{this.#d(e,t)})}),this.#c()))})}getCurrentResult(){return this.#t}getQueries(){return this.#l.map(e=>e.getCurrentQuery())}getObservers(){return this.#l}getOptimisticResult(e,t){let i=this.#u(e),r=i.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[r,e=>this.#h(e??r,t),()=>this.#v(r,i)]}#v(e,t){return t.map((i,r)=>{let l=e[r];return i.defaultedQueryOptions.notifyOnChangeProps?l:i.observer.trackResult(l,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#h(e,t){return t?(this.#s&&this.#t===this.#a&&t===this.#n||(this.#n=t,this.#a=this.#t,this.#s=(0,a.Q$)(this.#s,t(e))),this.#s):e}#u(e){let t=new Map(this.#l.map(e=>[e.options.queryHash,e])),i=[];return e.forEach(e=>{let r=this.#e.defaultQueryOptions(e),l=t.get(r.queryHash);l?i.push({defaultedQueryOptions:r,observer:l}):i.push({defaultedQueryOptions:r,observer:new s.z(this.#e,r)})}),i}#d(e,t){let i=this.#l.indexOf(e);-1!==i&&(this.#t=function(e,t,i){let r=e.slice(0);return r[t]=i,r}(this.#t,i,t),this.#c())}#c(){if(this.hasListeners()){let e=this.#s,t=this.#v(this.#t,this.#o);e!==this.#h(t,this.#r?.combine)&&l.Vr.batch(()=>{this.listeners.forEach(e=>{e(this.#t)})})}}},u=i(68e3),c=i(12675),h=i(73687),v=i(80484),p=i(76720);function y({queries:e,...t},i){let n=(0,u.NL)(i),o=(0,c.S)(),y=(0,h._)(),b=r.useMemo(()=>e.map(e=>{let t=n.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,n,o]);b.forEach(e=>{(0,p.A8)(e),(0,v.pf)(e,y)}),(0,v.JN)(y);let[f]=r.useState(()=>new d(n,b,t)),[m,x,j]=f.getOptimisticResult(b,t.combine),g=!o&&!1!==t.subscribed;r.useSyncExternalStore(r.useCallback(e=>g?f.subscribe(l.Vr.batchCalls(e)):a.ZT,[f,g]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),r.useEffect(()=>{f.setQueries(b,t)},[b,t,f]);let _=m.some((e,t)=>(0,p.SB)(b[t],e))?m.flatMap((e,t)=>{let i=b[t];if(i){let t=new s.z(n,i);if((0,p.SB)(i,e))return(0,p.j8)(i,t,y);(0,p.Z$)(e,o)&&(0,p.j8)(i,t,y)}return[]}):[];if(_.length>0)throw Promise.all(_);let S=m.find((e,t)=>{let i=b[t];return i&&(0,v.KJ)({result:e,errorResetBoundary:y,throwOnError:i.throwOnError,query:n.getQueryCache().get(i.queryHash),suspense:i.suspense})});if(S?.error)throw S.error;return x(j())}}}]);