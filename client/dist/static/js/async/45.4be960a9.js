"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["45"],{97339:function(e,i,n){n.d(i,{a:()=>c});var l=n(59390),r=n(24246),s=n(27378),t=n(90633),a=n(15508),d=n(53315);let c=e=>{var{children:i=null,className:n="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,m=(0,l.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let x=(0,d.S$)(c.displayName,u,h);return(0,r.jsx)("nav",Object.assign({},m,{"aria-label":o,className:(0,a.i)(t.Z.breadcrumb,n)},x,{children:(0,r.jsx)("ol",{className:t.Z.breadcrumbList,role:"list",children:s.Children.map(i,(e,i)=>(0,s.isValidElement)(e)?(0,s.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,n){n.d(i,{g:()=>d});var l=n(59390),r=n(24246),s=n(91985),t=n(90633),a=n(15508);let d=e=>{var{children:i=null,className:n="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:m="a",render:x}=e,j=(0,l.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let p=c?"page":void 0,b=(0,a.i)(t.Z.breadcrumbLink,c&&t.Z.modifiers.current);return(0,r.jsxs)("li",Object.assign({},j,{className:(0,a.i)(t.Z.breadcrumbItem,n),children:[u&&(0,r.jsx)("span",{className:t.Z.breadcrumbItemDivider,children:(0,r.jsx)(s.ZP,{})}),"button"===m&&(0,r.jsx)("button",{className:b,"aria-current":p,type:"button",children:i}),o&&(0,r.jsx)("span",{className:(0,a.i)(t.Z.breadcrumbDropdown),children:i}),x&&x({className:b,ariaCurrent:p}),d&&!x&&(0,r.jsx)(m,{href:d,target:h,className:b,"aria-current":p,children:i}),!d&&"button"!==m&&!o&&i]}))};d.displayName="BreadcrumbItem"},81211:function(e,i,n){n.d(i,{aV:()=>h});var l,r,s,t,a,d=n(59390),c=n(24246),o=n(40269),u=n(15508);(l=s||(s={})).number="1",l.lowercaseLetter="a",l.uppercaseLetter="A",l.lowercaseRomanNumber="i",l.uppercaseRomanNumber="I",(t||(t={})).inline="inline",(r=a||(a={})).ol="ol",r.ul="ul";let h=e=>{var{className:i="",children:n=null,variant:l=null,isBordered:r=!1,isPlain:t=!1,iconSize:h="default",type:m=s.number,ref:x=null,component:j=a.ul,"aria-label":p}=e,b=(0,d.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component","aria-label"]);return j===a.ol?(0,c.jsx)("ol",Object.assign({ref:x,type:m,"aria-label":p},t&&{role:"list"},b,{className:(0,u.i)(o.Z.list,l&&o.Z.modifiers[l],r&&o.Z.modifiers.bordered,t&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:n})):(0,c.jsx)("ul",Object.assign({ref:x,"aria-label":p},t&&{role:"list"},b,{className:(0,u.i)(o.Z.list,l&&o.Z.modifiers[l],r&&o.Z.modifiers.bordered,t&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:n}))};h.displayName="List"},45882:function(e,i,n){n.d(i,{H:()=>a});var l=n(59390),r=n(24246),s=n(40269),t=n(15508);let a=e=>{var{className:i,children:n=null,icon:a=null}=e,d=(0,l.__rest)(e,["className","children","icon"]);return(0,r.jsxs)("li",Object.assign({className:(0,t.i)(a&&s.Z.listItem,i)},d,{children:[a&&(0,r.jsx)("span",{className:(0,t.i)(s.Z.listItemIcon),children:a}),(0,r.jsx)("span",{className:a&&(0,t.i)(`${s.Z.list}__item-text`),children:n})]}))};a.displayName="ListItem"},26235:function(e,i,n){n.d(i,{ZP:()=>l});let l=(0,n(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},67447:function(e,i,n){n.d(i,{G:()=>a});var l=n(59390),r=n(24246),s=n(15508),t=n(39157);let a=e=>{var{children:i=null,hasNoBackground:n}=e,a=(0,l.__rest)(e,["children","hasNoBackground"]);return(0,r.jsx)("div",Object.assign({},a,{className:(0,s.i)(t.Z.tableExpandableRowContent,n&&t.Z.modifiers.noBackground),children:i}))};a.displayName="ExpandableRowContent"},69876:function(e,i,n){n.d(i,{D:()=>s});var l=n(24246),r=n(70400);let s=e=>{let{value:i}=e;return(0,l.jsx)(l.Fragment,{children:Object.entries(i).map(e=>{let[i,n]=e;return(0,l.jsx)(r._,{isCompact:!0,children:"".concat(i,"=").concat(n)},"".concat(i,"=").concat(n))})})}},68057:function(e,i,n){n.d(i,{V:()=>a});var l=n(24246),r=n(27378),s=n(63763),t=n(32947);let a=e=>{let{vulnerabilitiesSummary:i}=e,n=r.useMemo(()=>Object.keys(i.severities).map(e=>{let n=i.severities[e],l=t.V4[e];return{severity:e,count:n,label:l.name,color:l.color.value}}).sort((0,t.A0)(e=>e.severity)).reverse(),[i]);return(0,l.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,l.jsx)(s.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(i.total),subTitle:"Total vulnerabilities",width:350,legendData:n.map(e=>{let{label:i,count:n}=e;return{name:"".concat(i,": ").concat(n)}}),data:n.map(e=>{let{label:i,count:n}=e;return{x:i,y:n}}),labels:e=>{let{datum:i}=e;return"".concat(i.x,": ").concat(i.y)},colorScale:n.map(e=>{let{color:i}=e;return i})})})}},3586:function(e,i,n){n.d(i,{j:()=>s});var l=n(24246),r=n(27378);let s=e=>{let{children:i}=e,[n,s]=r.useState(!1);return(0,l.jsx)(l.Fragment,{children:i(n,s)})}},24200:function(e,i,n){n.d(i,{G:()=>r});var l=n(24246);let r=e=>{let{vulnerability:i}=e;return(0,l.jsxs)("p",{children:[i.withdrawn&&(0,l.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},31373:function(e,i,n){n.d(i,{H:()=>u});var l=n(79192),r=n(53195),s=n(27378),t=n(7615),a=n(59015);let d=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,l._)({},c),fixed:(0,l._)({},c),not_affected:(0,l._)({},c),known_not_affected:(0,l._)({},c),under_investigation:(0,l._)({},c)}},u=e=>{let{pkg:i,isFetching:n,fetchError:c}=(0,a.ZA)(e);return{data:s.useMemo(()=>(e=>{let i=e.flatMap(e=>{var i;return(null!=(i=e.status)?i:[]).map(i=>{let n=(0,t.g)(i.average_severity);return{vulnerability:(0,r._)((0,l._)({},i.vulnerability),{average_severity:n,average_score:i.average_score}),vulnerabilityStatus:i.status,advisory:e}})}).reduce((e,i)=>{let n,s=e.find(e=>d(e,i));if(s)n=[...e.filter(e=>!d(e,s)),(0,r._)((0,l._)({},s),{relatedSboms:[...s.relatedSboms,{advisory:i.advisory}]})];else{let l={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedSboms:[{advisory:i.advisory}]};n=[...e.slice(),l]}return n},[]),n=i.reduce((e,i)=>{let n=i.vulnerabilityStatus,s=i.vulnerability.average_severity,t=e.vulnerabilityStatus[n];return Object.assign(e,{vulnerabilityStatus:(0,r._)((0,l._)({},e.vulnerabilityStatus),{[n]:{total:t.total+1,severities:(0,r._)((0,l._)({},t.severities),{[s]:t.severities[s]+1})}})})},(0,l._)({},o));return{vulnerabilities:i,summary:n}})((null==i?void 0:i.advisories)||[]),[i]),isFetching:n,fetchError:c}}},96308:function(e,i,n){n.d(i,{n:()=>c});var l=n(24246),r=n(11797),s=n(37818),t=n(42573),a=n(49304),d=n(31373);let c=e=>{let{packageId:i}=e,{data:n,isFetching:c,fetchError:o}=(0,d.H)(i);return(0,l.jsx)(s.u,{isFetching:c,fetchError:o,isFetchingState:(0,l.jsx)(r.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,l.jsx)(t.C,{error:e}),children:(0,l.jsx)(a.u,{severities:n.summary.vulnerabilityStatus.affected.severities})})}},41362:function(e,i,n){n.r(i),n.d(i,{default:()=>eD});var l=n(79192),r=n(53195),s=n(24246),t=n(27378),a=n(65783),d=n(45043),c=n(97339),o=n(18091),u=n(11192),h=n(32591),m=n(34747),x=n(46770),j=n(68802),p=n(70400),b=n(32939),v=n(24620),g=n(37961),f=n(69265),y=n(25138),_=n(2075),T=n(27090),S=n(75165),P=n(31762),k=n(99),B=n(59086),N=n(78700),C=n(12621),E=n(74502),M=n(27031),K=n(6348),Z=n(37818),O=n(15726),w=n(73227),F=n(43959),I=n(14935),D=n(65872),L=n(87727),V=n(3498),R=n(31757),A=n(87069),q=n(51527),G=n(30329),H=n(50689),U=n(67761),z=n(81391),W=n(81211),$=n(45882),Y=n(79551),J=n(32489),Q=n(90519),X=n(26235),ee=n(73827),ei=n(63706),en=n(66043);let el=e=>{let{sbom:i}=e,[n,l]=t.useState(!1),r=()=>{l(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(L.r,{hasGutter:!0,children:[(0,s.jsx)(V.P,{md:4,children:(0,s.jsxs)(R.Z,{isFullHeight:!0,children:[(0,s.jsx)(A.l,{children:"Metadata"}),(0,s.jsx)(q.e,{children:(0,s.jsxs)(G.o,{children:[(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Name"}),(0,s.jsx)(z.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Namespace"}),(0,s.jsx)(z.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Data License"}),(0,s.jsx)(z.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,s.jsx)(V.P,{md:4,children:(0,s.jsxs)(R.Z,{isFullHeight:!0,children:[(0,s.jsx)(A.l,{children:"Creation"}),(0,s.jsx)(q.e,{children:(0,s.jsxs)(G.o,{children:[(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Created"}),(0,s.jsx)(z.b,{"aria-label":"SBOM's creation date",children:(0,ei.p6)(i.published)})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Creator"}),(0,s.jsx)(z.b,{"aria-label":"SBOM's creator",children:i.suppliers})]})]})})]})}),(0,s.jsx)(V.P,{md:4,children:(0,s.jsxs)(R.Z,{isFullHeight:!0,children:[(0,s.jsx)(A.l,{children:"Statistics"}),(0,s.jsx)(q.e,{children:(0,s.jsxs)(G.o,{children:[(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Size"}),(0,s.jsx)(z.b,{children:(0,D.Z)(i.size)})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Packages"}),(0,s.jsx)(z.b,{children:i.number_of_packages})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsxs)(U.M,{children:["Labels ","",(0,s.jsx)(N.zx,{variant:N.Wu.link,size:"sm",icon:(0,s.jsx)(X.ZP,{}),iconPosition:"end",onClick:()=>l(!0),children:"Edit"})]}),(0,s.jsx)(z.b,{children:(0,s.jsx)(R.Z,{isCompact:!0,children:(0,s.jsx)(q.e,{children:i.labels&&(0,s.jsx)(ee.C,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,s.jsx)(V.P,{md:12,children:(0,s.jsxs)(R.Z,{isFullHeight:!0,children:[(0,s.jsx)(A.l,{children:"Package"}),(0,s.jsx)(q.e,{children:(0,s.jsxs)(G.o,{children:[(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Name"}),(0,s.jsx)(z.b,{children:i.name})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Version"}),(0,s.jsx)(z.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"External References"}),(0,s.jsx)(z.b,{children:(0,s.jsxs)(W.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,s.jsx)($.H,{children:e},e)),i.described_by.flatMap(e=>e.purl).map(e=>(0,s.jsx)($.H,{children:e.purl},e.uuid))]})})]})]})})]})})]}),(0,s.jsxs)(Y.u,{isOpen:n,variant:"medium",onClose:r,children:[(0,s.jsx)(J.x,{title:"Edit labels"}),(0,s.jsx)(Q.f,{children:(0,s.jsx)(en._,{sbom:i,onClose:r})})]})]})};var er=n(46403),es=n(70715),et=n(40982),ea=n(89226),ed=n(62997),ec=n(4835),eo=n(14350),eu=n(11165),eh=n(89330),em=n(31423),ex=n(94154),ej=n(67447),ep=n(14629),eb=n(3804),ev=n(31336),eg=n(49988),ef=n(59015),ey=n(96308);let e_=(e,i)=>i.reduce((e,i)=>{let{license_id:n,license_name:l}=i;return e.replaceAll(n,l)},"".concat(e)),eT=e=>{let{sbomId:i}=e,{licenseIds:n}=(0,F.qi)(i),t=(0,eg.vZ)({tableName:"package-table",columnNames:{name:"Name",version:"Version",vulnerabilities:"Vulnerabilities",licenses:"Licenses",purls:"PURLs",cpes:"CPEs"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:E.L4,title:"Filter text",placeholderText:"Search",type:ep.vA.search},{categoryKey:"license",title:"License",placeholderText:"Filter results by license",type:ep.vA.multiselect,operator:"~",logicOperator:"OR",selectOptions:n.map(e=>({value:e.license_id,label:e.license_name}))}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:d,total:c},isFetching:o,fetchError:u}=(0,ef.D4)(i,(0,eg.QO)((0,r._)((0,l._)({},t),{hubSortFieldKeys:{name:"name"}}))),h=(0,eg.KC)((0,r._)((0,l._)({},t),{idProperty:"id",currentPageItems:d,totalItemCount:c,isLoading:o})),{currentPageItems:m,numRenderedColumns:x,propHelpers:{toolbarProps:j,filterToolbarProps:b,paginationToolbarItemProps:v,paginationProps:g,tableProps:f,getThProps:y,getTrProps:_,getTdProps:T,getExpandedContentTdProps:S},expansionDerivedState:{isCellExpanded:P}}=h;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es.o,(0,r._)((0,l._)({},j),{"aria-label":"Package toolbar",children:(0,s.jsxs)(et.c,{children:[(0,s.jsx)(ep.Ki,(0,l._)({},b)),(0,s.jsx)(ea.E,(0,r._)((0,l._)({},v),{children:(0,s.jsx)(eb.p,{idPrefix:"package-table",isTop:!0,paginationProps:g})}))]})})),(0,s.jsxs)(ec.i,(0,r._)((0,l._)({},f),{"aria-label":"Package table",children:[(0,s.jsx)(eo.h,{children:(0,s.jsx)(eu.Tr,{children:(0,s.jsxs)(ev.qK,(0,r._)((0,l._)({},h),{children:[(0,s.jsx)(eh.Th,(0,l._)({},y({columnKey:"name"}))),(0,s.jsx)(eh.Th,(0,l._)({},y({columnKey:"version"}))),(0,s.jsx)(eh.Th,(0,l._)({},y({columnKey:"vulnerabilities"}))),(0,s.jsx)(eh.Th,(0,l._)({},y({columnKey:"licenses"}))),(0,s.jsx)(eh.Th,(0,l._)({},y({columnKey:"purls"}))),(0,s.jsx)(eh.Th,(0,l._)({},y({columnKey:"cpes"})))]}))})}),(0,s.jsx)(ev.hp,{isLoading:o,isError:!!u,isNoData:0===c,numRenderedColumns:x,children:null==m?void 0:m.map((e,i)=>(0,s.jsxs)(em.p,{isExpanded:P(e),children:[(0,s.jsx)(eu.Tr,(0,r._)((0,l._)({},_({item:e})),{children:(0,s.jsxs)(ev.Cx,(0,r._)((0,l._)({},h),{item:e,rowIndex:i,children:[(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:15},T({columnKey:"name"})),{children:[e.name,e.group].filter(Boolean).join("/")})),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:15,modifier:"truncate"},T({columnKey:"version"})),{children:null==e?void 0:e.version})),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:10,modifier:"breakWord"},T({columnKey:"vulnerabilities"})),{children:e.purl[0]&&(0,s.jsx)(ey.n,{packageId:e.purl[0].uuid})})),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:20,modifier:"breakWord"},T({columnKey:"licenses",isCompoundExpandToggle:e.licenses.length>1,item:e,rowIndex:i})),{children:1===e.licenses.length?e_(e.licenses[0].license_name,e.licenses_ref_mapping):"".concat(e.licenses.length," Licenses")})),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:20,modifier:"breakWord"},T({columnKey:"purls",isCompoundExpandToggle:e.purl.length>1,item:e,rowIndex:i})),{children:1===e.purl.length?(0,s.jsx)(a.rU,{to:(0,er.Gn)(M.nB.packageDetails,{packageId:e.purl[0].uuid}),children:e.purl[0].purl}):"".concat(e.purl.length," PURLs")})),(0,s.jsxs)(ex.Td,(0,r._)((0,l._)({width:20,modifier:"breakWord"},T({columnKey:"cpes",isCompoundExpandToggle:e.cpe.length>0,item:e,rowIndex:i})),{children:[e.cpe.length," CPEs"]}))]}))})),P(e)?(0,s.jsx)(eu.Tr,{isExpanded:!0,children:(0,s.jsx)(ex.Td,(0,r._)((0,l._)({},S({item:e})),{className:ed.Z.pLg,children:(0,s.jsx)(ej.G,{children:(0,s.jsxs)("div",{className:ed.Z.ptLg,children:[P(e,"licenses")?(0,s.jsx)(W.aV,{isPlain:!0,children:e.licenses.map(i=>(0,s.jsxs)($.H,{children:[e_(i.license_name,e.licenses_ref_mapping)," ",(0,s.jsx)(p._,{isCompact:!0,children:i.license_type})]},"".concat(i.license_name,"-").concat(i.license_type)))}):null,P(e,"purls")?(0,s.jsx)(W.aV,{isPlain:!0,children:e.purl.map(e=>(0,s.jsx)($.H,{children:(0,s.jsx)(a.rU,{to:(0,er.Gn)(M.nB.packageDetails,{packageId:e.uuid}),children:e.purl})},e.uuid))}):null,P(e,"cpes")?(0,s.jsx)(W.aV,{isPlain:!0,children:e.cpe.map(e=>(0,s.jsx)($.H,{children:e},e))}):null]})})}))}):null]},e.id))})]})),(0,s.jsx)(eb.p,{idPrefix:"package-table",isTop:!1,paginationProps:g})]})};var eS=n(27693),eP=n.n(eS),ek=n(27317),eB=n(93095),eN=n(9905),eC=n(7615),eE=n(69876),eM=n(68057),eK=n(57524),eZ=n(3586),eO=n(24200),ew=n(82413),eF=n(41135);let eI=e=>{let{sbomId:i}=e,{sbom:n,isFetching:d,fetchError:c}=(0,F.p4)(i),{data:{vulnerabilities:o,summary:u},isFetching:h,fetchError:m}=(0,ew.Ap)(i),x=t.useMemo(()=>o.filter(e=>"affected"===e.vulnerabilityStatus),[o]),j=t.useMemo(()=>x.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return(0,r._)((0,l._)({},e),{summary:{totalPackages:i.length,allPackages:i}})}),[x]),p=(0,eF.T)(j,e=>"".concat(e.vulnerability.identifier,"-").concat(e.vulnerabilityStatus)),b=(0,eg.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:p,isLoading:h,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>{var i,n;return{id:e.vulnerability.identifier,cvss:e.vulnerability.average_score,affectedDependencies:e.summary.totalPackages,published:(null==(i=e.vulnerability)?void 0:i.published)?eP()(e.vulnerability.published).valueOf():0,updated:(null==(n=e.vulnerability)?void 0:n.modified)?eP()(e.vulnerability.modified).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:v,numRenderedColumns:g,propHelpers:{toolbarProps:f,paginationToolbarItemProps:y,paginationProps:_,tableProps:T,getThProps:S,getTrProps:P,getTdProps:k,getExpandedContentTdProps:B},expansionDerivedState:{isCellExpanded:N}}=b;return(0,s.jsxs)(ek.K,{hasGutter:!0,children:[(0,s.jsx)(eB.v,{children:(0,s.jsx)(R.Z,{children:(0,s.jsx)(q.e,{children:(0,s.jsx)(Z.u,{isFetching:d||h,fetchError:c,children:(0,s.jsxs)(L.r,{hasGutter:!0,children:[(0,s.jsx)(V.P,{md:6,children:(0,s.jsx)(eM.V,{vulnerabilitiesSummary:u.vulnerabilityStatus.affected})}),(0,s.jsx)(V.P,{md:6,children:(0,s.jsxs)(G.o,{children:[(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Name"}),(0,s.jsx)(z.b,{children:null==n?void 0:n.name})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Version"}),(0,s.jsx)(z.b,{children:null==n?void 0:n.described_by.map(e=>e.version).join(", ")})]}),(0,s.jsxs)(H.g,{children:[(0,s.jsx)(U.M,{children:"Creation date"}),(0,s.jsx)(z.b,{children:(0,ei.p6)(null==n?void 0:n.published)})]})]})})]})})})})}),(0,s.jsxs)(eB.v,{children:[(0,s.jsx)(es.o,(0,r._)((0,l._)({},f),{children:(0,s.jsx)(et.c,{children:(0,s.jsx)(ea.E,(0,r._)((0,l._)({},y),{children:(0,s.jsx)(eb.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:_})}))})})),(0,s.jsxs)(ec.i,(0,r._)((0,l._)({},T),{"aria-label":"Vulnerability table",children:[(0,s.jsx)(eo.h,{children:(0,s.jsx)(eu.Tr,{children:(0,s.jsxs)(ev.qK,(0,r._)((0,l._)({},b),{children:[(0,s.jsx)(eh.Th,(0,l._)({},S({columnKey:"id"}))),(0,s.jsx)(eh.Th,(0,l._)({},S({columnKey:"description"}))),(0,s.jsx)(eh.Th,(0,l._)({},S({columnKey:"cvss"}))),(0,s.jsx)(eh.Th,(0,l._)({},S({columnKey:"affectedDependencies"}))),(0,s.jsx)(eh.Th,(0,l._)({},S({columnKey:"published"}))),(0,s.jsx)(eh.Th,(0,l._)({},S({columnKey:"updated"})))]}))})}),(0,s.jsx)(ev.hp,{isLoading:h,isError:!!m,isNoData:0===p.length,numRenderedColumns:g,children:null==v?void 0:v.map((e,i)=>{var n,t;return(0,s.jsxs)(em.p,{isExpanded:N(e),children:[(0,s.jsx)(eu.Tr,(0,r._)((0,l._)({},P({item:e})),{children:(0,s.jsxs)(ev.Cx,(0,r._)((0,l._)({},b),{item:e,rowIndex:i,children:[(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:15,modifier:"breakWord"},k({columnKey:"id"})),{children:(0,s.jsx)(a.rU,{to:(0,er.Gn)(M.nB.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,s.jsx)(eZ.j,{children:(i,n)=>(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:35,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},k({columnKey:"description"})),{children:(0,s.jsx)(eN.cE,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,s.jsx)(eO.G,{vulnerability:e.vulnerability})})}))}),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:10},k({columnKey:"cvss"})),{children:(0,s.jsx)(eK.o,{value:(0,eC.g)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})})),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:15,modifier:"truncate"},k({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i})),{children:e.summary.totalPackages})),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},k({columnKey:"published"})),{children:(0,ei.p6)(null==(n=e.vulnerability)?void 0:n.published)})),(0,s.jsx)(ex.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},k({columnKey:"updated"})),{children:(0,ei.p6)(null==(t=e.vulnerability)?void 0:t.modified)}))]}))})),N(e)?(0,s.jsx)(eu.Tr,{isExpanded:!0,children:(0,s.jsx)(ex.Td,(0,r._)((0,l._)({},B({item:e})),{children:(0,s.jsx)(ej.G,{children:N(e,"affectedDependencies")?(0,s.jsxs)(ec.i,{variant:"compact",children:[(0,s.jsx)(eo.h,{children:(0,s.jsxs)(eu.Tr,{children:[(0,s.jsx)(eh.Th,{children:"Type"}),(0,s.jsx)(eh.Th,{children:"Namespace"}),(0,s.jsx)(eh.Th,{children:"Name"}),(0,s.jsx)(eh.Th,{children:"Version"}),(0,s.jsx)(eh.Th,{children:"Path"}),(0,s.jsx)(eh.Th,{children:"Qualifiers"})]})}),(0,s.jsx)(em.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,ei.qX)(e.purlSummary.purl);return(0,s.jsxs)(eu.Tr,{children:[(0,s.jsx)(ex.Td,{children:null==i?void 0:i.type}),(0,s.jsx)(ex.Td,{children:null==i?void 0:i.namespace}),(0,s.jsx)(ex.Td,{children:(0,s.jsx)(a.rU,{to:(0,er.Gn)(M.nB.packageDetails,{packageId:e.purlSummary.uuid}),children:null==i?void 0:i.name})}),(0,s.jsx)(ex.Td,{children:null==i?void 0:i.version}),(0,s.jsx)(ex.Td,{children:null==i?void 0:i.path}),(0,s.jsx)(ex.Td,{children:(null==i?void 0:i.qualifiers)&&(0,s.jsx)(eE.D,{value:null==i?void 0:i.qualifiers})})]},e.purlSummary.uuid)}return(0,s.jsxs)(eu.Tr,{children:[(0,s.jsx)(ex.Td,{}),(0,s.jsx)(ex.Td,{}),(0,s.jsx)(ex.Td,{children:e.parentName}),(0,s.jsx)(ex.Td,{}),(0,s.jsx)(ex.Td,{}),(0,s.jsx)(ex.Td,{})]},"".concat(e.parentName,"-").concat(i,"-name"))})})]}):null})}))}):null]},e._ui_unique_id)})})]})),(0,s.jsx)(eb.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:_})]})]})},eD=()=>{var e,i;let n=(0,I.s0)(),{pushNotification:D}=t.useContext(O.c),L=(0,M.ZX)(M.Uo.SBOM_ID),{sbom:V,isFetching:R,fetchError:A}=(0,F.p4)(L),[q,G]=t.useState(!1),H=()=>{G(!q)},{downloadSBOM:U,downloadSBOMLicenses:z}=(0,w.i)(),[W,$]=t.useState(!1),{mutate:Y,isPending:J}=(0,F.s5)(e=>{$(!1),D({title:(0,E.zp)(e),variant:"success"}),n("/sboms")},e=>{D({title:(0,E.BX)(e),variant:"danger"})}),[Q,X]=t.useState(0),ee=t.createRef(),ei=t.createRef(),en=t.createRef(),er=t.createRef();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.NP,{type:"breadcrumb",children:(0,s.jsxs)(c.a,{children:[(0,s.jsx)(o.g,{children:(0,s.jsx)(a.rU,{to:M.nB.sboms,children:"SBOMs"})}),(0,s.jsx)(o.g,{isActive:!0,children:"SBOM details"})]})}),(0,s.jsx)(d.NP,{children:(0,s.jsxs)(u.P,{children:[(0,s.jsx)(h.J,{isFilled:!0,children:(0,s.jsxs)(m.k,{children:[(0,s.jsx)(x.B,{spacer:{default:"spacerSm"},children:(0,s.jsx)(j.V,{children:(0,s.jsx)(j.V,{component:"h1",children:null!=(i=null!=(e=null==V?void 0:V.name)?e:L)?i:""})})}),(0,s.jsx)(x.B,{children:(null==V?void 0:V.labels.type)&&(0,s.jsx)(p._,{color:"blue",children:null==V?void 0:V.labels.type})})]})}),(0,s.jsx)(h.J,{children:V&&(0,s.jsx)(b.L,{isOpen:q,onSelect:()=>G(!1),onOpenChange:e=>G(e),popperProps:{position:"right"},toggle:e=>(0,s.jsx)(v.O_,{ref:e,onClick:H,isExpanded:q,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,s.jsxs)(g.s,{children:[(0,s.jsx)(f.h,{onClick:()=>{L&&U(L,(null==V?void 0:V.name)?"".concat(null==V?void 0:V.name,".json"):"".concat(L,".json"))},children:"Download SBOM"},"sbom"),(0,s.jsx)(f.h,{onClick:()=>{L&&z(L)},children:"Download License Report"},"license"),(0,s.jsx)(y.i,{component:"li"},"separator"),(0,s.jsx)(f.h,{onClick:()=>$(!0),children:"Delete"},"delete")]})})})]})}),(0,s.jsx)(d.NP,{children:(0,s.jsxs)(_.m,{mountOnEnter:!0,activeKey:Q,onSelect:(e,i)=>{X(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,s.jsx)(T.O,{eventKey:0,title:(0,s.jsx)(S.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:ee}),(0,s.jsx)(T.O,{eventKey:1,title:(0,s.jsx)(S.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:ei}),(0,s.jsx)(T.O,{eventKey:2,title:(0,s.jsx)(S.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:en,actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.b,{ref:er,children:(0,s.jsx)(C.ZP,{})}),(0,s.jsx)(k.J,{triggerRef:er,bodyContent:(0,s.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,s.jsxs)(d.NP,{children:[(0,s.jsx)(B.I,{eventKey:0,id:"refTabInfoSection",ref:ee,"aria-label":"Information of the SBOM",children:(0,s.jsx)(Z.u,{isFetching:R,fetchError:A,children:V&&(0,s.jsx)(el,{sbom:V})})}),(0,s.jsx)(B.I,{eventKey:1,id:"refTabPackagesSection",ref:ei,"aria-label":"Packages within the SBOM",hidden:!0,children:L&&(0,s.jsx)(eT,{sbomId:L})}),(0,s.jsx)(B.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:en,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:L&&(0,s.jsx)(eI,{sbomId:L})})]}),(0,s.jsx)(K.Q,(0,r._)((0,l._)({},(0,E.KU)(V)),{inProgress:J,titleIconVariant:"warning",isOpen:W,confirmBtnVariant:N.Wu.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>$(!1),onClose:()=>$(!1),onConfirm:()=>{V&&Y(V.id)}}))]})}},59015:function(e,i,n){n.d(i,{D4:()=>u,ZA:()=>o,fF:()=>c});var l=n(79192),r=n(1183),s=n(50576),t=n(40371),a=n(49988);let d="packages",c=function(){var e,i,n;let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:h,error:m,refetch:x}=(0,r.a)({queryKey:[d,c],queryFn:()=>(0,t.tj)({client:s.L,query:(0,l._)({},(0,a.rm)(c))}),enabled:!o});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(n=null==u||null==(i=u.data)?void 0:i.total)?n:0,params:c},isFetching:h,fetchError:m,refetch:x}},o=e=>{let{data:i,isLoading:n,error:l}=(0,r.a)({queryKey:[d,e],queryFn:()=>(0,t.BK)({client:s.L,path:{key:e}})});return{pkg:null==i?void 0:i.data,isFetching:n,fetchError:l}},u=function(e){var i,n,c;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u,isLoading:h,error:m,refetch:x}=(0,r.a)({queryKey:[d,"by-sbom",e,o],queryFn:()=>(0,t.Pg)({client:s.L,path:{id:e},query:(0,l._)({},(0,a.rm)(o))})});return{result:{data:(null==u||null==(i=u.data)?void 0:i.items)||[],total:null!=(c=null==u||null==(n=u.data)?void 0:n.total)?c:0,params:o},isFetching:h,fetchError:m,refetch:x}}},41135:function(e,i,n){n.d(i,{T:()=>a});var l=n(79192),r=n(53195),s=n(27378),t=n(74502);let a=(e,i)=>(0,s.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,r._)((0,l._)({},e),{[t.nM]:i(e)})):[],[e,i])},40269:function(e,i,n){n.d(i,{Z:()=>l});let l={list:"pf-v6-c-list",listItem:"pf-v6-c-list__item",listItemIcon:"pf-v6-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},65872:function(e,i,n){n.d(i,{Z:()=>d});let l=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],s=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],t=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,n)=>{let l=e;return"string"==typeof i||Array.isArray(i)?l=e.toLocaleString(i,n):(!0===i||void 0!==n)&&(l=e.toLocaleString(void 0,n)),l};function d(e,i){let n;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?t:s:i.binary?r:l,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(n={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(n={maximumFractionDigits:i.maximumFractionDigits,...n}),e<1)return u+a(e,i.locale,n)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,n||(e=e.toPrecision(3)),u+a(Number(e),i.locale,n)+c+d[h]}}}]);