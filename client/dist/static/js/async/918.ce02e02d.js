"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["918"],{87017:function(e,a,t){t.d(a,{Co:()=>y,Cu:()=>u,Hb:()=>p,y:()=>h});var r=t(79192),l=t(53195),s=t(70233),n=t(74502);t(41947);let o="/api",i="".concat(o,"/v2/advisory"),d="".concat(o,"/v2/sbom"),c=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},u=(e,a)=>{let t=e.get(n.TB);return s.Z.post("".concat(i),t,(0,l._)((0,r._)({},a),{headers:{"Content-Type":c(t)}}))},p=(e,a)=>{let t=e.get(n.TB);return s.Z.post("".concat(d),t,(0,l._)((0,r._)({},a),{headers:{"Content-Type":c(t)}}))},h=(e,a)=>{let t=e.get(n.TB);return s.Z.post("/api/v2/ui/extract-sbom-purls",t,(0,l._)((0,r._)({},a),{headers:{"Content-Type":c(t)}}))},y=e=>s.Z.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},46001:function(e,a,t){t.d(a,{B:()=>x});var r=t(24246),l=t(27378),s=t(51851),n=t(21714),o=t(68924),i=t(23056),d=t(91057),c=t(84335),u=t(13754),p=t(79551),h=t(32489),y=t(90519),f=t(81211),g=t(45882),v=t(22621),m=t(416);let x=e=>{let{uploads:a,handleUpload:t,handleRemoveUpload:x,extractSuccessMessage:_,extractErrorMessage:j}=e,[F,q]=l.useState(!1),[b,U]=l.useState("inProgress"),[w,T]=l.useState([]);!F&&a.size>0&&q(!0),l.useEffect(()=>{let e=Array.from(a.values());e.some(e=>"inProgress"===e.status)?U("inProgress"):e.every(e=>"complete"===e.status)?U("success"):U("danger")},[a]);let P=Array.from(a.values()).filter(e=>e.response).length;return(0,r.jsxs)(s.o,{onFileDrop:(e,a)=>{t(a)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{T(e)},useFsAccessApi:!1},children:[(0,r.jsx)(n.Y,{titleIcon:(0,r.jsx)(m.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),F&&(0,r.jsx)(o.M,{statusToggleText:"".concat(P," of ").concat(a.size," files uploaded"),statusToggleIcon:b,children:Array.from(a.entries()).map((e,a)=>{let[t,l]=e;return(0,r.jsx)(i.B,{customFileHandler:()=>{},fileIcon:(0,r.jsx)(v.ZP,{}),file:t,onClearClick:()=>(e=>{for(let a of e)x(a)})([t]),progressValue:l.progress,progressVariant:l.error?"danger":l.response?"success":void 0,progressHelperText:l.error?(0,r.jsx)(d.p,{isLiveRegion:!0,children:(0,r.jsx)(c.u,{variant:"error",children:j(l.error)})}):100!==l.progress||l.response?l.response?(0,r.jsx)(d.p,{isLiveRegion:!0,children:(0,r.jsx)(c.u,{variant:"default",children:_(l.response)})}):void 0:(0,r.jsx)(d.p,{isLiveRegion:!0,children:(0,r.jsxs)(c.u,{variant:"warning",children:[(0,r.jsx)(u.$,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},"".concat(t.name,"-").concat(a))})}),(0,r.jsxs)(p.u,{isOpen:w.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>T([]),variant:"small",children:[(0,r.jsx)(h.x,{title:"Unsupported files",titleIconVariant:"warning"}),(0,r.jsx)(y.f,{children:(0,r.jsx)(f.aV,{children:w.map(e=>(0,r.jsx)(g.H,{children:e.file.name},e.file.name))})})]})]})}},95169:function(e,a,t){t.d(a,{V:()=>u});var r=t(79192),l=t(53195),s=t(27378),n=t(74502),o=t(70233);let i="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,a)=>{switch(a.type){case"queueUpload":return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{status:"queued",cancelFn:a.payload.cancelFn}))});case"updateUploadProgress":return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{progress:a.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",response:a.payload.response}))});case"finishUploadWithError":var t;return(0,l._)((0,r._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,l._)((0,r._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",error:a.payload.error,wasCancelled:(null==(t=a.payload.error)?void 0:t.message)===i}))});case"removeUpload":{let t=new Map(e.uploads);return t.delete(a.payload.file),(0,l._)((0,r._)({},e),{uploads:t})}default:throw Error()}},u=e=>{let{parallel:a,uploadFn:t,onSuccess:r,onError:l}=e,[d,u]=s.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let s=[];for(let a=0;a<e.length;a++){let t=e[a],d=new FormData;d.set(n.TB,t);let c=o.Z.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var a;let r=null!=(a=e.total)?a:1;u({type:"updateUploadProgress",payload:{file:t,progress:Math.round(e.loaded/r*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:t,cancelFn:c}});let h={formData:d,config:p,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),r&&r(e,t)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==i&&l&&l(e,t)}};s.push(h)}if(a)for(let e of s)t(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else s.reduce(async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var a,t;null==(t=d.uploads.get(e))||null==(a=t.cancelFn)||a.cancel(i)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},72077:function(e,a,t){t.r(a),t.d(a,{default:()=>p});var r=t(24246),l=t(65783),s=t(45043),n=t(97339),o=t(18091),i=t(68802),d=t(46001),c=t(43959),u=t(9839);let p=()=>{let{uploads:e,handleUpload:a,handleRemoveUpload:t}=(0,c.km)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.NP,{type:"breadcrumb",children:(0,r.jsxs)(n.a,{children:[(0,r.jsx)(o.g,{children:(0,r.jsx)(l.rU,{to:u.nB.sboms,children:"SBOMs"})}),(0,r.jsx)(o.g,{isActive:!0,children:"Upload SBOM"})]})}),(0,r.jsx)(s.NP,{children:(0,r.jsxs)(i.V,{children:[(0,r.jsx)(i.V,{component:"h1",children:"Upload SBOM"}),(0,r.jsx)(i.V,{component:"p",children:"Upload a Software Bill of Materials (SBOM) document. We accept CycloneDX versions 1.3, 1.4, 1.5 and 1.6, and System Package Data Exchange (SPDX) versions 2.2, and 2.3."})]})}),(0,r.jsx)(s.NP,{children:(0,r.jsx)(d.B,{uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var a;return(null==(a=e.response)?void 0:a.data)?e.message:"Error while uploading file"}})})]})}},43959:function(e,a,t){t.d(a,{Fz:()=>m,KQ:()=>b,Oh:()=>q,i5:()=>v,km:()=>j,p4:()=>x,qi:()=>w,s5:()=>_,t9:()=>F,uz:()=>U});var r=t(79192),l=t(53195),s=t(70186),n=t(1183),o=t(24038),i=t(68e3),d=t(75503),c=t(16072),u=t(50576),p=t(40371),h=t(95169),y=t(87017),f=t(49988);let g="sboms",v=e=>{let{data:a,isLoading:t,error:r,refetch:l}=(0,n.a)({queryKey:[g,"labels",e],queryFn:()=>(0,p.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:o.Wk});return{labels:(null==a?void 0:a.data)||[],isFetching:t,fetchError:r,refetch:l}},m=function(){var e,a,t;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,f.rm)(o),{q:h}=c,y=(0,s._)(c,["q"]),v=(0,f.Rb)(i),{data:m,isLoading:x,error:_,refetch:j}=(0,n.a)({queryKey:[g,o,v],queryFn:()=>(0,p.Wp)({client:u.L,query:(0,l._)((0,r._)({},y),{q:[h,v].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(t=null==m||null==(a=m.data)?void 0:a.total)?t:0,params:o},isFetching:x,fetchError:_,refetch:j}},x=e=>{let{data:a,isLoading:t,error:r}=(0,n.a)({queryKey:[g,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,p._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==a?void 0:a.data,isFetching:t,fetchError:r}},_=(e,a)=>{let t=(0,i.NL)();return(0,d.D)({mutationFn:async e=>(await (0,p.WX)({client:u.L,path:{id:e}})).data,onSuccess:async(a,r)=>{e(a,r),await t.invalidateQueries({queryKey:[g]})},onError:async e=>{a(e),await t.invalidateQueries({queryKey:[g]})}})},j=()=>{let e=(0,i.NL)();return(0,h.V)({parallel:!0,uploadFn:(e,a)=>(0,y.Hb)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[g]})}})},F=(e,a)=>{let t=(0,i.NL)();return(0,d.D)({mutationFn:e=>(0,p.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await t.invalidateQueries({queryKey:[g]})},onError:a})},q=function(e){var a,t,l;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:o,isLoading:i,error:d,refetch:c}=(0,n.a)({queryKey:[g,"by-package",e,s],queryFn:()=>(0,p.DU)({client:u.L,query:(0,r._)({purl:e},(0,f.rm)(s))})});return{result:{data:(null==o||null==(a=o.data)?void 0:a.items)||[],total:null!=(l=null==o||null==(t=o.data)?void 0:t.total)?l:0,params:s},isFetching:i,fetchError:d,refetch:c}},b=e=>{let{data:a,isLoading:t,error:r}=(0,n.a)({queryKey:[g,e,"advisory"],queryFn:()=>(0,p.NU)({client:u.L,path:{id:e}})});return{advisories:(null==a?void 0:a.data)||[],isFetching:t,fetchError:r}},U=e=>{let a=(0,c.h)({queries:e.map(e=>({queryKey:[g,e,"advisory"],queryFn:()=>(0,p.NU)({client:u.L,path:{id:e}})}))});return{advisories:a.map(e=>{let{data:a}=e;return(null==a?void 0:a.data)||[]}),isFetching:a.some(e=>{let{isLoading:a}=e;return a}),fetchError:a.map(e=>{let{error:a}=e;return a})}},w=e=>{let{data:a,isLoading:t,error:r}=(0,n.a)({queryKey:[g,e,"license-ids"],queryFn:()=>(0,p.J4)({client:u.L,path:{id:e}})});return{licenseIds:(null==a?void 0:a.data)||[],isFetching:t,fetchError:r}}}}]);