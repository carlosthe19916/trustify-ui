"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["343"],{3586:function(e,t,i){i.d(t,{j:()=>s});var r=i(24246),l=i(27378);let s=e=>{let{children:t}=e,[i,s]=l.useState(!1);return(0,r.jsx)(r.Fragment,{children:t(i,s)})}},24200:function(e,t,i){i.d(t,{G:()=>l});var r=i(24246);let l=e=>{let{vulnerability:t}=e;return(0,r.jsxs)("p",{children:[t.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},51144:function(e,t,i){i.d(t,{s:()=>d});var r=i(79192),l=i(53195),s=i(27378),a=i(78176);let n=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,o={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},d=e=>{let{vulnerability:t,isFetching:i,fetchError:d}=(0,a.p6)(e);return{data:s.useMemo(()=>(e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.sboms)?t:[]).flatMap(t=>Object.entries(t.purl_statuses||{}).map(i=>{let[l,s]=i;return{sbom:(0,r._)({},t),sbomStatus:l,advisory:e,packages:s}}))}).reduce((e,t)=>{let i,s=e.find(e=>n(e,t));if(s)i=[...e.filter(e=>!n(e,s)),(0,l._)((0,r._)({},s),{relatedPackages:[...s.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let r={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};i=[...e.slice(),r]}return i},[]),i=t.reduce((e,t)=>{let i=t.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:(0,l._)((0,r._)({},e.sbomStatus),{[i]:e.sbomStatus[i]+1})})},(0,r._)({},o));return{sboms:t,summary:i}})((null==t?void 0:t.advisories)||[]),[t]),isFetching:i,fetchError:d}}},27722:function(e,t,i){i.d(t,{P:()=>c,W:()=>h});var r=i(79192),l=i(53195),s=i(24246),a=i(27378),n=i(74502),o=i(14629),d=i(49988),u=i(78176);let c=a.createContext({}),h=e=>{let{children:t}=e,i=(0,d.vZ)({tableName:"vulnerability",persistenceKeyPrefix:n.yq.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Impacted SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","published","severity"],initialSort:{columnKey:"published",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:n.L4,title:"Filter text",placeholderText:"Search",type:o.vA.search},{categoryKey:"base_severity",title:"CVSS",placeholderText:"CVSS",type:o.vA.multiselect,selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:o.vA.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:a,total:h},isFetching:b,fetchError:m}=(0,u.fd)((0,d.QO)((0,l._)((0,r._)({},i),{hubSortFieldKeys:{identifier:"id",severity:"base_score",published:"published"}}))),p=(0,d.KC)((0,l._)((0,r._)({},i),{idProperty:"identifier",currentPageItems:a,totalItemCount:h,isLoading:b}));return(0,s.jsx)(c.Provider,{value:{totalItemCount:h,isFetching:b,fetchError:m,tableControls:p},children:t})}},96138:function(e,t,i){i.d(t,{u:()=>k});var r=i(79192),l=i(53195),s=i(24246),a=i(27378),n=i(65783),o=i(46403),d=i(4835),u=i(14350),c=i(11165),h=i(89330),b=i(31423),m=i(94154),p=i(9905),y=i(7615),f=i(57524),v=i(3804),x=i(31336),_=i(24200),j=i(9839),g=i(63706),S=i(3586),K=i(11797),w=i(37818),T=i(42573),C=i(51144);let P=e=>{let{vulnerabilityId:t}=e,{data:i,isFetching:r,fetchError:l}=(0,C.s)(t);return(0,s.jsx)(w.u,{isFetching:r,fetchError:l,isFetchingState:(0,s.jsx)(K.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,s.jsx)(T.C,{error:e}),children:i.summary.sbomStatus.affected})};var E=i(27722);let k=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:K}=a.useContext(E.P),{numRenderedColumns:w,currentPageItems:T,propHelpers:{paginationProps:C,tableProps:k,getThProps:F,getTrProps:q,getTdProps:L}}=K;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(d.i,(0,l._)((0,r._)({},k),{"aria-label":"Vulnerability table",children:[(0,s.jsx)(u.h,{children:(0,s.jsx)(c.Tr,{children:(0,s.jsxs)(x.qK,(0,l._)((0,r._)({},K),{children:[(0,s.jsx)(h.Th,(0,r._)({},F({columnKey:"identifier"}))),(0,s.jsx)(h.Th,(0,r._)({},F({columnKey:"title"}))),(0,s.jsx)(h.Th,(0,l._)((0,r._)({},F({columnKey:"severity"})),{info:{tooltip:"The Common Vulnerability Scoring System measuring the severity of security flaws."}})),(0,s.jsx)(h.Th,(0,r._)({},F({columnKey:"published"}))),(0,s.jsx)(h.Th,(0,r._)({},F({columnKey:"sboms"})))]}))})}),(0,s.jsx)(x.hp,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:w,children:T.map((e,t)=>(0,s.jsx)(b.p,{children:(0,s.jsx)(c.Tr,(0,l._)((0,r._)({},q({item:e})),{children:(0,s.jsxs)(x.Cx,(0,l._)((0,r._)({},K),{item:e,rowIndex:t,children:[(0,s.jsx)(m.Td,(0,l._)((0,r._)({width:15,modifier:"breakWord"},L({columnKey:"identifier",item:e,rowIndex:t})),{children:(0,s.jsx)(n.OL,{to:(0,o.Gn)(j.nB.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,s.jsx)(S.j,{children:(t,i)=>(0,s.jsx)(m.Td,(0,l._)((0,r._)({width:45,modifier:"truncate",onFocus:()=>i(!0),onBlur:()=>i(!1),tabIndex:0},L({columnKey:"title"})),{children:(0,s.jsx)(p.cE,{focused:t,wrapModifier:"truncate",children:(0,s.jsx)(_.G,{vulnerability:e})})}))}),(0,s.jsx)(m.Td,(0,l._)((0,r._)({width:10},L({columnKey:"severity"})),{children:(0,s.jsx)(f.o,{value:(0,y.g)(e.average_severity),score:e.average_score,showLabel:!0,showScore:!0})})),(0,s.jsx)(m.Td,(0,l._)((0,r._)({width:10},L({columnKey:"published"})),{children:(0,g.p6)(e.published)})),(0,s.jsx)(m.Td,(0,l._)((0,r._)({width:10},L({columnKey:"sboms",item:e,rowIndex:t})),{children:(0,s.jsx)(P,{vulnerabilityId:e.identifier})}))]}))}))},e.identifier))})]})),(0,s.jsx)(v.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:C})]})}},27970:function(e,t,i){i.d(t,{R:()=>b});var r=i(79192),l=i(53195),s=i(24246),a=i(27378),n=i(70715),o=i(40982),d=i(89226),u=i(14629),c=i(3804),h=i(27722);let b=e=>{let{showFilters:t}=e,{tableControls:i}=a.useContext(h.P),{propHelpers:{toolbarProps:b,filterToolbarProps:m,paginationToolbarItemProps:p,paginationProps:y}}=i;return(0,s.jsx)(n.o,(0,l._)((0,r._)({},b),{"aria-label":"vulnerability-toolbar",children:(0,s.jsxs)(o.c,{children:[t&&(0,s.jsx)(u.Ki,(0,r._)({},m)),(0,s.jsx)(d.E,(0,l._)((0,r._)({},p),{children:(0,s.jsx)(c.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:y})}))]})}))}},78176:function(e,t,i){i.d(t,{fd:()=>b,DK:()=>m,p6:()=>p});var r=i(79192),l=i(1183),s=i(16072),a=i(50576),n=i(40371),o=i(74502),d=i(98726),u=i(49988);let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return new Promise((r,l)=>{setTimeout(()=>{i?r(e):l(Error("Error"))},t)})},h="vulnerabilities",b=function(){var e,t,i;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:c,error:b,refetch:m}=(0,l.a)({queryKey:[h,s],queryFn:()=>(0,n.b5)({client:a.L,query:(0,r._)({},(0,u.rm)(s))}),enabled:!o});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(i=null==d||null==(t=d.data)?void 0:t.total)?i:0,params:s},isFetching:c,fetchError:b,refetch:m}},m=e=>{let t="off"===d.Z.MOCK?{ids:e.reduce((e,t,i)=>(i%100==0?e.push([t]):e[e.length-1].push(t),e),[]),dataResolver:async e=>(await (0,n.BJ)({client:a.L,body:{purls:e}})).data}:{ids:[e],dataResolver:e=>{var t;return c(null!=(t=window[o.Dx])?t:{})}},i=(0,s.h)({queries:t.ids.map(e=>({queryKey:[h,e],queryFn:()=>t.dataResolver(e),retry:!1}))}),r=i.some(e=>{let{isLoading:t}=e;return t}),l=i.find(e=>{let{error:t}=e;return!!t}),u={};if(!r)for(let e of i.map(e=>{var t;return null!=(t=null==e?void 0:e.data)?t:{}}))for(let[t,i]of Object.entries(e))u[t]=i;return{packages:u,isFetching:r,fetchError:l}},p=e=>{let{data:t,isLoading:i,error:r}=(0,l.a)({queryKey:[h,e],queryFn:()=>(0,n.OG)({client:a.L,path:{id:e}})});return{vulnerability:null==t?void 0:t.data,isFetching:i,fetchError:r}}}}]);