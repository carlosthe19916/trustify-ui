"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["944"],{6348:function(e,i,n){n.d(i,{Q:()=>c});var l=n(24246),r=n(78700),t=n(79551),s=n(32489),a=n(90519),d=n(35072);let c=e=>{let{isOpen:i,title:n,titleIconVariant:c,message:o,confirmBtnLabel:u,cancelBtnLabel:h,inProgress:x,confirmBtnVariant:j,onClose:b,onConfirm:v,onCancel:m}=e,p=(0,l.jsx)(r.zx,{id:"confirm-dialog-button","aria-label":"confirm",variant:j,isDisabled:x,onClick:v,children:u},"confirm"),y=m?(0,l.jsx)(r.zx,{id:"confirm-cancel-button","aria-label":"cancel",variant:r.Wu.link,isDisabled:x,onClick:m,children:h},"cancel"):void 0;return(0,l.jsxs)(t.u,{id:"confirm-dialog",variant:"small",isOpen:i,onClose:b,"aria-label":"Confirm dialog",children:[(0,l.jsx)(s.x,{title:n,titleIconVariant:c}),(0,l.jsx)(a.f,{children:o}),(0,l.jsx)(d.m,{children:m?(0,l.jsxs)(l.Fragment,{children:[p,y]}):p})]})}},24502:function(e,i,n){n.d(i,{M:()=>y});var l=n(24246),r=n(27378),t=n(27317),s=n(93095),a=n(54816),d=n(68802),c=n(31757),o=n(74607),u=n(70400),h=n(51088),x=n(58730),j=n(78700),b=n(63706),v=n(32947),m=n(40165);let p=e=>{let i=(0,v.W)(e);return{id:i,name:i}},y=e=>{let{title:i,value:n,isDisabled:y,onSave:f,onClose:g,options:_,onInputChange:C}=e,[w,S]=r.useState(Object.entries(n).map(e=>{let[i,n]=e;return p({key:i,value:n})}));return(0,l.jsxs)(t.K,{hasGutter:!0,children:[(0,l.jsx)(s.v,{children:"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."}),(0,l.jsx)(s.v,{children:(0,l.jsx)(a.c,{label:(0,l.jsx)(d.V,{component:"h4",children:i}),children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(o.e,{style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10,children:w.sort((e,i)=>(0,b.KF)(e.name).localeCompare((0,b.KF)(i.name))).map((e,i)=>(0,l.jsx)(u._,{color:"blue",onClose:()=>{let e=[...w];e.splice(i,1),S(e)},children:(0,b.KF)(e.labelName||e.name)},e.id))})})})}),(0,l.jsx)(s.v,{children:(0,l.jsxs)(h.l,{onSubmit:e=>e.preventDefault(),children:[(0,l.jsx)(m.F,{selections:w,options:_.map(e=>{let{key:i,value:n}=e;return p({key:i,value:n})}),onChange:S,placeholderText:"Add label",searchInputAriaLabel:"labels-select-toggle",onSearchChange:C,onCreateNewOption:e=>({id:e,name:e}),validateNewOption:e=>!!e&&e.trim().length>0&&/^(?!.*\\)(?!\s*\\)(?!\s*=)[^=\\\s][^=\\]*\s*=?\s*[^=\\]+$/.test(e),filterBeforeOnChange:(e,i)=>{let n=(0,v.nE)((0,b.KF)(i.name));return e.filter(e=>(0,v.nE)((0,b.KF)(e.name)).key!==n.key)}}),(0,l.jsxs)(x.W,{children:[(0,l.jsx)(j.zx,{type:"button",id:"submit","aria-label":"submit",variant:j.Wu.primary,isDisabled:y,onClick:()=>{f(w.map(e=>(0,v.nE)((0,b.KF)(e.name))).reduce((e,i)=>{let{key:n,value:l}=i;return e[n]=null!=l?l:"",e},{}))},children:"Save"}),(0,l.jsx)(j.zx,{type:"button",id:"cancel","aria-label":"cancel",variant:j.Wu.link,isDisabled:y,onClick:g,children:"Cancel"})]})]})})]})}},73827:function(e,i,n){n.d(i,{C:()=>d});var l=n(24246),r=n(74607),t=n(70400),s=n(85295),a=n(32947);let d=e=>{let{value:i,defaultIsOpen:n,onClick:d}=e;return(0,l.jsx)(r.e,{defaultIsOpen:n,numLabels:5,children:Object.entries(i).sort((e,i)=>{let[n]=e,[l]=i;return l.localeCompare(n)}).map(e=>{let[i,n]=e;return(0,l.jsx)(t._,{color:"blue",onClick:d?()=>d({key:i,value:n}):void 0,children:(0,l.jsx)(s.k,{content:(0,a.W)({key:i,value:n})})},i)})})}},37818:function(e,i,n){n.d(i,{u:()=>a});var l=n(24246),r=n(8305),t=n(13754),s=n(39826);let a=e=>e.isFetching?e.isFetchingState||(0,l.jsx)(r.b,{children:(0,l.jsx)(t.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,l.jsx)(s.y,{}):e.children},3586:function(e,i,n){n.d(i,{j:()=>t});var l=n(24246),r=n(27378);let t=e=>{let{children:i}=e,[n,t]=r.useState(!1);return(0,l.jsx)(l.Fragment,{children:i(n,t)})}},24200:function(e,i,n){n.d(i,{G:()=>r});var l=n(24246);let r=e=>{let{vulnerability:i}=e;return(0,l.jsxs)("p",{children:[i.withdrawn&&(0,l.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},73227:function(e,i,n){n.d(i,{i:()=>d});var l=n(2926),r=n(87017),t=n(50576),s=n(40371),a=n(63706);let d=()=>({downloadAdvisory:(e,i)=>{(0,s.Em)({client:t.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOM:(e,i)=>{(0,s.XW)({client:t.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOMLicenses:e=>{(0,r.Co)(e).then(i=>{var n,r;let t=null,s=null==(r=i.headers)||null==(n=r["content-disposition"])?void 0:n.toString();s&&(t=(0,a.lj)(s)),(0,l.saveAs)(new Blob([i.data]),t||"".concat(e,".tar.gz"))})}})},74247:function(e,i,n){n.r(i),n.d(i,{default:()=>ep});var l=n(79192),r=n(53195),t=n(24246),s=n(27378),a=n(14935),d=n(65783),c=n(45043),o=n(97339),u=n(18091),h=n(11192),x=n(32591),j=n(34747),b=n(46770),v=n(68802),m=n(70400),p=n(32939),y=n(24620),f=n(37961),g=n(69265),_=n(25138),C=n(2075),w=n(27090),S=n(75165),T=n(59086),E=n(78700),F=n(74502),K=n(27031),k=n(6348),A=n(37818),I=n(15726),L=n(73227),O=n(17598),D=n(65872),P=n(87727),q=n(3498),B=n(31757),V=n(87069),N=n(51527),M=n(30329),W=n(50689),z=n(67761),R=n(81391),Z=n(79551),G=n(32489),Q=n(90519),H=n(26235),U=n(73827),Y=n(63706),J=n(15167);let X=e=>{var i,n;let{advisory:l}=e,[r,a]=s.useState(!1),d=()=>{a(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(P.r,{hasGutter:!0,children:[(0,t.jsx)(q.P,{md:4,children:(0,t.jsxs)(B.Z,{isFullHeight:!0,children:[(0,t.jsx)(V.l,{children:"Overview"}),(0,t.jsx)(N.e,{children:(0,t.jsxs)(M.o,{children:[(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"Title"}),(0,t.jsx)(R.b,{children:l.title})]}),(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"Type"}),(0,t.jsx)(R.b,{children:l.labels.type})]}),(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"Size"}),(0,t.jsx)(R.b,{children:(0,D.Z)(l.size)})]}),(0,t.jsxs)(W.g,{children:[(0,t.jsxs)(z.M,{children:["Labels ","",(0,t.jsx)(E.zx,{variant:E.Wu.link,size:"sm",icon:(0,t.jsx)(H.ZP,{}),iconPosition:"end",onClick:()=>a(!0),children:"Edit"})]}),(0,t.jsx)(R.b,{children:(0,t.jsx)(B.Z,{isCompact:!0,children:(0,t.jsx)(N.e,{children:l.labels&&(0,t.jsx)(U.C,{defaultIsOpen:!0,value:l.labels})})})})]})]})})]})}),(0,t.jsx)(q.P,{md:4,children:(0,t.jsxs)(B.Z,{isFullHeight:!0,children:[(0,t.jsx)(V.l,{children:"Publisher"}),(0,t.jsx)(N.e,{children:(0,t.jsxs)(M.o,{children:[(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"Name"}),(0,t.jsx)(R.b,{children:null==(i=l.issuer)?void 0:i.name})]}),(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"Contact details"}),(0,t.jsx)(R.b,{children:null==(n=l.issuer)?void 0:n.website})]})]})})]})}),(0,t.jsx)(q.P,{md:4,children:(0,t.jsxs)(B.Z,{isFullHeight:!0,children:[(0,t.jsx)(V.l,{children:"Tracking"}),(0,t.jsx)(N.e,{children:(0,t.jsxs)(M.o,{children:[(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"ID"}),(0,t.jsx)(R.b,{children:l.identifier})]}),(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"Initial release date"}),(0,t.jsx)(R.b,{children:(0,Y.p6)(l.published)})]}),(0,t.jsxs)(W.g,{children:[(0,t.jsx)(z.M,{children:"Current release date"}),(0,t.jsx)(R.b,{children:(0,Y.p6)(l.modified)})]})]})})]})})]}),(0,t.jsxs)(Z.u,{isOpen:r,variant:"medium",title:"Edit labels",onClose:d,children:[(0,t.jsx)(G.x,{title:"Edit labels"}),(0,t.jsx)(Q.f,{children:(0,t.jsx)(J.q,{advisory:l,onClose:d})})]})]})};var $=n(46403),ee=n(70715),ei=n(40982),en=n(89226),el=n(4835),er=n(14350),et=n(11165),es=n(89330),ea=n(31423),ed=n(94154),ec=n(9905),eo=n(7615),eu=n(57524),eh=n(3804),ex=n(31336),ej=n(3586),eb=n(24200),ev=n(49988);let em=e=>{let{isFetching:i,fetchError:n,vulnerabilities:s}=e,a=(0,ev.sz)({tableName:"vulnerability-table",idProperty:"identifier",items:s,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:c,numRenderedColumns:o,propHelpers:{toolbarProps:u,paginationToolbarItemProps:h,paginationProps:x,tableProps:j,getThProps:b,getTrProps:v,getTdProps:m},expansionDerivedState:{isCellExpanded:p}}=a;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ee.o,(0,r._)((0,l._)({},u),{"aria-label":"vulnerability toolbar",children:(0,t.jsx)(ei.c,{children:(0,t.jsx)(en.E,(0,r._)((0,l._)({},h),{children:(0,t.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:x})}))})})),(0,t.jsxs)(el.i,(0,r._)((0,l._)({},j),{"aria-label":"vulnerability table",children:[(0,t.jsx)(er.h,{children:(0,t.jsx)(et.Tr,{children:(0,t.jsxs)(ex.qK,(0,r._)((0,l._)({},a),{children:[(0,t.jsx)(es.Th,(0,l._)({},b({columnKey:"identifier"}))),(0,t.jsx)(es.Th,(0,l._)({},b({columnKey:"title"}))),(0,t.jsx)(es.Th,(0,l._)({},b({columnKey:"discovery"}))),(0,t.jsx)(es.Th,(0,l._)({},b({columnKey:"release"}))),(0,t.jsx)(es.Th,(0,l._)({},b({columnKey:"score"}))),(0,t.jsx)(es.Th,(0,l._)({},b({columnKey:"cwe"})))]}))})}),(0,t.jsx)(ex.hp,{isLoading:i,isError:!!n,isNoData:0===s.length,numRenderedColumns:o,children:null==c?void 0:c.map((e,i)=>{var n;return(0,t.jsx)(ea.p,{isExpanded:p(e),children:(0,t.jsx)(et.Tr,(0,r._)((0,l._)({},v({item:e})),{children:(0,t.jsxs)(ex.Cx,(0,r._)((0,l._)({},a),{item:e,rowIndex:i,children:[(0,t.jsx)(ed.Td,(0,r._)((0,l._)({width:15,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,t.jsx)(d.rU,{to:(0,$.Gn)(K.nB.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,t.jsx)(ej.j,{children:(i,n)=>(0,t.jsx)(ed.Td,(0,r._)((0,l._)({width:40,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},m({columnKey:"title"})),{children:(0,t.jsx)(ec.cE,{focused:i,wrapModifier:"truncate",children:(0,t.jsx)(eb.G,{vulnerability:e})})}))}),(0,t.jsx)(ed.Td,(0,r._)((0,l._)({width:15},m({columnKey:"discovery"})),{children:(0,Y.p6)(e.discovered)})),(0,t.jsx)(ed.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"release"})),{children:(0,Y.p6)(e.released)})),(0,t.jsx)(ed.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"score"})),{children:e.severity&&(0,t.jsx)(eu.o,{value:(0,eo.g)(e.severity),score:null!=(n=e.score)?n:null,showLabel:!0,showScore:!0})})),(0,t.jsx)(ed.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},m({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,t.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:x})]})},ep=()=>{var e,i;let n=(0,a.s0)(),{pushNotification:D}=s.useContext(I.c),P=(0,K.ZX)(K.Uo.ADVISORY_ID),{advisory:q,isFetching:B,fetchError:V}=(0,O.gw)(P),[N,M]=s.useState(!1),W=()=>{M(!N)},{downloadAdvisory:z}=(0,L.i)(),[R,Z]=s.useState(!1),{mutate:G,isPending:Q}=(0,O.y2)(e=>{Z(!1),D({title:(0,F.TR)(e),variant:"success"}),n("/advisories")},e=>{D({title:(0,F.BS)(e),variant:"danger"})}),[H,U]=s.useState(0),Y=s.createRef(),J=s.createRef();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.NP,{type:"breadcrumb",children:(0,t.jsxs)(o.a,{children:[(0,t.jsx)(u.g,{children:(0,t.jsx)(d.rU,{to:K.nB.advisories,children:"Advisories"})}),(0,t.jsx)(u.g,{isActive:!0,children:"Advisory details"})]})}),(0,t.jsx)(c.NP,{children:(0,t.jsxs)(h.P,{children:[(0,t.jsx)(x.J,{isFilled:!0,children:(0,t.jsxs)(j.k,{children:[(0,t.jsx)(b.B,{spacer:{default:"spacerSm"},children:(0,t.jsxs)(v.V,{children:[(0,t.jsx)(v.V,{component:"h1",children:null!=(i=null!=(e=null==q?void 0:q.document_id)?e:P)?i:""}),(0,t.jsx)(v.V,{component:"p",children:"Advisory detail information"})]})}),(0,t.jsx)(b.B,{children:(null==q?void 0:q.labels.type)&&(0,t.jsx)(m._,{color:"blue",children:null==q?void 0:q.labels.type})})]})}),(0,t.jsx)(x.J,{children:q&&(0,t.jsx)(p.L,{isOpen:N,onSelect:()=>M(!1),onOpenChange:e=>M(e),popperProps:{position:"right"},toggle:e=>(0,t.jsx)(y.O_,{ref:e,onClick:W,isExpanded:N,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsxs)(f.s,{children:[(0,t.jsx)(g.h,{onClick:()=>{P&&z(P,(null==q?void 0:q.identifier)?"".concat(null==q?void 0:q.identifier,".json"):"".concat(P,".json"))},children:"Download Advisory"},"advisory"),(0,t.jsx)(_.i,{component:"li"},"separator"),(0,t.jsx)(g.h,{onClick:()=>Z(!0),children:"Delete"},"delete")]})})})]})}),(0,t.jsx)(c.NP,{children:(0,t.jsxs)(C.m,{mountOnEnter:!0,activeKey:H,onSelect:(e,i)=>{U(i)},"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,t.jsx)(w.O,{eventKey:0,title:(0,t.jsx)(S.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:Y}),(0,t.jsx)(w.O,{eventKey:1,title:(0,t.jsx)(S.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:J})]})}),(0,t.jsxs)(c.NP,{children:[(0,t.jsx)(T.I,{eventKey:0,id:"refTabInfoSection",ref:Y,"aria-label":"Information of the Advisory",children:(0,t.jsx)(A.u,{isFetching:B,fetchError:V,children:q&&(0,t.jsx)(X,{advisory:q})})}),(0,t.jsx)(T.I,{eventKey:1,id:"refVulnerabilitiesSection",ref:J,"aria-label":"Vulnerabilities within the Advisory",hidden:!0,children:(0,t.jsx)(em,{isFetching:B,fetchError:V,vulnerabilities:(null==q?void 0:q.vulnerabilities)||[]})})]}),(0,t.jsx)(k.Q,(0,r._)((0,l._)({},(0,F.gn)(q)),{inProgress:Q,titleIconVariant:"warning",isOpen:R,confirmBtnVariant:E.Wu.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>Z(!1),onClose:()=>Z(!1),onConfirm:()=>{q&&G(q.uuid)}}))]})}},15167:function(e,i,n){n.d(i,{q:()=>d});var l=n(24246),r=n(27378),t=n(24502),s=n(15726),a=n(17598);let d=e=>{let{advisory:i,onClose:n}=e,{pushNotification:d}=r.useContext(s.c),[c,o]=r.useState(""),[u,h]=r.useState(""),{labels:x}=(0,a.VY)(u);r.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:j,isPending:b}=(0,a.sj)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),n()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,l.jsx)(t.M,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:b,onSave:e=>{j({id:i.uuid,labels:e})},onClose:n,onInputChange:o,options:x})}},17598:function(e,i,n){n.d(i,{N7:()=>m,VY:()=>v,gw:()=>p,sj:()=>g,tG:()=>f,y2:()=>y});var l=n(79192),r=n(53195),t=n(70186),s=n(1183),a=n(24038),d=n(68e3),c=n(75503),o=n(50576),u=n(40371),h=n(87017),x=n(49988),j=n(95169);let b="advisories",v=e=>{let{data:i,isLoading:n,error:l,refetch:r}=(0,s.a)({queryKey:[b,"labels",e],queryFn:()=>(0,u.sf)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==i?void 0:i.data)||[],isFetching:n,fetchError:l,refetch:r}},m=function(){var e,i,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,x.rm)(a),{q:j}=h,v=(0,t._)(h,["q"]),m=(0,x.Rb)(d),{data:p,isLoading:y,error:f,refetch:g}=(0,s.a)({queryKey:[b,a,m],queryFn:()=>(0,u.A1)({client:o.L,query:(0,r._)((0,l._)({},v),{q:[j,m].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==p||null==(e=p.data)?void 0:e.items)||[],total:null!=(n=null==p||null==(i=p.data)?void 0:i.total)?n:0,params:a},isFetching:y,fetchError:f||null,refetch:g}},p=e=>{let{data:i,isLoading:n,error:l}=(0,s.a)({queryKey:[b,e],queryFn:()=>(0,u.pB)({client:o.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:n,fetchError:l}},y=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:async e=>(await (0,u.Wr)({client:o.L,path:{key:e}})).data,onSuccess:async(i,l)=>{e(i,l),await n.invalidateQueries({queryKey:[b]})},onError:async e=>{i(e),await n.invalidateQueries({queryKey:[b]})}})},f=()=>{let e=(0,d.NL)();return(0,j.V)({parallel:!0,uploadFn:(e,i)=>(0,h.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[b]})}})},g=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:e=>(0,u.m5)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,l)=>{e(),await n.invalidateQueries({queryKey:[b]})},onError:i})}}}]);