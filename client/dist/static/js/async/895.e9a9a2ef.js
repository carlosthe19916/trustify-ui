"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["895"],{32947:function(e,r,l){l.d(r,{A0:()=>j,Bn:()=>g,V4:()=>y,W:()=>f,dn:()=>_,nE:()=>m});var t=l(91566),i=l(839),n=l(73657),a=l(20644),s=l(89502),o=l(7596),d=l(1811),c=l(24917),u=l(4720),h=l(54178),p=l(37106),v=l(34313);let y={unknown:{name:"Unknown",color:d.P,progressProps:{variant:void 0},icon:t.M$},none:{name:"None",color:c.E,progressProps:{variant:void 0},icon:i.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:n._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:a.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:s.E2},critical:{name:"Critical",color:v.J,progressProps:{variant:"danger"},icon:o.ki}},x=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function j(e){return(r,l)=>x(e(r))-x(e(l))}let f=e=>{let{key:r,value:l}=e;return"".concat(l?"".concat(r,"=").concat(l):"".concat(r))},m=e=>{let[r,l]=e.split("=");return{key:r,value:null!=l?l:""}},b=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function g(e){return(r,l)=>b(e(r))-b(e(l))}let _=e=>0===e.length?null:e.sort(g(e=>e.type))[0]},7615:function(e,r,l){l.d(r,{g:()=>t});let t=e=>null!=e?e:"unknown"},87017:function(e,r,l){l.d(r,{Co:()=>v,Cu:()=>u,Hb:()=>h,y:()=>p});var t=l(79192),i=l(53195),n=l(70233),a=l(74502);l(41947);let s="/api",o="".concat(s,"/v2/advisory"),d="".concat(s,"/v2/sbom"),c=e=>{let r="application/json";return e.name.endsWith(".bz2")&&(r="application/json+bzip2"),r},u=(e,r)=>{let l=e.get(a.TB);return n.Z.post("".concat(o),l,(0,i._)((0,t._)({},r),{headers:{"Content-Type":c(l)}}))},h=(e,r)=>{let l=e.get(a.TB);return n.Z.post("".concat(d),l,(0,i._)((0,t._)({},r),{headers:{"Content-Type":c(l)}}))},p=(e,r)=>{let l=e.get(a.TB);return n.Z.post("/api/v2/ui/extract-sbom-purls",l,(0,i._)((0,t._)({},r),{headers:{"Content-Type":c(l)}}))},v=e=>n.Z.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},69876:function(e,r,l){l.d(r,{D:()=>n});var t=l(24246),i=l(70400);let n=e=>{let{value:r}=e;return(0,t.jsx)(t.Fragment,{children:Object.entries(r).map(e=>{let[r,l]=e;return(0,t.jsx)(i._,{isCompact:!0,children:"".concat(r,"=").concat(l)},"".concat(r,"=").concat(l))})})}},57524:function(e,r,l){l.d(r,{o:()=>d});var t=l(24246),i=l(34747),n=l(46770),a=l(64766),s=l(2499),o=l(32947);let d=e=>{let{value:r,score:l,showScore:d,showLabel:c}=e,u=o.V4[r],h=u.name,p=u.icon;return(0,t.jsxs)(i.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,t.jsx)(n.B,{children:c?(0,t.jsx)(a.J,{children:(0,t.jsx)(p,{color:u.color.value})}):(0,t.jsx)(s.u,{content:h,children:(0,t.jsx)(a.J,{children:(0,t.jsx)(p,{color:u.color.value})})})}),c&&(0,t.jsx)(n.B,{children:h}),d&&null!==l&&(0,t.jsxs)(n.B,{children:["(",Math.round(10*l)/10,")"]})]})}},3804:function(e,r,l){l.d(r,{p:()=>s});var t=l(79192),i=l(53195),n=l(24246),a=l(27230);let s=e=>{let{paginationProps:r,isTop:l,isCompact:s=!1,idPrefix:o=""}=e;return(0,n.jsx)(a.t,(0,i._)((0,t._)({id:"".concat(o?"".concat(o,"-"):"","pagination-").concat(l?"top":"bottom"),variant:l?a.a.top:a.a.bottom,isCompact:s},r),{widgetId:"pagination-id"}))}},39826:function(e,r,l){l.d(r,{y:()=>s});var t=l(24246),i=l(10707),n=l(16668),a=l(42160);let s=()=>(0,t.jsx)(i.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:a.ZP,variant:i.IQ.sm,children:(0,t.jsx)(n.B,{children:"There was an error retrieving data. Check your connection and try again."})})},31336:function(e,r,l){l.d(r,{hp:()=>y,qK:()=>j,Cx:()=>m});var t=l(24246),i=l(8305),n=l(13754),a=l(31423),s=l(11165),o=l(94154),d=l(39826),c=l(10707),u=l(16668),h=l(22119);let p=e=>{let{title:r,description:l}=e;return(0,t.jsx)(c.ub,{titleText:r,headingLevel:"h4",icon:h.ZP,variant:c.IQ.sm,children:l&&(0,t.jsx)(u.B,{children:l})})},v=()=>(0,t.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),y=e=>{let{numRenderedColumns:r,isLoading:l=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:y}=e;return(0,t.jsx)(t.Fragment,{children:l?(0,t.jsx)(a.p,{"aria-label":"Table loading",children:(0,t.jsx)(s.Tr,{children:(0,t.jsx)(o.Td,{colSpan:r,children:(0,t.jsx)(i.b,{children:(0,t.jsx)(n.$,{size:"xl"})})})})}):c?(0,t.jsx)(a.p,{"aria-label":"Table error",children:(0,t.jsx)(s.Tr,{children:(0,t.jsx)(o.Td,{colSpan:r,children:(0,t.jsx)(i.b,{children:h||(0,t.jsx)(d.y,{})})})})}):u?(0,t.jsx)(a.p,{"aria-label":"Table empty",children:(0,t.jsx)(s.Tr,{children:(0,t.jsx)(o.Td,{colSpan:r,children:(0,t.jsx)(i.b,{children:p||(0,t.jsx)(v,{})})})})}):y})};var x=l(89330);let j=e=>{let{numColumnsBeforeData:r,numColumnsAfterData:l,children:i}=e;return(0,t.jsxs)(t.Fragment,{children:[Array(r).fill(null).map((e,r)=>(0,t.jsx)(x.Th,{screenReaderText:"before-data-".concat(r)},r)),i,Array(l).fill(null).map((e,r)=>(0,t.jsx)(x.Th,{screenReaderText:"after-data-".concat(r)},r))]})};var f=l(79192);let m=e=>{let{isExpansionEnabled:r=!1,expandableVariant:l,getSelectCheckboxTdProps:i,propHelpers:{getSingleExpandButtonTdProps:n},item:a,rowIndex:s,children:d}=e;return(0,t.jsxs)(t.Fragment,{children:[r&&"single"===l?(0,t.jsx)(o.Td,(0,f._)({},n({item:a,rowIndex:s}))):null,i?(0,t.jsx)(o.Td,(0,f._)({},i({item:a,rowIndex:s}))):null,d]})}},3586:function(e,r,l){l.d(r,{j:()=>n});var t=l(24246),i=l(27378);let n=e=>{let{children:r}=e,[l,n]=i.useState(!1);return(0,t.jsx)(t.Fragment,{children:r(l,n)})}},24200:function(e,r,l){l.d(r,{G:()=>i});var t=l(24246);let i=e=>{let{vulnerability:r}=e;return(0,t.jsxs)("p",{children:[r.withdrawn&&(0,t.jsx)("em",{children:"Rejected:\xa0"}),r.title||r.description]})}},49304:function(e,r,l){l.d(r,{u:()=>c});var t=l(24246),i=l(34747),n=l(46770),a=l(25138),s=l(87445),o=l(32947),d=l(57524);let c=e=>{let{severities:r}=e,l=Object.values(r).reduce((e,r)=>e+r,0);return(0,t.jsxs)(i.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,t.jsx)(n.B,{"aria-label":"total",style:{minWidth:15,textAlign:s.F2},children:l}),(0,t.jsx)(a.i,{orientation:{default:"vertical"}}),(0,t.jsx)(n.B,{children:(0,t.jsx)(i.k,{children:Object.entries(r).filter(e=>{let[r,l]=e;return l>0}).sort((0,o.A0)(e=>{let[r,l]=e;return r})).reverse().map(e=>{let[r,l]=e;return(0,t.jsx)(n.B,{spacer:{default:"spacerXs"},children:(0,t.jsxs)(i.k,{"aria-label":r,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,t.jsx)(n.B,{children:(0,t.jsx)(d.o,{value:r,score:null})}),(0,t.jsx)(n.B,{children:l})]})},r)})})})]})}},82413:function(e,r,l){l.d(r,{Ap:()=>h,Ie:()=>p,_g:()=>c});var t=l(79192),i=l(53195),n=l(27378),a=l(7615),s=l(43959);let o=(e,r)=>e.vulnerability.identifier===r.vulnerability.identifier&&e.vulnerabilityStatus===r.vulnerabilityStatus,d={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,t._)({},d),fixed:(0,t._)({},d),not_affected:(0,t._)({},d),known_not_affected:(0,t._)({},d)}},u=e=>{let r=e.flatMap(e=>{var r;return(null!=(r=e.status)?r:[]).map(r=>({vulnerability:r,vulnerabilityStatus:r.status,advisory:e,packages:r.packages}))}).reduce((e,r)=>{let l,n=e.find(e=>o(e,r));if(n)l=[...e.filter(e=>!o(e,n)),(0,i._)((0,t._)({},n),{relatedPackages:[...n.relatedPackages,{advisory:r.advisory,packages:r.packages}]})];else{let t={vulnerability:r.vulnerability,vulnerabilityStatus:r.vulnerabilityStatus,relatedPackages:[{advisory:r.advisory,packages:r.packages}]};l=[...e.slice(),t]}return l},[]),l=r.reduce((e,r)=>{let l=r.vulnerabilityStatus,n=(0,a.g)(r.vulnerability.average_severity),s=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,i._)((0,t._)({},e.vulnerabilityStatus),{[l]:{total:s.total+1,severities:(0,i._)((0,t._)({},s.severities),{[n]:s.severities[n]+1})}})})},(0,t._)({},c));return{vulnerabilities:r,summary:l}},h=e=>{let{advisories:r,isFetching:l,fetchError:t}=(0,s.KQ)(e);return{data:n.useMemo(()=>u(r||[]),[r]),isFetching:l,fetchError:t}},p=e=>{let{advisories:r,isFetching:l,fetchError:t}=(0,s.uz)(e);return{data:n.useMemo(()=>(null!=r?r:[]).map(e=>u(e||[])),[r]),isFetching:l,fetchError:t}}},95169:function(e,r,l){l.d(r,{V:()=>u});var t=l(79192),i=l(53195),n=l(27378),a=l(74502),s=l(70233);let o="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,r)=>{switch(r.type){case"queueUpload":return(0,i._)((0,t._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,i._)((0,t._)({},e.uploads.get(r.payload.file)||d()),{status:"queued",cancelFn:r.payload.cancelFn}))});case"updateUploadProgress":return(0,i._)((0,t._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,i._)((0,t._)({},e.uploads.get(r.payload.file)||d()),{progress:r.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,i._)((0,t._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,i._)((0,t._)({},e.uploads.get(r.payload.file)||d()),{status:"complete",response:r.payload.response}))});case"finishUploadWithError":var l;return(0,i._)((0,t._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,i._)((0,t._)({},e.uploads.get(r.payload.file)||d()),{status:"complete",error:r.payload.error,wasCancelled:(null==(l=r.payload.error)?void 0:l.message)===o}))});case"removeUpload":{let l=new Map(e.uploads);return l.delete(r.payload.file),(0,i._)((0,t._)({},e),{uploads:l})}default:throw Error()}},u=e=>{let{parallel:r,uploadFn:l,onSuccess:t,onError:i}=e,[d,u]=n.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let n=[];for(let r=0;r<e.length;r++){let l=e[r],d=new FormData;d.set(a.TB,l);let c=s.Z.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var r;let t=null!=(r=e.total)?r:1;u({type:"updateUploadProgress",payload:{file:l,progress:Math.round(e.loaded/t*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:l,cancelFn:c}});let p={formData:d,config:h,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:l,response:e}}),t&&t(e,l)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:l,error:e}}),e.message!==o&&i&&i(e,l)}};n.push(p)}if(r)for(let e of n)l(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,r)=>(await e,l(r.formData,r.config).then(r.thenFn).catch(r.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var r,l;null==(l=d.uploads.get(e))||null==(r=l.cancelFn)||r.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},45188:function(e,r,l){l.r(r),l.d(r,{default:()=>eP});var t=l(24246),i=l(27378),n=l(65783),a=l(45043),s=l(97339),o=l(18091),d=l(68802),c=l(11192),u=l(32591),h=l(32939),p=l(24620),v=l(37961),y=l(69265),x=l(10707),j=l(16668),f=l(77081),m=l(59085),b=l(78700),g=l(27317),_=l(93095),T=l(42160),w=l(1353),S=l(68e3),F=l(87017),k=l(95169),P=l(9839),q=l(79192),C=l(53195),A=l(32947),E=l(7615),K=l(78176),I=l(82413),L=l(87727),M=l(3498),U=l(31757),B=l(87069),O=l(8305),z=l(51527),V=l(49304);let D=e=>{let{summary:r}=e;return(0,t.jsxs)(L.r,{hasGutter:!0,children:[(0,t.jsx)(M.P,{md:4,children:(0,t.jsxs)(U.Z,{children:[(0,t.jsx)(B.l,{children:(0,t.jsx)(O.b,{children:"Total vulnerabilities"})}),(0,t.jsx)(z.e,{children:(0,t.jsx)(O.b,{children:r.vulnerabilityStatus.affected.total})})]})}),(0,t.jsx)(M.P,{md:4,children:(0,t.jsxs)(U.Z,{children:[(0,t.jsx)(B.l,{children:(0,t.jsx)(O.b,{children:"Affected packages"})}),(0,t.jsx)(z.e,{children:(0,t.jsx)(O.b,{children:r.vulnerabilityStatus.affected.total})})]})}),(0,t.jsx)(M.P,{md:4,children:(0,t.jsxs)(U.Z,{children:[(0,t.jsx)(B.l,{children:(0,t.jsx)(O.b,{children:"Vulnerabilities by severity"})}),(0,t.jsx)(z.e,{children:(0,t.jsx)(O.b,{children:(0,t.jsx)(V.u,{severities:r.vulnerabilityStatus.affected.severities})})})]})})]})};var N=l(27693),Z=l.n(N),R=l(70715),Q=l(40982),W=l(89226),H=l(99),G=l(39629),J=l(98383),X=l(81211),$=l(45882),Y=l(62997),ee=l(4835),er=l(14350),el=l(11165),et=l(89330),ei=l(31423),en=l(94154),ea=l(9905),es=l(67447),eo=l(48513),ed=l(14629),ec=l(69876),eu=l(57524),eh=l(3804),ep=l(31336),ev=l(3586),ey=l(24200),ex=l(49988),ej=l(41135),ef=l(63706);let em=e=>{let{vulnerabilities:r,isFetching:l,fetchError:i}=e,n=(0,ej.T)(r,e=>"".concat(e.vulnerability.identifier,"-").concat(e.status)),a=(0,ex.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:n,isLoading:l,columnNames:{vulnerabilityId:"Vulnerability ID",description:"Description",status:"Status",severity:"Severity",affectedPackages:"Affected packages",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["vulnerabilityId","severity","affectedPackages","published","updated"],getSortValues:e=>{var r,l,t,i;return{vulnerabilityId:e.vulnerability.identifier,severity:null!=(i=null==(r=e.opinionatedAvisory.score)?void 0:r.value)?i:0,affectedPackages:e.purls.size,published:(null==(l=e.vulnerability)?void 0:l.published)?Z()(e.vulnerability.published).valueOf():0,updated:(null==(t=e.vulnerability)?void 0:t.modified)?Z()(e.vulnerability.modified).valueOf():0}},isFilterEnabled:!0,filterCategories:[{categoryKey:"vulnerabilityId",title:"Vulnerability id",type:ed.vA.search,placeholderText:"Search by Vulnerability id",getItemValue:e=>e.vulnerability.identifier},{categoryKey:"severity",title:"Severity",type:ed.vA.multiselect,placeholderText:"Severity",selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],matcher:(e,r)=>e===r.opinionatedAvisory.extendedSeverity},{categoryKey:"status",title:"Status",type:ed.vA.multiselect,placeholderText:"Status",selectOptions:[{value:"affected",label:"Affected"},{value:"under_investigation",label:"Under investigation"}],matcher:(e,r)=>e===r.status}],isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:s,numRenderedColumns:o,propHelpers:{toolbarProps:d,paginationToolbarItemProps:h,paginationProps:p,tableProps:v,filterToolbarProps:y,getThProps:x,getTrProps:j,getTdProps:f,getExpandedContentTdProps:m},expansionDerivedState:{isCellExpanded:b}}=a;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.o,(0,C._)((0,q._)({},d),{children:(0,t.jsxs)(Q.c,{children:[(0,t.jsx)(ed.Ki,(0,q._)({},y)),(0,t.jsx)(W.E,(0,C._)((0,q._)({},h),{children:(0,t.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:p})}))]})})),(0,t.jsxs)(ee.i,(0,C._)((0,q._)({},v),{"aria-label":"Vulnerability table",children:[(0,t.jsx)(er.h,{children:(0,t.jsx)(el.Tr,{children:(0,t.jsxs)(ep.qK,(0,C._)((0,q._)({},a),{children:[(0,t.jsx)(et.Th,(0,q._)({},x({columnKey:"vulnerabilityId"}))),(0,t.jsx)(et.Th,(0,q._)({},x({columnKey:"description"}))),(0,t.jsx)(et.Th,(0,q._)({},x({columnKey:"status"}))),(0,t.jsx)(et.Th,(0,q._)({},x({columnKey:"severity"}))),(0,t.jsx)(et.Th,(0,q._)({},x({columnKey:"affectedPackages"}))),(0,t.jsx)(et.Th,(0,q._)({},x({columnKey:"published"}))),(0,t.jsx)(et.Th,(0,q._)({},x({columnKey:"updated"})))]}))})}),(0,t.jsx)(ep.hp,{isLoading:l,isError:!!i,isNoData:0===n.length,numRenderedColumns:o,children:null==s?void 0:s.map((e,r)=>{var l,i,n,s,o,d,h;return(0,t.jsxs)(ei.p,{isExpanded:b(e),children:[(0,t.jsx)(el.Tr,(0,C._)((0,q._)({},j({item:e})),{children:(0,t.jsxs)(ep.Cx,(0,C._)((0,q._)({},a),{item:e,rowIndex:r,children:[(0,t.jsx)(en.Td,(0,C._)((0,q._)({width:15,modifier:"breakWord"},f({columnKey:"vulnerabilityId",isCompoundExpandToggle:!0,item:e,rowIndex:r})),{children:e.vulnerability.identifier})),(0,t.jsx)(ev.j,{children:(r,l)=>(0,t.jsx)(en.Td,(0,C._)((0,q._)({width:35,modifier:"truncate",onFocus:()=>l(!0),onBlur:()=>l(!1),tabIndex:0},f({columnKey:"description"})),{children:(0,t.jsx)(ea.cE,{focused:r,wrapModifier:"truncate",children:e.vulnerability&&(0,t.jsx)(ey.G,{vulnerability:e.vulnerability})})}))}),(0,t.jsx)(en.Td,(0,C._)((0,q._)({width:10,modifier:"truncate"},f({columnKey:"status"})),{children:e.status})),(0,t.jsx)(en.Td,(0,C._)((0,q._)({width:10,modifier:"breakWord"},f({columnKey:"severity"})),{children:(0,t.jsx)(H.J,{triggerAction:"hover","aria-label":"Hoverable popover",headerContent:(0,t.jsx)("div",{children:null==(i=e.opinionatedAvisory.advisory)||null==(l=i.issuer)?void 0:l.name}),bodyContent:(0,t.jsxs)("div",{children:["CVSS v",null==(n=e.opinionatedAvisory.score)?void 0:n.type]}),children:(0,t.jsx)(eu.o,{value:e.opinionatedAvisory.extendedSeverity,score:null!=(h=null==(s=e.opinionatedAvisory.score)?void 0:s.value)?h:null,showLabel:!0,showScore:!0})})})),(0,t.jsx)(en.Td,(0,C._)((0,q._)({width:10,modifier:"truncate"},f({columnKey:"affectedPackages",isCompoundExpandToggle:!0,item:e,rowIndex:r})),{children:e.purls.size})),(0,t.jsx)(en.Td,(0,C._)((0,q._)({width:10,modifier:"truncate"},f({columnKey:"published"})),{children:(0,ef.p6)(null==(o=e.vulnerability)?void 0:o.published)})),(0,t.jsx)(en.Td,(0,C._)((0,q._)({width:10,modifier:"truncate"},f({columnKey:"updated"})),{children:(0,ef.p6)(null==(d=e.vulnerability)?void 0:d.modified)}))]}))})),b(e)?(0,t.jsx)(el.Tr,{isExpanded:!0,children:(0,t.jsx)(en.Td,(0,C._)((0,q._)({},m({item:e})),{children:(0,t.jsxs)(es.G,{children:[b(e,"vulnerabilityId")?(0,t.jsx)("div",{className:Y.Z.mMd,children:(0,t.jsx)(G.r,{hasGutter:!0,minWidths:{md:"350px"},children:Array.from(e.advisories.values()).map(e=>{var r,l;let{advisory:i,scores:n,opinionatedExtendedSeverity:a,opinionatedScore:s}=e;return(0,t.jsx)(J.L,{children:(0,t.jsxs)(U.Z,{isCompact:!0,children:[(0,t.jsx)(z.e,{children:(0,t.jsxs)(c.P,{children:[(0,t.jsx)(u.J,{isFilled:!0,children:null==(r=i.issuer)?void 0:r.name}),(0,t.jsx)(u.J,{children:(0,t.jsx)(eu.o,{value:a,score:null!=(l=null==s?void 0:s.value)?l:0,showLabel:!0,showScore:!0})})]})}),(0,t.jsx)(z.e,{style:{padding:"0 0 15px 0"},children:(0,t.jsxs)(ee.i,{variant:"compact",children:[(0,t.jsx)(eo.Y,{children:"Scores"}),(0,t.jsx)(ei.p,{children:n.map((e,r)=>(0,t.jsxs)(el.Tr,{children:[(0,t.jsx)(en.Td,{children:(0,t.jsx)(eu.o,{value:e.severity,score:e.value,showLabel:!0,showScore:!0})}),(0,t.jsxs)(en.Td,{children:["CVSS v",e.type]})]},"".concat(r,"-").concat(e.type,"-").concat(e.value)))})]})})]})},i.document_id)})})}):null,b(e,"severity")?(0,t.jsx)(X.aV,{isPlain:!0,children:Array.from(e.advisories.values()).map(e=>(0,t.jsx)($.H,{children:e.advisory.identifier},"".concat(e.advisory.identifier)))}):null,b(e,"affectedPackages")?(0,t.jsxs)(ee.i,{variant:"compact",children:[(0,t.jsx)(er.h,{children:(0,t.jsxs)(el.Tr,{children:[(0,t.jsx)(et.Th,{children:"Type"}),(0,t.jsx)(et.Th,{children:"Namespace"}),(0,t.jsx)(et.Th,{children:"Name"}),(0,t.jsx)(et.Th,{children:"Version"}),(0,t.jsx)(et.Th,{children:"Path"}),(0,t.jsx)(et.Th,{children:"Qualifiers"})]})}),(0,t.jsx)(ei.p,{children:Array.from(e.purls.values()).map(e=>{let r=(0,ef.qX)(e);return r?(0,t.jsxs)(el.Tr,{children:[(0,t.jsx)(en.Td,{children:null==r?void 0:r.type}),(0,t.jsx)(en.Td,{children:null==r?void 0:r.namespace}),(0,t.jsx)(en.Td,{children:null==r?void 0:r.name}),(0,t.jsx)(en.Td,{children:null==r?void 0:r.version}),(0,t.jsx)(en.Td,{children:null==r?void 0:r.path}),(0,t.jsx)(en.Td,{children:(null==r?void 0:r.qualifiers)&&(0,t.jsx)(ec.D,{value:null==r?void 0:r.qualifiers})})]},e):(0,t.jsx)(el.Tr,{children:(0,t.jsx)(en.Td,{colSpan:6,children:e})},e)})})]}):null]})}))}):null]},e._ui_unique_id)})})]})),(0,t.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:p})]})};var eb=l(51851),eg=l(21714),e_=l(75481),eT=l(79551),ew=l(32489),eS=l(90519),eF=l(416);let ek=e=>{let{uploads:r,handleUpload:l,handleRemoveUpload:n,handleCancelUpload:a}=e,{rejectedFiles:s,setRejectedFiles:o,handleFileDrop:d,handleDropRejected:c,removeFiles:u}=(e=>{let{uploads:r,handleUpload:l,handleRemoveUpload:t}=e,[n,a]=i.useState(!1),[s,o]=i.useState("inProgress"),[d,c]=i.useState([]);return!n&&r.size>0&&a(!0),i.useEffect(()=>{let e=Array.from(r.values());e.some(e=>"inProgress"===e.status)?o("inProgress"):e.every(e=>"complete"===e.status)?o("success"):o("danger")},[r]),{showStatus:n,status:s,rejectedFiles:d,setRejectedFiles:c,handleFileDrop:(e,r)=>{l(r)},handleDropRejected:e=>{c(e)},successFileCount:Array.from(r.values()).filter(e=>e.response).length,removeFiles:e=>{for(let r of e)t(r)}}})({uploads:r,handleUpload:l,handleRemoveUpload:n});return(0,t.jsxs)(eb.o,{onFileDrop:d,dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:c,useFsAccessApi:!1,multiple:!1,disabled:r.size>0},children:[0===r.size?(0,t.jsx)(eg.Y,{titleIcon:(0,t.jsx)(eF.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2",browseButtonText:"Browse Files"}):Array.from(r.entries()).map((e,r)=>{let[l,i]=e;if(i.error){var n,s,o;return i.wasCancelled?(0,t.jsxs)(x.ub,{status:"danger",headingLevel:"h4",titleText:"Upload cancelled",icon:T.ZP,variant:x.IQ.sm,children:[(0,t.jsx)(j.B,{children:"The file could not be analyzed. The operation was cancelled."}),(0,t.jsx)(f.O,{children:(0,t.jsx)(m.U,{children:(0,t.jsx)(b.zx,{variant:"primary",onClick:()=>u([l]),children:"Try another file"})})})]},"".concat(l.name,"-").concat(r,"-cancelled")):(console.log(i.error),(0,t.jsxs)(x.ub,{status:"danger",headingLevel:"h4",titleText:"Error ".concat(null!=(o=i.error.status)?o:i.error.code,": Upload failed"),icon:T.ZP,variant:x.IQ.sm,children:[(0,t.jsxs)(j.B,{children:["The file could not be analyzed. The file might be corrupted or an unsupported format.",(null==(n=i.error.response)?void 0:n.data.message)&&(0,t.jsx)(e_.L,{toggleText:"Show details",children:null==(s=i.error.response)?void 0:s.data.message})]}),(0,t.jsx)(f.O,{children:(0,t.jsx)(m.U,{children:(0,t.jsx)(b.zx,{variant:"primary",onClick:()=>u([l]),children:"Try another file"})})})]},"".concat(l.name,"-").concat(r,"-error")))}return(0,t.jsxs)(x.ub,{headingLevel:"h4",titleText:"Uploading SBOM ".concat(i.progress,"%"),icon:w.ZP,variant:x.IQ.sm,children:[(0,t.jsx)(j.B,{children:"Securely uploading your SBOM for analysis. The file will not be saved."}),(0,t.jsx)(f.O,{children:(0,t.jsx)(m.U,{children:(0,t.jsx)(b.zx,{variant:"link",onClick:()=>a(l),children:"Cancel upload"})})})]},"".concat(l.name,"-").concat(r,"-progress"))}),(0,t.jsxs)(eT.u,{isOpen:s.length>0,"aria-label":"rejected files",onClose:()=>o([]),variant:"small",children:[(0,t.jsx)(ew.x,{title:"Rejected files",titleIconVariant:"warning"}),(0,t.jsx)(eS.f,{children:(0,t.jsx)(X.aV,{children:s.map(e=>(0,t.jsx)($.H,{children:e.file.name},e.file.name))})})]})]})},eP=()=>{let[e,r]=(0,i.useState)(!1),l=()=>{r(!e)},[L,M]=(0,i.useState)(null),{uploads:U,handleUpload:B,handleCancelUpload:O,handleRemoveUpload:z}=(e=>{let r=(0,S.NL)();return(0,k.V)({parallel:!0,uploadFn:(e,r)=>(0,F.y)(e,r),onSuccess:async(l,t)=>{e(l.data,t),await r.invalidateQueries({queryKey:["sbom-analysis"]})}})})((e,r)=>{M(e)}),{data:{vulnerabilities:V,summary:N},isFetching:Z,fetchError:R}=(e=>{let{packages:r,isFetching:l,fetchError:t}=(0,K.DK)(e);return{data:i.useMemo(()=>{if(l||t||0===Object.keys(r).length)return{summary:(0,q._)({},I._g),vulnerabilities:[]};let e=Object.entries(r).flatMap(e=>{let[r,l]=e;return l.details.flatMap(e=>Object.entries(e.status).flatMap(l=>{let[t,i]=l;return i.map(l=>({purl:r,vulnerability:e,status:t,advisory:l,scores:l.scores}))}))}).reduce((e,r)=>{let l,t=(e,r)=>e.vulnerability.identifier===r.vulnerability.identifier&&e.status===r.status,i=e.find(e=>t(e,r));if(i){var n,a,s,o;let d=e.filter(e=>!t(e,i)),c=(0,A.dn)(r.scores),u=(0,E.g)(null==c?void 0:c.severity),h=new Map(i.advisories);h.set(r.advisory.identifier,{advisory:r.advisory,scores:r.scores,opinionatedScore:c,opinionatedExtendedSeverity:u});let p=new Set(i.purls);p.add(r.purl);let v=null,y=null;if((null==(n=i.opinionatedAvisory.score)?void 0:n.type)!==(null==c?void 0:c.type)){let e=[{advisory:i.opinionatedAvisory.advisory,score:i.opinionatedAvisory.score},{advisory:r.advisory,score:c}].sort((0,A.Bn)(e=>{var r,l;return null!=(l=null==(r=e.score)?void 0:r.type)?l:null}))[0];v=e.advisory,y=e.score}else{let{advisory:e,score:l}=(null!=(s=null==c?void 0:c.value)?s:0)>(null!=(o=null==(a=i.opinionatedAvisory.score)?void 0:a.value)?o:0)?{score:c,advisory:r.advisory}:{score:i.opinionatedAvisory.score,advisory:i.opinionatedAvisory.advisory};v=e,y=l}let x=(0,E.g)(null==y?void 0:y.severity);l=[...d,{vulnerability:i.vulnerability,status:i.status,advisories:h,purls:p,opinionatedAvisory:{advisory:v,score:y,extendedSeverity:x}}]}else{let t=(0,A.dn)(r.scores),i=(0,E.g)(null==t?void 0:t.severity),n=new Map;n.set(r.advisory.identifier,{advisory:r.advisory,scores:r.scores,opinionatedExtendedSeverity:i,opinionatedScore:t});let a=new Set;a.add(r.purl);let s={vulnerability:r.vulnerability,status:r.status,advisories:n,purls:a,opinionatedAvisory:{advisory:r.advisory,score:t,extendedSeverity:i}};l=[...e.slice(),s]}return l},[]),i=e.reduce((e,r)=>{let l=r.status,t=r.opinionatedAvisory.extendedSeverity,i=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,C._)((0,q._)({},e.vulnerabilityStatus),{[l]:{total:i.total+1,severities:(0,C._)((0,q._)({},i.severities),{[t]:i.severities[t]+1})}})})},(0,q._)({},I._g));return{vulnerabilities:e,summary:i}},[r,l,t]),isFetching:l,fetchError:t}})((0,i.useMemo)(()=>{var e;return Object.entries(null!=(e=null==L?void 0:L.packages)?e:{}).flatMap(e=>{let[r,{purls:l}]=e;return l})},[L])),Q=()=>{for(let e of U.keys())z(e);M(null)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.NP,{type:"breadcrumb",children:(0,t.jsxs)(s.a,{children:[(0,t.jsx)(o.g,{children:(0,t.jsx)(n.rU,{to:P.nB.sboms,children:"SBOMs"})}),(0,t.jsx)(o.g,{isActive:!0,children:"Generate vulnerability report"})]})}),(0,t.jsx)(a.NP,{children:null===L||Z||R?(0,t.jsxs)(d.V,{children:[(0,t.jsx)(d.V,{component:"h1",children:"Generate vulnerability report"}),(0,t.jsx)(d.V,{component:"p",children:"Select an SBOM file to generate a temporary vulnerability report. The file and report will not be saved."})]}):(0,t.jsxs)(c.P,{children:[(0,t.jsx)(u.J,{isFilled:!0,children:(0,t.jsxs)(d.V,{children:[(0,t.jsx)(d.V,{component:"h1",children:"Vulnerability report"}),(0,t.jsx)(d.V,{component:"p",children:"This is a temporary vulnerability report."})]})}),(0,t.jsx)(u.J,{children:(0,t.jsx)(h.L,{isOpen:e,onSelect:()=>r(!1),onOpenChange:e=>r(e),popperProps:{position:"right"},toggle:r=>(0,t.jsx)(p.O_,{ref:r,onClick:l,isExpanded:e,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsx)(v.s,{children:(0,t.jsx)(y.h,{onClick:Q,children:"Scan another"},"scan-another")})})})]})}),(0,t.jsx)(a.NP,{children:null===L?(0,t.jsx)(ek,{uploads:U,handleUpload:B,handleRemoveUpload:z,handleCancelUpload:O}):Z?(0,t.jsxs)(x.ub,{titleText:"Generating SBOM report",headingLevel:"h4",icon:w.ZP,children:[(0,t.jsx)(j.B,{children:"Analyzing your SBOM for security vulnerabilities, license issues and dependency details."}),(0,t.jsx)(f.O,{children:(0,t.jsx)(m.U,{children:(0,t.jsx)(b.zx,{variant:"link",onClick:Q,children:"Cancel scan"})})})]}):R?(0,t.jsxs)(x.ub,{status:"danger",headingLevel:"h4",titleText:"Scan failed",icon:T.ZP,variant:x.IQ.sm,children:[(0,t.jsx)(j.B,{children:"The file could not be analyzed. The file might be corrupted or an unsupported format."}),(0,t.jsx)(f.O,{children:(0,t.jsx)(m.U,{children:(0,t.jsx)(b.zx,{variant:"primary",onClick:Q,children:"Try another file"})})})]}):(0,t.jsxs)(g.K,{hasGutter:!0,children:[(0,t.jsx)(_.v,{children:(0,t.jsx)(D,{summary:N,isFetching:Z,fetchError:R})}),(0,t.jsx)(_.v,{children:(0,t.jsx)(em,{vulnerabilities:V,isFetching:Z,fetchError:R})})]})})]})}},43959:function(e,r,l){l.d(r,{Fz:()=>f,KQ:()=>w,Oh:()=>T,i5:()=>j,km:()=>g,p4:()=>m,qi:()=>F,s5:()=>b,t9:()=>_,uz:()=>S});var t=l(79192),i=l(53195),n=l(70186),a=l(1183),s=l(24038),o=l(68e3),d=l(75503),c=l(16072),u=l(50576),h=l(40371),p=l(95169),v=l(87017),y=l(49988);let x="sboms",j=e=>{let{data:r,isLoading:l,error:t,refetch:i}=(0,a.a)({queryKey:[x,"labels",e],queryFn:()=>(0,h.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==r?void 0:r.data)||[],isFetching:l,fetchError:t,refetch:i}},f=function(){var e,r,l;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,y.rm)(s),{q:p}=c,v=(0,n._)(c,["q"]),j=(0,y.Rb)(o),{data:f,isLoading:m,error:b,refetch:g}=(0,a.a)({queryKey:[x,s,j],queryFn:()=>(0,h.Wp)({client:u.L,query:(0,i._)((0,t._)({},v),{q:[p,j].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==f||null==(e=f.data)?void 0:e.items)||[],total:null!=(l=null==f||null==(r=f.data)?void 0:r.total)?l:0,params:s},isFetching:m,fetchError:b,refetch:g}},m=e=>{let{data:r,isLoading:l,error:t}=(0,a.a)({queryKey:[x,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==r?void 0:r.data,isFetching:l,fetchError:t}},b=(e,r)=>{let l=(0,o.NL)();return(0,d.D)({mutationFn:async e=>(await (0,h.WX)({client:u.L,path:{id:e}})).data,onSuccess:async(r,t)=>{e(r,t),await l.invalidateQueries({queryKey:[x]})},onError:async e=>{r(e),await l.invalidateQueries({queryKey:[x]})}})},g=()=>{let e=(0,o.NL)();return(0,p.V)({parallel:!0,uploadFn:(e,r)=>(0,v.Hb)(e,r),onSuccess:async()=>{await e.invalidateQueries({queryKey:[x]})}})},_=(e,r)=>{let l=(0,o.NL)();return(0,d.D)({mutationFn:e=>(0,h.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await l.invalidateQueries({queryKey:[x]})},onError:r})},T=function(e){var r,l,i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:d,refetch:c}=(0,a.a)({queryKey:[x,"by-package",e,n],queryFn:()=>(0,h.DU)({client:u.L,query:(0,t._)({purl:e},(0,y.rm)(n))})});return{result:{data:(null==s||null==(r=s.data)?void 0:r.items)||[],total:null!=(i=null==s||null==(l=s.data)?void 0:l.total)?i:0,params:n},isFetching:o,fetchError:d,refetch:c}},w=e=>{let{data:r,isLoading:l,error:t}=(0,a.a)({queryKey:[x,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})});return{advisories:(null==r?void 0:r.data)||[],isFetching:l,fetchError:t}},S=e=>{let r=(0,c.h)({queries:e.map(e=>({queryKey:[x,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})}))});return{advisories:r.map(e=>{let{data:r}=e;return(null==r?void 0:r.data)||[]}),isFetching:r.some(e=>{let{isLoading:r}=e;return r}),fetchError:r.map(e=>{let{error:r}=e;return r})}},F=e=>{let{data:r,isLoading:l,error:t}=(0,a.a)({queryKey:[x,e,"license-ids"],queryFn:()=>(0,h.J4)({client:u.L,path:{id:e}})});return{licenseIds:(null==r?void 0:r.data)||[],isFetching:l,fetchError:t}}},78176:function(e,r,l){l.d(r,{fd:()=>p,DK:()=>v,p6:()=>y});var t=l(79192),i=l(1183),n=l(16072),a=l(50576),s=l(40371),o=l(74502),d=l(98726),c=l(49988);let u=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,l=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return new Promise((t,i)=>{setTimeout(()=>{l?t(e):i(Error("Error"))},r)})},h="vulnerabilities",p=function(){var e,r,l;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:u,error:p,refetch:v}=(0,i.a)({queryKey:[h,n],queryFn:()=>(0,s.b5)({client:a.L,query:(0,t._)({},(0,c.rm)(n))}),enabled:!o});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(l=null==d||null==(r=d.data)?void 0:r.total)?l:0,params:n},isFetching:u,fetchError:p,refetch:v}},v=e=>{let r="off"===d.Z.MOCK?{ids:e.reduce((e,r,l)=>(l%100==0?e.push([r]):e[e.length-1].push(r),e),[]),dataResolver:async e=>(await (0,s.BJ)({client:a.L,body:{purls:e}})).data}:{ids:[e],dataResolver:e=>{var r;return u(null!=(r=window[o.Dx])?r:{})}},l=(0,n.h)({queries:r.ids.map(e=>({queryKey:[h,e],queryFn:()=>r.dataResolver(e),retry:!1}))}),t=l.some(e=>{let{isLoading:r}=e;return r}),i=l.find(e=>{let{error:r}=e;return!!r}),c={};if(!t)for(let e of l.map(e=>{var r;return null!=(r=null==e?void 0:e.data)?r:{}}))for(let[r,l]of Object.entries(e))c[r]=l;return{packages:c,isFetching:t,fetchError:i}},y=e=>{let{data:r,isLoading:l,error:t}=(0,i.a)({queryKey:[h,e],queryFn:()=>(0,s.OG)({client:a.L,path:{id:e}})});return{vulnerability:null==r?void 0:r.data,isFetching:l,fetchError:t}}},41135:function(e,r,l){l.d(r,{T:()=>s});var t=l(79192),i=l(53195),n=l(27378),a=l(74502);let s=(e,r)=>(0,n.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,i._)((0,t._)({},e),{[a.nM]:r(e)})):[],[e,r])}}]);