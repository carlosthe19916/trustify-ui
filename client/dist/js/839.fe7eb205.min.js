"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[839],{78833:(e,t,l)=>{l.d(t,{Y:()=>y});var a=l(63696),n=l(49348),r=l(34066),i=l(65753),s=l(24974),c=l(21639),o=l(3939),m=l(77635),u=l(92939),d=l(91728),E=l(67837),p=l(24417);const y=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:y}=(0,d.rj)(e);return a.createElement(p.a,{isFetching:l,fetchError:y},a.createElement(i.B,null,a.createElement(s.W,null,a.createElement(c.X,null,"Name"),a.createElement(o.d,null,a.createElement(m.$n,{variant:"link",isInline:!0,icon:a.createElement(u.Ay,null)},a.createElement(n.k2,{to:`/sboms/${e}`},t?.name)))),a.createElement(s.W,null,a.createElement(c.X,null,"Published"),a.createElement(o.d,null,(0,r.Yq)(t?.published))),a.createElement(s.W,null,a.createElement(c.X,null,"Labels"),a.createElement(o.d,null,t?.labels&&a.createElement(E.g,{defaultIsOpen:!0,value:t?.labels})))))}},38574:(e,t,l)=>{l.d(t,{J:()=>y});var a=l(63696),n=l(49348),r=l(74932),i=l(34066),s=l(65753),c=l(24974),o=l(21639),m=l(3939),u=l(77635),d=l(92939),E=l(24417),p=l(52302);const y=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:y}=(0,r.uN)(e);return a.createElement(E.a,{isFetching:l,fetchError:y},a.createElement(s.B,null,a.createElement(c.W,null,a.createElement(o.X,null,"Identifier"),a.createElement(m.d,null,a.createElement(u.$n,{variant:"link",isInline:!0,icon:a.createElement(d.Ay,null)},a.createElement(n.k2,{to:`/vulnerabilities/${t?.identifier}`},t?.identifier)))),a.createElement(c.W,null,a.createElement(o.X,null,"Severity"),a.createElement(m.d,null,t?.average_severity&&a.createElement(p.h,{value:t?.average_severity}))),a.createElement(c.W,null,a.createElement(o.X,null,"Title"),a.createElement(m.d,null,t?.title||t?.description)),a.createElement(c.W,null,a.createElement(o.X,null,"CWE"),a.createElement(m.d,null,"vulnerability?.cwe")),a.createElement(c.W,null,a.createElement(o.X,null,"Published"),a.createElement(m.d,null,(0,i.Yq)(t?.published))),a.createElement(c.W,null,a.createElement(o.X,null,"Modified"),a.createElement(m.d,null,(0,i.Yq)(t?.modified))),a.createElement(c.W,null,a.createElement(o.X,null,"Withdrawn"),a.createElement(m.d,null,(0,i.Yq)(t?.withdrawn))),a.createElement(c.W,null,a.createElement(o.X,null,"Released"),a.createElement(m.d,null,(0,i.Yq)(t?.released)))))}},40124:(e,t,l)=>{l.r(t),l.d(t,{default:()=>H});var a=l(63696),n=l(49348),r=l(68430),i=l(98261),s=l(75530),c=l(1180),o=l(72785),m=l(23665),u=l(70414),d=l(8210),E=l(71523),p=l(80876),y=l(17993),h=l(34066),v=l(20653),g=l(35048),b=l(4433),f=l(77635),P=l(28341),T=l(341),w=l(85578),S=l(16646),k=l(31065),C=l(77819),K=l(28516),x=l(3629),I=l(86820),A=l(33273),F=l(67837),N=l(77307),_=l(78833),X=l(1349),q=l(62520),L=l(70611),W=l(5098),M=l(91728);const $=({packageId:e})=>{const[t,l]=a.useState(null),[n,r]=a.useState(null),i=(0,L.MM)({tableName:"sboms",persistenceKeyPrefix:I.rt.sboms_by_package,columnNames:{name:"Name",published:"Published",labels:"Labels"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:A.RJ.search}]}),{result:{data:s,total:o},isFetching:m,fetchError:u}=(0,M.Qr)(e,(0,L.Ng)({...i,hubSortFieldKeys:{}})),d=(0,L.PB)({...i,idProperty:"id",currentPageItems:s,totalItemCount:o,isLoading:m,selectionState:(0,W.$)({items:s,isEqual:(e,t)=>e.id===t.id})}),{numRenderedColumns:E,currentPageItems:p,propHelpers:{toolbarProps:y,filterToolbarProps:$,paginationToolbarItemProps:J,paginationProps:R,tableProps:V,getThProps:z,getTrProps:B,getTdProps:Y}}=d;return a.createElement(a.Fragment,null,a.createElement(v.M,{...y},a.createElement(g.P,null,a.createElement(A.Us,{showFiltersSideBySide:!0,...$}),a.createElement(b.T,{...J},a.createElement(X.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:R})))),a.createElement(w.X,{...V,"aria-label":"SBOM table"},a.createElement(S.d,null,a.createElement(k.Tr,null,a.createElement(q.Ze,{...d},a.createElement(C.Th,{...z({columnKey:"name"})}),a.createElement(C.Th,{...z({columnKey:"published"})}),a.createElement(C.Th,{...z({columnKey:"labels"})})))),a.createElement(q.nJ,{isLoading:m,isError:!!u,isNoData:0===o,numRenderedColumns:E},p?.map((e=>a.createElement(K.N,{key:e.id},a.createElement(k.Tr,{...B({item:e})},a.createElement(x.Td,{width:35,...Y({columnKey:"name"})},a.createElement(f.$n,{size:"sm",variant:f.Ak.secondary,onClick:()=>{return t=e,l("showSbom"),void r(t);var t}},e.name)),a.createElement(x.Td,{width:10,modifier:"truncate",...Y({columnKey:"published"})},(0,h.Yq)(e.published)),a.createElement(x.Td,{width:35,modifier:"truncate",...Y({columnKey:"labels"})},e.labels&&a.createElement(F.g,{value:e.labels})))))))),a.createElement(X.n,{idPrefix:"sboms-table",isTop:!1,isCompact:!0,paginationProps:R}),a.createElement(N.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showSbom"===t&&a.createElement(c.n,null,a.createElement(P.h,{headingLevel:"h2",size:"lg",className:T.A.mtXs},"Advisory")))},"showSbom"===t&&a.createElement(a.Fragment,null,n&&a.createElement(_.Y,{sbomId:n.id}))))};var J=l(891),R=l(77347),V=l(40752),z=l(88605),B=l(52302),Y=l(38574),O=l(15311),U=l(70400);const D=({packageId:e})=>{const[t,l]=a.useState(null),[n,r]=a.useState(null),i=(e,t)=>{l(e),r(t)},{pkg:s,isFetching:o,fetchError:m}=(0,y.Si)(e),[u,d]=a.useState([]),[E,p]=a.useState(new Map),[h,I]=a.useState(!1),[F,_]=a.useState(new Set);a.useEffect((()=>{const e=(s?.advisories??[]).flatMap((e=>e.status.map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,context:t.context,advisory:e}))))).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]),t=new Set;e.forEach((e=>t.add(e.status))),d(e),_(t),I(!0),Promise.all(e.map((async e=>(await(0,V.wk)({client:R.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),l=new Map;t.forEach((e=>l.set(e.identifier,e))),p(l),I(!1)}))}),[s]);const W=a.useMemo((()=>u.map((e=>({...e,vulnerability:E.get(e.vulnerabilityId)})))),[u,E]),M=(0,O.f)(W,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),$=(0,L.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:M,isLoading:!1,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.vulnerabilityId}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:A.RJ.search,getItemValue:e=>e.vulnerabilityId},{categoryKey:"status",title:"Status",placeholderText:"Status",type:A.RJ.multiselect,selectOptions:Array.from(F).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:D,numRenderedColumns:H,propHelpers:{toolbarProps:Q,filterToolbarProps:Z,paginationToolbarItemProps:j,paginationProps:G,tableProps:ee,getThProps:te,getTrProps:le,getTdProps:ae},expansionDerivedState:{isCellExpanded:ne}}=$;return a.createElement(a.Fragment,null,a.createElement(v.M,{...Q},a.createElement(g.P,null,a.createElement(A.Us,{showFiltersSideBySide:!0,...Z}),a.createElement(b.T,{...j},a.createElement(X.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:G})))),a.createElement(w.X,{...ee,"aria-label":"vulnerability table"},a.createElement(S.d,null,a.createElement(k.Tr,null,a.createElement(q.Ze,{...$},a.createElement(C.Th,{...te({columnKey:"identifier"})}),a.createElement(C.Th,{...te({columnKey:"title"})}),a.createElement(C.Th,{...te({columnKey:"severity"})}),a.createElement(C.Th,{...te({columnKey:"advisory"})}),a.createElement(C.Th,{...te({columnKey:"context"})}),a.createElement(C.Th,{...te({columnKey:"status"})})))),a.createElement(q.nJ,{isLoading:o||h,isError:!!m,isNoData:0===M.length,numRenderedColumns:H},D?.map(((e,t)=>a.createElement(K.N,{key:e._ui_unique_id,isExpanded:ne(e)},a.createElement(k.Tr,{...le({item:e})},a.createElement(q.Oi,{...$,item:e,rowIndex:t},a.createElement(x.Td,{width:15,...ae({columnKey:"identifier"})},a.createElement(f.$n,{size:"sm",variant:f.Ak.secondary,onClick:()=>i("showVulnerability",e)},e.vulnerabilityId)),a.createElement(x.Td,{width:35,modifier:"truncate",...ae({columnKey:"title"})},e.vulnerability?.title),a.createElement(x.Td,{width:10,...ae({columnKey:"severity"})},e.vulnerability?.average_severity&&a.createElement(B.h,{value:e.vulnerability.average_severity})),a.createElement(x.Td,{width:15,modifier:"truncate",...ae({columnKey:"advisory"})},a.createElement(f.$n,{size:"sm",variant:f.Ak.secondary,onClick:()=>i("showAdvisory",e)},e.advisory.identifier)),a.createElement(x.Td,{width:25,modifier:"truncate",...ae({columnKey:"context"})},a.createElement(U.L,{value:e.context})),a.createElement(x.Td,{width:10,modifier:"truncate",...ae({columnKey:"status"})},a.createElement(J.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),a.createElement(X.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:G}),a.createElement(N.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showVulnerability"===t&&a.createElement(c.n,null,a.createElement(P.h,{headingLevel:"h2",size:"lg",className:T.A.mtXs},"Vulnerability")),"showAdvisory"===t&&a.createElement(c.n,null,a.createElement(P.h,{headingLevel:"h2",size:"lg",className:T.A.mtXs},"Advisory")))},"showVulnerability"===t&&a.createElement(a.Fragment,null,n?.advisory&&a.createElement(Y.J,{vulnerabilityId:n?.vulnerabilityId}))," ","showAdvisory"===t&&a.createElement(a.Fragment,null,n?.advisory&&a.createElement(z.c,{advisoryId:n?.advisory.uuid}))))},H=()=>{const e=(0,p.Lu)(p.vO.PACKAGE_ID),{pkg:t}=(0,y.Si)(e),l=a.useMemo((()=>t?(0,h.fe)(t.purl):void 0),[t]);return a.createElement(a.Fragment,null,a.createElement(r.d8,{variant:"light"},a.createElement(E.A,{breadcrumbs:a.createElement(i.Q,null,a.createElement(s.J,{key:"packages"},a.createElement(n.N_,{to:"/packages"},"Packages")),a.createElement(s.J,{isActive:!0},"Package details")),pageHeading:{title:l?.name??e??"",iconAfterTitle:t?a.createElement(c.n,null,a.createElement(o.E,{component:"pre"},`version: ${l?.version}`)):void 0,label:t?{children:t?`type=${l?.type}`:"",isCompact:!0}:void 0},actionButtons:[],tabs:[{eventKey:"vulnerabilities",title:"Vulnerabilities",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(D,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"Vulnerabilities ",a.createElement("strong",null,"associated")," to the current package."),position:"top"},a.createElement(u.o,null,a.createElement(d.Ay,null))))},{eventKey:"sboms",title:"SBOMs",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement($,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"SBOMs that ",a.createElement("strong",null,"contain")," the current package."),position:"top"},a.createElement(u.o,null,a.createElement(d.Ay,null))))}]})))}},70400:(e,t,l)=>{l.d(t,{n:()=>_,L:()=>N});var a=l(63696),n=l(20653),r=l(35048),i=l(4433),s=l(77635),c=l(891),o=l(1180),m=l(28341),u=l(341),d=l(85578),E=l(16646),p=l(31065),y=l(77819),h=l(28516),v=l(3629),g=l(88605),b=l(33273),f=l(65753),P=l(24974),T=l(21639),w=l(3939),S=l(16177);const k=({decomposedPurl:e})=>a.createElement(f.B,null,a.createElement(P.W,null,a.createElement(T.X,null,"Name"),a.createElement(w.d,null,e.name)),a.createElement(P.W,null,a.createElement(T.X,null,"Namespace"),a.createElement(w.d,null,e.namespace)),a.createElement(P.W,null,a.createElement(T.X,null,"Type"),a.createElement(w.d,null,e.type)),e.version&&a.createElement(P.W,null,a.createElement(T.X,null,"Version"),a.createElement(w.d,null,e.version)),e.path&&a.createElement(P.W,null,a.createElement(T.X,null,"Path"),a.createElement(w.d,null,e.path)),e.qualifiers&&a.createElement(P.W,null,a.createElement(T.X,null,"Qualifiers"),a.createElement(w.d,null,a.createElement(S.a,{value:e.qualifiers}))));var C=l(77307),K=l(1349),x=l(62520),I=l(70611),A=l(15311),F=l(34066);const N=({value:e})=>{if(!e)return null;let t=e;return t.cpe?t.cpe:e.purl},_=({variant:e,initialItemsPerPage:t,advisories:l})=>{const[f,P]=a.useState(null),[T,w]=a.useState(null),S=(e,t)=>{P(e),w(t)},_=a.useMemo((()=>l.flatMap((e=>Object.entries(e.purls??{}).flatMap((([t,l])=>l.map((l=>{const a=l.base_purl;return{basePurl:{...a},advisory:{...e},status:t,context:l.context,versionRange:l.version,decomposedPurl:(0,F.fe)(a.purl)}}))))))),[l]),X=(0,A.f)(_,(e=>`${e.basePurl.purl}-${e.advisory.identifier}-${e.status}`)),q=a.useMemo((()=>{const e=new Set;return _.forEach((t=>e.add(t.status))),e}),[_]),L=(0,I.vY)({variant:e,tableName:"package-table",idProperty:"_ui_unique_id",items:X,isLoading:!1,columnNames:{name:"Name",namespace:"Namespace",affectedVersions:"Affected version",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!1,sortableColumns:["name"],getSortValues:e=>({name:e.decomposedPurl?.name??e.basePurl.purl}),isPaginationEnabled:!0,initialItemsPerPage:t,isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:b.RJ.search,getItemValue:e=>e.decomposedPurl?.name??e.basePurl.purl},{categoryKey:"status",title:"Status",placeholderText:"Status",type:b.RJ.multiselect,selectOptions:Array.from(q).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:W,numRenderedColumns:M,propHelpers:{toolbarProps:$,filterToolbarProps:J,paginationToolbarItemProps:R,paginationProps:V,tableProps:z,getThProps:B,getTrProps:Y,getTdProps:O}}=L;return a.createElement(a.Fragment,null,a.createElement(n.M,{...$},a.createElement(r.P,null,a.createElement(b.Us,{showFiltersSideBySide:!0,...J}),a.createElement(i.T,{...R},a.createElement(K.n,{idPrefix:"package-table",isTop:!0,paginationProps:V})))),a.createElement(d.X,{...z,"aria-label":"Package table"},a.createElement(E.d,null,a.createElement(p.Tr,null,a.createElement(x.Ze,{...L},a.createElement(y.Th,{...B({columnKey:"name"})}),a.createElement(y.Th,{...B({columnKey:"namespace"})}),a.createElement(y.Th,{...B({columnKey:"affectedVersions"})}),a.createElement(y.Th,{...B({columnKey:"advisory"})}),a.createElement(y.Th,{...B({columnKey:"context"})}),a.createElement(y.Th,{...B({columnKey:"status"})})))),a.createElement(x.nJ,{isLoading:!1,isError:void 0,isNoData:0===_.length,numRenderedColumns:M},W?.map(((e,t)=>a.createElement(h.N,{key:e.basePurl.purl},a.createElement(p.Tr,{...Y({item:e})},a.createElement(x.Oi,{...L,item:e,rowIndex:t},a.createElement(v.Td,{width:25,modifier:"truncate",...O({columnKey:"name"})},a.createElement(s.$n,{size:"sm",variant:s.Ak.secondary,onClick:()=>S("showPackage",e)},e.decomposedPurl?e.decomposedPurl?.name:e.basePurl.purl)),a.createElement(v.Td,{width:15,modifier:"truncate",...O({columnKey:"namespace"})},e.decomposedPurl?.namespace),a.createElement(v.Td,{width:10,...O({columnKey:"affectedVersions"})},a.createElement(c.J,{color:"grey"},e.versionRange)),a.createElement(v.Td,{width:15,modifier:"truncate",...O({columnKey:"advisory"})},a.createElement(s.$n,{size:"sm",variant:s.Ak.secondary,onClick:()=>S("showAdvisory",e)},e.advisory.identifier)),a.createElement(v.Td,{width:25,modifier:"truncate",...O({columnKey:"context"})},a.createElement(N,{value:e.context})),a.createElement(v.Td,{width:10,modifier:"truncate",...O({columnKey:"status"})},a.createElement(c.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),a.createElement(K.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:V}),a.createElement(C.q,{isExpanded:null!==f,onCloseClick:()=>P(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showPackage"===f&&a.createElement(o.n,null,a.createElement(m.h,{headingLevel:"h2",size:"lg",className:u.A.mtXs},"Package")),"showAdvisory"===f&&a.createElement(o.n,null,a.createElement(m.h,{headingLevel:"h2",size:"lg",className:u.A.mtXs},"Advisory")))},"showPackage"===f&&a.createElement(a.Fragment,null,T?.decomposedPurl&&a.createElement(k,{decomposedPurl:T?.decomposedPurl})),"showAdvisory"===f&&a.createElement(a.Fragment,null,T?.advisory&&a.createElement(g.c,{advisoryId:T?.advisory.uuid}))))}},17993:(e,t,l)=>{l.d(t,{Lx:()=>c,Si:()=>o,sl:()=>m});var a=l(7616),n=l(77347),r=l(40752),i=l(70611);const s="packages",c=(e={},t=!1)=>{const{data:l,isLoading:c,error:o,refetch:m}=(0,a.I)({queryKey:[s,e],queryFn:()=>(0,r.UD)({client:n.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e},isFetching:c,fetchError:o,refetch:m}},o=e=>{const{data:t,isLoading:l,error:i}=(0,a.I)({queryKey:[s,e],queryFn:()=>(0,r.Y0)({client:n.S,path:{key:e}})});return{pkg:t?.data,isFetching:l,fetchError:i}},m=(e,t={})=>{const{data:l,isLoading:c,error:o,refetch:m}=(0,a.I)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:n.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:t},isFetching:c,fetchError:o,refetch:m}}}}]);
//# sourceMappingURL=839.fe7eb205.min.js.map